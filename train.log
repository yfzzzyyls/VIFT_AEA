/home/external/venv/py39/lib64/python3.9/site-packages/torch/nn/modules/transformer.py:382: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
/home/external/venv/py39/lib64/python3.9/site-packages/networkx/utils/backends.py:135: RuntimeWarning: networkx backend defined more than once: nx-loopback
  backends.update(_get_backends("networkx.backends"))
Using device: cuda

============================================================
VIFT Training - Stable Version
============================================================
Key features:
- Input normalization for visual and IMU features
- Robust loss functions (Huber + smooth geodesic)
- Gradient clipping at 10.0 (matching paper)
- Pre-norm transformer for stability
- Learning rate 1e-4 (matching paper)
- Causal masking with single-step prediction
- No output BatchNorm (fixed architectural issue)
- Translation loss weight: 100.0 (meters to match radians)
- RELATIVE pose training (matching evaluation)
============================================================

Train samples: 1606
Val samples: 683

Model Parameters:
  Total: 3,426,055
  Trainable: 3,426,055

============================================================
Epoch 1/50
Learning rate: 0.00000500
============================================================
Epoch 1:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 1:   0%|          | 0/51 [00:00<?, ?it/s, loss=39.3733, trans=0.3703, rot=2.3407, grad=567.22, nan=0]Epoch 1:   2%|▏         | 1/51 [00:00<00:17,  2.93it/s, loss=39.3733, trans=0.3703, rot=2.3407, grad=567.22, nan=0]Epoch 1:   2%|▏         | 1/51 [00:00<00:17,  2.93it/s, loss=34.9438, trans=0.3282, rot=2.1255, grad=565.75, nan=0]Epoch 1:   2%|▏         | 1/51 [00:00<00:17,  2.93it/s, loss=40.7827, trans=0.3868, rot=2.1050, grad=826.07, nan=0]Epoch 1:   2%|▏         | 1/51 [00:00<00:17,  2.93it/s, loss=31.6663, trans=0.2950, rot=2.1631, grad=504.21, nan=0]Epoch 1:   2%|▏         | 1/51 [00:00<00:17,  2.93it/s, loss=34.7685, trans=0.3254, rot=2.2251, grad=548.75, nan=0]Epoch 1:   2%|▏         | 1/51 [00:00<00:17,  2.93it/s, loss=32.8025, trans=0.3067, rot=2.1327, grad=632.63, nan=0]Epoch 1:   2%|▏         | 1/51 [00:00<00:17,  2.93it/s, loss=31.2117, trans=0.2904, rot=2.1733, grad=527.68, nan=0]Epoch 1:   2%|▏         | 1/51 [00:00<00:17,  2.93it/s, loss=34.1696, trans=0.3196, rot=2.2077, grad=599.72, nan=0]Epoch 1:   2%|▏         | 1/51 [00:00<00:17,  2.93it/s, loss=26.1308, trans=0.2406, rot=2.0755, grad=470.46, nan=0]Epoch 1:   2%|▏         | 1/51 [00:00<00:17,  2.93it/s, loss=28.3313, trans=0.2600, rot=2.3289, grad=484.43, nan=0]Epoch 1:  20%|█▉        | 10/51 [00:00<00:01, 28.27it/s, loss=28.3313, trans=0.2600, rot=2.3289, grad=484.43, nan=0]Epoch 1:  20%|█▉        | 10/51 [00:00<00:01, 28.27it/s, loss=29.7318, trans=0.2762, rot=2.1122, grad=608.02, nan=0]Epoch 1:  20%|█▉        | 10/51 [00:00<00:01, 28.27it/s, loss=22.8239, trans=0.2058, rot=2.2416, grad=373.55, nan=0]Epoch 1:  20%|█▉        | 10/51 [00:00<00:01, 28.27it/s, loss=17.5248, trans=0.1534, rot=2.1881, grad=300.38, nan=0]Epoch 1:  20%|█▉        | 10/51 [00:00<00:01, 28.27it/s, loss=22.4315, trans=0.2011, rot=2.3235, grad=392.32, nan=0]Epoch 1:  20%|█▉        | 10/51 [00:00<00:01, 28.27it/s, loss=21.7510, trans=0.1960, rot=2.1497, grad=368.65, nan=0]Epoch 1:  20%|█▉        | 10/51 [00:00<00:01, 28.27it/s, loss=24.2396, trans=0.2208, rot=2.1546, grad=418.63, nan=0]Epoch 1:  20%|█▉        | 10/51 [00:00<00:01, 28.27it/s, loss=21.0808, trans=0.1882, rot=2.2641, grad=376.76, nan=0]Epoch 1:  20%|█▉        | 10/51 [00:00<00:01, 28.27it/s, loss=23.0069, trans=0.2090, rot=2.1105, grad=374.38, nan=0]Epoch 1:  20%|█▉        | 10/51 [00:00<00:01, 28.27it/s, loss=21.2563, trans=0.1902, rot=2.2324, grad=352.04, nan=0]Epoch 1:  20%|█▉        | 10/51 [00:00<00:01, 28.27it/s, loss=18.7782, trans=0.1648, rot=2.2983, grad=259.30, nan=0]Epoch 1:  39%|███▉      | 20/51 [00:00<00:00, 48.32it/s, loss=18.7782, trans=0.1648, rot=2.2983, grad=259.30, nan=0]Epoch 1:  39%|███▉      | 20/51 [00:00<00:00, 48.32it/s, loss=14.8414, trans=0.1275, rot=2.0884, grad=304.11, nan=0]Epoch 1:  39%|███▉      | 20/51 [00:00<00:00, 48.32it/s, loss=19.0197, trans=0.1702, rot=2.0019, grad=333.28, nan=0]Epoch 1:  39%|███▉      | 20/51 [00:00<00:00, 48.32it/s, loss=17.2578, trans=0.1517, rot=2.0855, grad=290.72, nan=0]Epoch 1:  39%|███▉      | 20/51 [00:00<00:00, 48.32it/s, loss=23.7653, trans=0.2182, rot=1.9466, grad=359.35, nan=0]Epoch 1:  39%|███▉      | 20/51 [00:00<00:00, 48.32it/s, loss=21.2932, trans=0.1935, rot=1.9446, grad=311.86, nan=0]Epoch 1:  39%|███▉      | 20/51 [00:00<00:00, 48.32it/s, loss=17.4031, trans=0.1531, rot=2.0978, grad=263.03, nan=0]Epoch 1:  39%|███▉      | 20/51 [00:00<00:00, 48.32it/s, loss=18.5803, trans=0.1667, rot=1.9076, grad=322.89, nan=0]Epoch 1:  39%|███▉      | 20/51 [00:00<00:00, 48.32it/s, loss=18.1622, trans=0.1610, rot=2.0607, grad=312.11, nan=0]Epoch 1:  39%|███▉      | 20/51 [00:00<00:00, 48.32it/s, loss=23.7130, trans=0.2151, rot=2.2071, grad=319.44, nan=0]Epoch 1:  57%|█████▋    | 29/51 [00:00<00:00, 59.32it/s, loss=23.7130, trans=0.2151, rot=2.2071, grad=319.44, nan=0]Epoch 1:  57%|█████▋    | 29/51 [00:00<00:00, 59.32it/s, loss=20.2349, trans=0.1817, rot=2.0606, grad=311.31, nan=0]Epoch 1:  57%|█████▋    | 29/51 [00:00<00:00, 59.32it/s, loss=20.0693, trans=0.1798, rot=2.0847, grad=308.88, nan=0]Epoch 1:  57%|█████▋    | 29/51 [00:00<00:00, 59.32it/s, loss=15.7879, trans=0.1345, rot=2.3351, grad=322.75, nan=0]Epoch 1:  57%|█████▋    | 29/51 [00:00<00:00, 59.32it/s, loss=16.1893, trans=0.1404, rot=2.1528, grad=302.86, nan=0]Epoch 1:  57%|█████▋    | 29/51 [00:00<00:00, 59.32it/s, loss=15.2477, trans=0.1321, rot=2.0405, grad=241.62, nan=0]Epoch 1:  57%|█████▋    | 29/51 [00:00<00:00, 59.32it/s, loss=19.5585, trans=0.1738, rot=2.1777, grad=277.06, nan=0]Epoch 1:  57%|█████▋    | 29/51 [00:00<00:00, 59.32it/s, loss=19.4033, trans=0.1724, rot=2.1586, grad=312.30, nan=0]Epoch 1:  57%|█████▋    | 29/51 [00:00<00:00, 59.32it/s, loss=15.4701, trans=0.1343, rot=2.0369, grad=225.91, nan=0]Epoch 1:  57%|█████▋    | 29/51 [00:00<00:00, 59.32it/s, loss=13.4149, trans=0.1152, rot=1.8983, grad=238.37, nan=0]Epoch 1:  57%|█████▋    | 29/51 [00:00<00:00, 59.32it/s, loss=16.7277, trans=0.1477, rot=1.9592, grad=327.30, nan=0]Epoch 1:  76%|███████▋  | 39/51 [00:00<00:00, 68.98it/s, loss=16.7277, trans=0.1477, rot=1.9592, grad=327.30, nan=0]Epoch 1:  76%|███████▋  | 39/51 [00:00<00:00, 68.98it/s, loss=14.3087, trans=0.1229, rot=2.0155, grad=219.57, nan=0]Epoch 1:  76%|███████▋  | 39/51 [00:00<00:00, 68.98it/s, loss=15.8830, trans=0.1389, rot=1.9976, grad=249.79, nan=0]Epoch 1:  76%|███████▋  | 39/51 [00:00<00:00, 68.98it/s, loss=12.4123, trans=0.1027, rot=2.1473, grad=236.19, nan=0]Epoch 1:  76%|███████▋  | 39/51 [00:00<00:00, 68.98it/s, loss=13.0798, trans=0.1116, rot=1.9202, grad=231.22, nan=0]Epoch 1:  76%|███████▋  | 39/51 [00:00<00:00, 68.98it/s, loss=14.4532, trans=0.1228, rot=2.1778, grad=315.46, nan=0]Epoch 1:  76%|███████▋  | 39/51 [00:00<00:00, 68.98it/s, loss=17.8838, trans=0.1580, rot=2.0828, grad=324.71, nan=0]Epoch 1:  76%|███████▋  | 39/51 [00:00<00:00, 68.98it/s, loss=10.5378, trans=0.0850, rot=2.0404, grad=204.71, nan=0]Epoch 1:  76%|███████▋  | 39/51 [00:00<00:00, 68.98it/s, loss=12.2199, trans=0.1047, rot=1.7536, grad=227.66, nan=0]Epoch 1:  76%|███████▋  | 39/51 [00:00<00:00, 68.98it/s, loss=13.6681, trans=0.1170, rot=1.9709, grad=244.25, nan=0]Epoch 1:  76%|███████▋  | 39/51 [00:00<00:00, 68.98it/s, loss=15.1861, trans=0.1357, rot=1.6171, grad=312.68, nan=0]Epoch 1:  96%|█████████▌| 49/51 [00:00<00:00, 75.93it/s, loss=15.1861, trans=0.1357, rot=1.6171, grad=312.68, nan=0]Epoch 1:  96%|█████████▌| 49/51 [00:00<00:00, 75.93it/s, loss=15.7386, trans=0.1381, rot=1.9277, grad=338.48, nan=0]Epoch 1:  96%|█████████▌| 49/51 [00:00<00:00, 75.93it/s, loss=9.9382, trans=0.0786, rot=2.0829, grad=488.13, nan=0] Epoch 1: 100%|██████████| 51/51 [00:00<00:00, 56.12it/s, loss=9.9382, trans=0.0786, rot=2.0829, grad=488.13, nan=0]
Visual features - mean: -0.002751, std: 0.971579
IMU features - mean: 0.012652, std: 0.837148
GT translations (m) - mean: -0.002376, std: 0.028749
GT quaternions - mean: 0.251869, std: 0.432097
Predicted pose window shape: (1, 7)
[[-0.07746635  0.02214149  1.5632436   0.23260462 -0.74094754 -0.21393622
  -0.5925564 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.38268316 -0.48832458  0.11761497 -0.657698   -0.5864263   0.16513182
  -0.44302264]]
  Ground truth relative pose:
[[ 7.2540191e-05 -2.1480885e-04 -7.4349191e-05 -1.7169118e-04
  -1.2290478e-04  4.1480362e-04  9.9999988e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  55%|█████▍    | 12/22 [00:00<00:00, 118.37it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 141.67it/s]

Epoch 1 Summary:
  Train Loss: 20.946169
  Val Loss: 8.233842
  Val Trans Error: 0.5472 m
  Val Rot Error: 106.16 degrees
  ✓ New best model saved

============================================================
Epoch 2/50
Learning rate: 0.00000544
============================================================
Epoch 2:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 2:   0%|          | 0/51 [00:00<?, ?it/s, loss=10.5122, trans=0.0847, rot=2.0438, grad=219.72, nan=0]Epoch 2:   0%|          | 0/51 [00:00<?, ?it/s, loss=14.1061, trans=0.1207, rot=2.0358, grad=258.31, nan=0]Epoch 2:   0%|          | 0/51 [00:00<?, ?it/s, loss=12.8794, trans=0.1106, rot=1.8183, grad=284.28, nan=0]Epoch 2:   0%|          | 0/51 [00:00<?, ?it/s, loss=12.1470, trans=0.1012, rot=2.0227, grad=222.38, nan=0]Epoch 2:   0%|          | 0/51 [00:00<?, ?it/s, loss=12.9040, trans=0.1106, rot=1.8481, grad=253.85, nan=0]Epoch 2:   0%|          | 0/51 [00:00<?, ?it/s, loss=15.3032, trans=0.1328, rot=2.0216, grad=305.54, nan=0]Epoch 2:  12%|█▏        | 6/51 [00:00<00:00, 58.09it/s, loss=15.3032, trans=0.1328, rot=2.0216, grad=305.54, nan=0]Epoch 2:  12%|█▏        | 6/51 [00:00<00:00, 58.09it/s, loss=14.5706, trans=0.1272, rot=1.8492, grad=257.96, nan=0]Epoch 2:  12%|█▏        | 6/51 [00:00<00:00, 58.09it/s, loss=11.9502, trans=0.1004, rot=1.9057, grad=240.81, nan=0]Epoch 2:  12%|█▏        | 6/51 [00:00<00:00, 58.09it/s, loss=13.3006, trans=0.1134, rot=1.9655, grad=261.03, nan=0]Epoch 2:  12%|█▏        | 6/51 [00:00<00:00, 58.09it/s, loss=13.2427, trans=0.1138, rot=1.8631, grad=226.56, nan=0]Epoch 2:  12%|█▏        | 6/51 [00:00<00:00, 58.09it/s, loss=10.9499, trans=0.0911, rot=1.8406, grad=246.01, nan=0]Epoch 2:  12%|█▏        | 6/51 [00:00<00:00, 58.09it/s, loss=9.9941, trans=0.0790, rot=2.0948, grad=199.17, nan=0] Epoch 2:  12%|█▏        | 6/51 [00:00<00:00, 58.09it/s, loss=12.5462, trans=0.1067, rot=1.8738, grad=223.29, nan=0]Epoch 2:  12%|█▏        | 6/51 [00:00<00:00, 58.09it/s, loss=10.6874, trans=0.0877, rot=1.9161, grad=257.28, nan=0]Epoch 2:  12%|█▏        | 6/51 [00:00<00:00, 58.09it/s, loss=13.4435, trans=0.1157, rot=1.8771, grad=227.41, nan=0]Epoch 2:  29%|██▉       | 15/51 [00:00<00:00, 73.50it/s, loss=13.4435, trans=0.1157, rot=1.8771, grad=227.41, nan=0]Epoch 2:  29%|██▉       | 15/51 [00:00<00:00, 73.50it/s, loss=12.5132, trans=0.1066, rot=1.8543, grad=241.16, nan=0]Epoch 2:  29%|██▉       | 15/51 [00:00<00:00, 73.50it/s, loss=12.2012, trans=0.1029, rot=1.9080, grad=228.65, nan=0]Epoch 2:  29%|██▉       | 15/51 [00:00<00:00, 73.50it/s, loss=10.6018, trans=0.0887, rot=1.7284, grad=182.66, nan=0]Epoch 2:  29%|██▉       | 15/51 [00:00<00:00, 73.50it/s, loss=10.3015, trans=0.0875, rot=1.5563, grad=178.15, nan=0]Epoch 2:  29%|██▉       | 15/51 [00:00<00:00, 73.50it/s, loss=14.8051, trans=0.1301, rot=1.7980, grad=216.45, nan=0]Epoch 2:  29%|██▉       | 15/51 [00:00<00:00, 73.50it/s, loss=13.1207, trans=0.1125, rot=1.8693, grad=245.83, nan=0]Epoch 2:  29%|██▉       | 15/51 [00:00<00:00, 73.50it/s, loss=15.1060, trans=0.1328, rot=1.8260, grad=232.94, nan=0]Epoch 2:  29%|██▉       | 15/51 [00:00<00:00, 73.50it/s, loss=11.6535, trans=0.0991, rot=1.7471, grad=217.97, nan=0]Epoch 2:  45%|████▌     | 23/51 [00:00<00:00, 75.90it/s, loss=11.6535, trans=0.0991, rot=1.7471, grad=217.97, nan=0]Epoch 2:  45%|████▌     | 23/51 [00:00<00:00, 75.90it/s, loss=13.6922, trans=0.1188, rot=1.8170, grad=237.35, nan=0]Epoch 2:  45%|████▌     | 23/51 [00:00<00:00, 75.90it/s, loss=11.7968, trans=0.0993, rot=1.8693, grad=206.21, nan=0]Epoch 2:  45%|████▌     | 23/51 [00:00<00:00, 75.90it/s, loss=10.2322, trans=0.0852, rot=1.7132, grad=275.42, nan=0]Epoch 2:  45%|████▌     | 23/51 [00:00<00:00, 75.90it/s, loss=12.0712, trans=0.1021, rot=1.8565, grad=244.89, nan=0]Epoch 2:  45%|████▌     | 23/51 [00:00<00:00, 75.90it/s, loss=13.2559, trans=0.1135, rot=1.9033, grad=282.26, nan=0]Epoch 2:  45%|████▌     | 23/51 [00:00<00:00, 75.90it/s, loss=12.2084, trans=0.1048, rot=1.7254, grad=257.91, nan=0]Epoch 2:  45%|████▌     | 23/51 [00:00<00:00, 75.90it/s, loss=12.2117, trans=0.1043, rot=1.7832, grad=247.74, nan=0]Epoch 2:  45%|████▌     | 23/51 [00:00<00:00, 75.90it/s, loss=12.6807, trans=0.1103, rot=1.6491, grad=212.95, nan=0]Epoch 2:  45%|████▌     | 23/51 [00:00<00:00, 75.90it/s, loss=12.0227, trans=0.1030, rot=1.7253, grad=190.53, nan=0]Epoch 2:  63%|██████▎   | 32/51 [00:00<00:00, 79.37it/s, loss=12.0227, trans=0.1030, rot=1.7253, grad=190.53, nan=0]Epoch 2:  63%|██████▎   | 32/51 [00:00<00:00, 79.37it/s, loss=10.0281, trans=0.0829, rot=1.7365, grad=205.42, nan=0]Epoch 2:  63%|██████▎   | 32/51 [00:00<00:00, 79.37it/s, loss=12.9166, trans=0.1097, rot=1.9508, grad=223.06, nan=0]Epoch 2:  63%|██████▎   | 32/51 [00:00<00:00, 79.37it/s, loss=11.5976, trans=0.0969, rot=1.9051, grad=217.93, nan=0]Epoch 2:  63%|██████▎   | 32/51 [00:00<00:00, 79.37it/s, loss=10.3665, trans=0.0870, rot=1.6665, grad=186.23, nan=0]Epoch 2:  63%|██████▎   | 32/51 [00:00<00:00, 79.37it/s, loss=11.5337, trans=0.0986, rot=1.6732, grad=238.60, nan=0]Epoch 2:  63%|██████▎   | 32/51 [00:00<00:00, 79.37it/s, loss=11.6516, trans=0.0998, rot=1.6748, grad=192.14, nan=0]Epoch 2:  63%|██████▎   | 32/51 [00:00<00:00, 79.37it/s, loss=14.3430, trans=0.1239, rot=1.9500, grad=275.27, nan=0]Epoch 2:  63%|██████▎   | 32/51 [00:00<00:00, 79.37it/s, loss=12.9934, trans=0.1122, rot=1.7755, grad=326.80, nan=0]Epoch 2:  78%|███████▊  | 40/51 [00:00<00:00, 78.70it/s, loss=12.9934, trans=0.1122, rot=1.7755, grad=326.80, nan=0]Epoch 2:  78%|███████▊  | 40/51 [00:00<00:00, 78.70it/s, loss=9.3941, trans=0.0767, rot=1.7254, grad=182.42, nan=0] Epoch 2:  78%|███████▊  | 40/51 [00:00<00:00, 78.70it/s, loss=13.1692, trans=0.1148, rot=1.6896, grad=219.83, nan=0]Epoch 2:  78%|███████▊  | 40/51 [00:00<00:00, 78.70it/s, loss=10.9811, trans=0.0929, rot=1.6866, grad=225.83, nan=0]Epoch 2:  78%|███████▊  | 40/51 [00:00<00:00, 78.70it/s, loss=12.7538, trans=0.1121, rot=1.5424, grad=190.36, nan=0]Epoch 2:  78%|███████▊  | 40/51 [00:00<00:00, 78.70it/s, loss=10.8789, trans=0.0911, rot=1.7712, grad=225.56, nan=0]Epoch 2:  78%|███████▊  | 40/51 [00:00<00:00, 78.70it/s, loss=9.6161, trans=0.0792, rot=1.6953, grad=151.39, nan=0] Epoch 2:  78%|███████▊  | 40/51 [00:00<00:00, 78.70it/s, loss=14.5754, trans=0.1302, rot=1.5601, grad=290.59, nan=0]Epoch 2:  78%|███████▊  | 40/51 [00:00<00:00, 78.70it/s, loss=10.7195, trans=0.0915, rot=1.5742, grad=166.96, nan=0]Epoch 2:  78%|███████▊  | 40/51 [00:00<00:00, 78.70it/s, loss=8.7567, trans=0.0713, rot=1.6241, grad=171.48, nan=0] Epoch 2:  78%|███████▊  | 40/51 [00:00<00:00, 78.70it/s, loss=9.5701, trans=0.0808, rot=1.4886, grad=262.90, nan=0]Epoch 2:  98%|█████████▊| 50/51 [00:00<00:00, 81.16it/s, loss=9.5701, trans=0.0808, rot=1.4886, grad=262.90, nan=0]Epoch 2:  98%|█████████▊| 50/51 [00:00<00:00, 81.16it/s, loss=11.4172, trans=0.1010, rot=1.3200, grad=456.42, nan=0]Epoch 2: 100%|██████████| 51/51 [00:00<00:00, 76.82it/s, loss=11.4172, trans=0.1010, rot=1.3200, grad=456.42, nan=0]
Visual features - mean: -0.005155, std: 1.028299
IMU features - mean: -0.002095, std: 0.942133
GT translations (m) - mean: -0.000253, std: 0.037557
GT quaternions - mean: 0.250758, std: 0.432743
Predicted pose window shape: (1, 7)
[[ 0.2503673  -0.50855094 -0.17128783 -0.696284    0.6429464  -0.10846703
  -0.30007222]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.02135146 -0.0935126   0.11479543 -0.09615108  0.11500675 -0.37527084
  -0.9147132 ]]
  Ground truth relative pose:
[[-4.1330070e-04  4.4431438e-04 -9.7558011e-05  1.3516843e-04
  -8.3431602e-04  6.7970902e-04  9.9999940e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  77%|███████▋  | 17/22 [00:00<00:00, 168.56it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 168.92it/s]

Epoch 2 Summary:
  Train Loss: 12.083809
  Val Loss: 5.113906
  Val Trans Error: 0.4163 m
  Val Rot Error: 83.08 degrees
  ✓ New best model saved

============================================================
Epoch 3/50
Learning rate: 0.00000588
============================================================
Epoch 3:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 3:   0%|          | 0/51 [00:00<?, ?it/s, loss=11.6937, trans=0.0999, rot=1.7033, grad=195.63, nan=0]Epoch 3:   0%|          | 0/51 [00:00<?, ?it/s, loss=11.0255, trans=0.0932, rot=1.7095, grad=181.01, nan=0]Epoch 3:   0%|          | 0/51 [00:00<?, ?it/s, loss=10.7013, trans=0.0905, rot=1.6477, grad=175.74, nan=0]Epoch 3:   0%|          | 0/51 [00:00<?, ?it/s, loss=11.1976, trans=0.0960, rot=1.5943, grad=187.98, nan=0]Epoch 3:   0%|          | 0/51 [00:00<?, ?it/s, loss=10.1912, trans=0.0858, rot=1.6066, grad=195.44, nan=0]Epoch 3:   0%|          | 0/51 [00:00<?, ?it/s, loss=10.1561, trans=0.0866, rot=1.4995, grad=173.77, nan=0]Epoch 3:  12%|█▏        | 6/51 [00:00<00:00, 56.94it/s, loss=10.1561, trans=0.0866, rot=1.4995, grad=173.77, nan=0]Epoch 3:  12%|█▏        | 6/51 [00:00<00:00, 56.94it/s, loss=10.9839, trans=0.0940, rot=1.5861, grad=199.40, nan=0]Epoch 3:  12%|█▏        | 6/51 [00:00<00:00, 56.94it/s, loss=15.8968, trans=0.1435, rot=1.5495, grad=247.83, nan=0]Epoch 3:  12%|█▏        | 6/51 [00:00<00:00, 56.94it/s, loss=12.9738, trans=0.1124, rot=1.7313, grad=200.69, nan=0]Epoch 3:  12%|█▏        | 6/51 [00:00<00:00, 56.94it/s, loss=10.5205, trans=0.0897, rot=1.5530, grad=272.09, nan=0]Epoch 3:  12%|█▏        | 6/51 [00:00<00:00, 56.94it/s, loss=11.1118, trans=0.0938, rot=1.7360, grad=210.00, nan=0]Epoch 3:  12%|█▏        | 6/51 [00:00<00:00, 56.94it/s, loss=9.0947, trans=0.0759, rot=1.5030, grad=199.59, nan=0] Epoch 3:  12%|█▏        | 6/51 [00:00<00:00, 56.94it/s, loss=9.5079, trans=0.0812, rot=1.3865, grad=161.95, nan=0]Epoch 3:  12%|█▏        | 6/51 [00:00<00:00, 56.94it/s, loss=8.6740, trans=0.0715, rot=1.5223, grad=166.18, nan=0]Epoch 3:  27%|██▋       | 14/51 [00:00<00:00, 69.04it/s, loss=8.6740, trans=0.0715, rot=1.5223, grad=166.18, nan=0]Epoch 3:  27%|██▋       | 14/51 [00:00<00:00, 69.04it/s, loss=9.4575, trans=0.0795, rot=1.5103, grad=202.70, nan=0]Epoch 3:  27%|██▋       | 14/51 [00:00<00:00, 69.04it/s, loss=9.7167, trans=0.0838, rot=1.3335, grad=181.84, nan=0]Epoch 3:  27%|██▋       | 14/51 [00:00<00:00, 69.04it/s, loss=8.6833, trans=0.0736, rot=1.3228, grad=180.90, nan=0]Epoch 3:  27%|██▋       | 14/51 [00:00<00:00, 69.04it/s, loss=9.5001, trans=0.0809, rot=1.4124, grad=247.00, nan=0]Epoch 3:  27%|██▋       | 14/51 [00:00<00:00, 69.04it/s, loss=10.6849, trans=0.0941, rot=1.2780, grad=184.98, nan=0]Epoch 3:  27%|██▋       | 14/51 [00:00<00:00, 69.04it/s, loss=8.8299, trans=0.0751, rot=1.3232, grad=149.28, nan=0] Epoch 3:  27%|██▋       | 14/51 [00:00<00:00, 69.04it/s, loss=9.1154, trans=0.0754, rot=1.5705, grad=185.62, nan=0]Epoch 3:  27%|██▋       | 14/51 [00:00<00:00, 69.04it/s, loss=7.5650, trans=0.0626, rot=1.3026, grad=178.73, nan=0]Epoch 3:  27%|██▋       | 14/51 [00:00<00:00, 69.04it/s, loss=9.6496, trans=0.0809, rot=1.5582, grad=190.39, nan=0]Epoch 3:  27%|██▋       | 14/51 [00:00<00:00, 69.04it/s, loss=9.1116, trans=0.0758, rot=1.5269, grad=170.74, nan=0]Epoch 3:  47%|████▋     | 24/51 [00:00<00:00, 80.28it/s, loss=9.1116, trans=0.0758, rot=1.5269, grad=170.74, nan=0]Epoch 3:  47%|████▋     | 24/51 [00:00<00:00, 80.28it/s, loss=8.9113, trans=0.0755, rot=1.3656, grad=148.20, nan=0]Epoch 3:  47%|████▋     | 24/51 [00:00<00:00, 80.28it/s, loss=10.6605, trans=0.0930, rot=1.3614, grad=244.38, nan=0]Epoch 3:  47%|████▋     | 24/51 [00:00<00:00, 80.28it/s, loss=10.0051, trans=0.0863, rot=1.3780, grad=154.71, nan=0]Epoch 3:  47%|████▋     | 24/51 [00:00<00:00, 80.28it/s, loss=8.0248, trans=0.0663, rot=1.3978, grad=148.13, nan=0] Epoch 3:  47%|████▋     | 24/51 [00:00<00:00, 80.28it/s, loss=9.0857, trans=0.0767, rot=1.4140, grad=173.47, nan=0]Epoch 3:  47%|████▋     | 24/51 [00:00<00:00, 80.28it/s, loss=8.6098, trans=0.0733, rot=1.2843, grad=217.38, nan=0]Epoch 3:  47%|████▋     | 24/51 [00:00<00:00, 80.28it/s, loss=8.7903, trans=0.0733, rot=1.4580, grad=174.39, nan=0]Epoch 3:  47%|████▋     | 24/51 [00:00<00:00, 80.28it/s, loss=10.7933, trans=0.0950, rot=1.2951, grad=227.38, nan=0]Epoch 3:  47%|████▋     | 24/51 [00:00<00:00, 80.28it/s, loss=11.5902, trans=0.1045, rot=1.1431, grad=244.74, nan=0]Epoch 3:  47%|████▋     | 24/51 [00:00<00:00, 80.28it/s, loss=7.4242, trans=0.0611, rot=1.3184, grad=167.28, nan=0] Epoch 3:  67%|██████▋   | 34/51 [00:00<00:00, 85.61it/s, loss=7.4242, trans=0.0611, rot=1.3184, grad=167.28, nan=0]Epoch 3:  67%|██████▋   | 34/51 [00:00<00:00, 85.61it/s, loss=8.1586, trans=0.0696, rot=1.1974, grad=170.84, nan=0]Epoch 3:  67%|██████▋   | 34/51 [00:00<00:00, 85.61it/s, loss=8.9051, trans=0.0757, rot=1.3367, grad=172.45, nan=0]Epoch 3:  67%|██████▋   | 34/51 [00:00<00:00, 85.61it/s, loss=9.6386, trans=0.0845, rot=1.1908, grad=170.54, nan=0]Epoch 3:  67%|██████▋   | 34/51 [00:00<00:00, 85.61it/s, loss=8.7483, trans=0.0744, rot=1.3094, grad=199.38, nan=0]Epoch 3:  67%|██████▋   | 34/51 [00:00<00:00, 85.61it/s, loss=8.1414, trans=0.0692, rot=1.2239, grad=194.39, nan=0]Epoch 3:  67%|██████▋   | 34/51 [00:00<00:00, 85.61it/s, loss=7.7397, trans=0.0653, rot=1.2102, grad=167.86, nan=0]Epoch 3:  67%|██████▋   | 34/51 [00:00<00:00, 85.61it/s, loss=11.2647, trans=0.0991, rot=1.3501, grad=292.09, nan=0]Epoch 3:  67%|██████▋   | 34/51 [00:00<00:00, 85.61it/s, loss=8.7197, trans=0.0744, rot=1.2804, grad=156.57, nan=0] Epoch 3:  67%|██████▋   | 34/51 [00:00<00:00, 85.61it/s, loss=8.4176, trans=0.0702, rot=1.4001, grad=198.24, nan=0]Epoch 3:  84%|████████▍ | 43/51 [00:00<00:00, 86.45it/s, loss=8.4176, trans=0.0702, rot=1.4001, grad=198.24, nan=0]Epoch 3:  84%|████████▍ | 43/51 [00:00<00:00, 86.45it/s, loss=7.5664, trans=0.0636, rot=1.2074, grad=160.27, nan=0]Epoch 3:  84%|████████▍ | 43/51 [00:00<00:00, 86.45it/s, loss=8.3523, trans=0.0710, rot=1.2526, grad=159.60, nan=0]Epoch 3:  84%|████████▍ | 43/51 [00:00<00:00, 86.45it/s, loss=8.7152, trans=0.0739, rot=1.3241, grad=146.89, nan=0]Epoch 3:  84%|████████▍ | 43/51 [00:00<00:00, 86.45it/s, loss=9.3865, trans=0.0808, rot=1.3025, grad=194.37, nan=0]Epoch 3:  84%|████████▍ | 43/51 [00:00<00:00, 86.45it/s, loss=10.4579, trans=0.0932, rot=1.1340, grad=220.51, nan=0]Epoch 3:  84%|████████▍ | 43/51 [00:00<00:00, 86.45it/s, loss=8.9654, trans=0.0774, rot=1.2255, grad=170.15, nan=0] Epoch 3:  84%|████████▍ | 43/51 [00:00<00:00, 86.45it/s, loss=10.4682, trans=0.0923, rot=1.2385, grad=215.16, nan=0]Epoch 3:  84%|████████▍ | 43/51 [00:00<00:00, 86.45it/s, loss=8.2592, trans=0.0739, rot=0.8731, grad=324.46, nan=0] Epoch 3: 100%|██████████| 51/51 [00:00<00:00, 81.44it/s, loss=8.2592, trans=0.0739, rot=0.8731, grad=324.46, nan=0]
Visual features - mean: -0.002749, std: 0.937014
IMU features - mean: -0.003502, std: 1.054664
GT translations (m) - mean: -0.001357, std: 0.019542
GT quaternions - mean: 0.250557, std: 0.432860
Predicted pose window shape: (1, 7)
[[ 0.5018201   0.2894354  -0.17917266 -0.3555751   0.41635743 -0.15423636
  -0.82245   ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.59740794  0.398203   -0.10171808 -0.19725493 -0.4275078   0.13425736
  -0.8719533 ]]
  Ground truth relative pose:
[[ 2.9085670e-04  3.9658248e-03  1.8089190e-03 -3.8314164e-03
   4.1007828e-03 -7.4110627e-03  9.9995679e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  82%|████████▏ | 18/22 [00:00<00:00, 176.50it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 172.24it/s]

Epoch 3 Summary:
  Train Loss: 9.643970
  Val Loss: 3.808499
  Val Trans Error: 0.3611 m
  Val Rot Error: 61.46 degrees
  ✓ New best model saved

============================================================
Epoch 4/50
Learning rate: 0.00000588
============================================================
Epoch 4:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 4:   0%|          | 0/51 [00:00<?, ?it/s, loss=8.1790, trans=0.0694, rot=1.2439, grad=148.68, nan=0]Epoch 4:   0%|          | 0/51 [00:00<?, ?it/s, loss=9.8646, trans=0.0867, rot=1.1992, grad=184.41, nan=0]Epoch 4:   0%|          | 0/51 [00:00<?, ?it/s, loss=9.2002, trans=0.0809, rot=1.1055, grad=145.70, nan=0]Epoch 4:   0%|          | 0/51 [00:00<?, ?it/s, loss=7.7739, trans=0.0670, rot=1.0736, grad=128.54, nan=0]Epoch 4:   0%|          | 0/51 [00:00<?, ?it/s, loss=9.3546, trans=0.0819, rot=1.1601, grad=172.31, nan=0]Epoch 4:   0%|          | 0/51 [00:00<?, ?it/s, loss=7.6418, trans=0.0645, rot=1.1966, grad=166.47, nan=0]Epoch 4:  12%|█▏        | 6/51 [00:00<00:00, 54.51it/s, loss=7.6418, trans=0.0645, rot=1.1966, grad=166.47, nan=0]Epoch 4:  12%|█▏        | 6/51 [00:00<00:00, 54.51it/s, loss=9.4368, trans=0.0826, rot=1.1746, grad=216.55, nan=0]Epoch 4:  12%|█▏        | 6/51 [00:00<00:00, 54.51it/s, loss=9.3562, trans=0.0824, rot=1.1156, grad=229.78, nan=0]Epoch 4:  12%|█▏        | 6/51 [00:00<00:00, 54.51it/s, loss=7.5353, trans=0.0650, rot=1.0389, grad=151.18, nan=0]Epoch 4:  12%|█▏        | 6/51 [00:00<00:00, 54.51it/s, loss=8.4232, trans=0.0735, rot=1.0748, grad=153.26, nan=0]Epoch 4:  12%|█▏        | 6/51 [00:00<00:00, 54.51it/s, loss=9.6969, trans=0.0863, rot=1.0710, grad=173.97, nan=0]Epoch 4:  12%|█▏        | 6/51 [00:00<00:00, 54.51it/s, loss=8.3155, trans=0.0716, rot=1.1600, grad=174.34, nan=0]Epoch 4:  12%|█▏        | 6/51 [00:00<00:00, 54.51it/s, loss=8.7797, trans=0.0756, rot=1.2223, grad=147.82, nan=0]Epoch 4:  12%|█▏        | 6/51 [00:00<00:00, 54.51it/s, loss=9.6368, trans=0.0862, rot=1.0196, grad=180.78, nan=0]Epoch 4:  12%|█▏        | 6/51 [00:00<00:00, 54.51it/s, loss=7.2327, trans=0.0618, rot=1.0524, grad=140.55, nan=0]Epoch 4:  29%|██▉       | 15/51 [00:00<00:00, 71.92it/s, loss=7.2327, trans=0.0618, rot=1.0524, grad=140.55, nan=0]Epoch 4:  29%|██▉       | 15/51 [00:00<00:00, 71.92it/s, loss=8.7820, trans=0.0764, rot=1.1371, grad=147.57, nan=0]Epoch 4:  29%|██▉       | 15/51 [00:00<00:00, 71.92it/s, loss=8.7516, trans=0.0754, rot=1.2101, grad=213.69, nan=0]Epoch 4:  29%|██▉       | 15/51 [00:00<00:00, 71.92it/s, loss=7.8717, trans=0.0669, rot=1.1777, grad=125.58, nan=0]Epoch 4:  29%|██▉       | 15/51 [00:00<00:00, 71.92it/s, loss=9.8067, trans=0.0877, rot=1.0353, grad=241.80, nan=0]Epoch 4:  29%|██▉       | 15/51 [00:00<00:00, 71.92it/s, loss=9.0428, trans=0.0784, rot=1.2071, grad=186.70, nan=0]Epoch 4:  29%|██▉       | 15/51 [00:00<00:00, 71.92it/s, loss=10.3354, trans=0.0938, rot=0.9520, grad=185.47, nan=0]Epoch 4:  29%|██▉       | 15/51 [00:00<00:00, 71.92it/s, loss=6.6609, trans=0.0562, rot=1.0367, grad=157.43, nan=0] Epoch 4:  29%|██▉       | 15/51 [00:00<00:00, 71.92it/s, loss=8.5041, trans=0.0744, rot=1.0631, grad=226.63, nan=0]Epoch 4:  29%|██▉       | 15/51 [00:00<00:00, 71.92it/s, loss=8.8036, trans=0.0768, rot=1.1239, grad=183.17, nan=0]Epoch 4:  29%|██▉       | 15/51 [00:00<00:00, 71.92it/s, loss=8.5850, trans=0.0754, rot=1.0490, grad=216.77, nan=0]Epoch 4:  49%|████▉     | 25/51 [00:00<00:00, 80.99it/s, loss=8.5850, trans=0.0754, rot=1.0490, grad=216.77, nan=0]Epoch 4:  49%|████▉     | 25/51 [00:00<00:00, 80.99it/s, loss=6.7450, trans=0.0580, rot=0.9472, grad=132.13, nan=0]Epoch 4:  49%|████▉     | 25/51 [00:00<00:00, 80.99it/s, loss=10.1402, trans=0.0898, rot=1.1558, grad=198.65, nan=0]Epoch 4:  49%|████▉     | 25/51 [00:00<00:00, 80.99it/s, loss=8.7511, trans=0.0765, rot=1.1001, grad=151.89, nan=0] Epoch 4:  49%|████▉     | 25/51 [00:00<00:00, 80.99it/s, loss=9.6277, trans=0.0854, rot=1.0927, grad=175.67, nan=0]Epoch 4:  49%|████▉     | 25/51 [00:00<00:00, 80.99it/s, loss=7.5332, trans=0.0633, rot=1.2049, grad=137.13, nan=0]Epoch 4:  49%|████▉     | 25/51 [00:00<00:00, 80.99it/s, loss=7.3827, trans=0.0631, rot=1.0734, grad=161.01, nan=0]Epoch 4:  49%|████▉     | 25/51 [00:00<00:00, 80.99it/s, loss=7.6155, trans=0.0651, rot=1.1097, grad=142.01, nan=0]Epoch 4:  49%|████▉     | 25/51 [00:00<00:00, 80.99it/s, loss=8.3645, trans=0.0734, rot=1.0220, grad=165.29, nan=0]Epoch 4:  49%|████▉     | 25/51 [00:00<00:00, 80.99it/s, loss=8.5519, trans=0.0756, rot=0.9968, grad=162.97, nan=0]Epoch 4:  49%|████▉     | 25/51 [00:00<00:00, 80.99it/s, loss=7.5981, trans=0.0663, rot=0.9726, grad=145.95, nan=0]Epoch 4:  69%|██████▊   | 35/51 [00:00<00:00, 84.91it/s, loss=7.5981, trans=0.0663, rot=0.9726, grad=145.95, nan=0]Epoch 4:  69%|██████▊   | 35/51 [00:00<00:00, 84.91it/s, loss=7.9568, trans=0.0689, rot=1.0653, grad=197.90, nan=0]Epoch 4:  69%|██████▊   | 35/51 [00:00<00:00, 84.91it/s, loss=9.8762, trans=0.0881, rot=1.0688, grad=211.54, nan=0]Epoch 4:  69%|██████▊   | 35/51 [00:00<00:00, 84.91it/s, loss=6.3783, trans=0.0536, rot=1.0151, grad=152.40, nan=0]Epoch 4:  69%|██████▊   | 35/51 [00:00<00:00, 84.91it/s, loss=6.8923, trans=0.0578, rot=1.1086, grad=147.98, nan=0]Epoch 4:  69%|██████▊   | 35/51 [00:00<00:00, 84.91it/s, loss=8.8334, trans=0.0786, rot=0.9729, grad=165.34, nan=0]Epoch 4:  69%|██████▊   | 35/51 [00:00<00:00, 84.91it/s, loss=10.9672, trans=0.0992, rot=1.0465, grad=185.25, nan=0]Epoch 4:  69%|██████▊   | 35/51 [00:00<00:00, 84.91it/s, loss=8.0387, trans=0.0693, rot=1.1079, grad=136.34, nan=0] Epoch 4:  69%|██████▊   | 35/51 [00:00<00:00, 84.91it/s, loss=7.4569, trans=0.0651, rot=0.9455, grad=157.07, nan=0]Epoch 4:  69%|██████▊   | 35/51 [00:00<00:00, 84.91it/s, loss=9.7261, trans=0.0865, rot=1.0760, grad=169.29, nan=0]Epoch 4:  86%|████████▋ | 44/51 [00:00<00:00, 84.68it/s, loss=9.7261, trans=0.0865, rot=1.0760, grad=169.29, nan=0]Epoch 4:  86%|████████▋ | 44/51 [00:00<00:00, 84.68it/s, loss=7.2495, trans=0.0628, rot=0.9707, grad=146.60, nan=0]Epoch 4:  86%|████████▋ | 44/51 [00:00<00:00, 84.68it/s, loss=8.5629, trans=0.0765, rot=0.9167, grad=169.16, nan=0]Epoch 4:  86%|████████▋ | 44/51 [00:00<00:00, 84.68it/s, loss=7.0728, trans=0.0619, rot=0.8874, grad=117.84, nan=0]Epoch 4:  86%|████████▋ | 44/51 [00:00<00:00, 84.68it/s, loss=7.5505, trans=0.0651, rot=1.0421, grad=153.07, nan=0]Epoch 4:  86%|████████▋ | 44/51 [00:00<00:00, 84.68it/s, loss=7.9924, trans=0.0706, rot=0.9334, grad=184.47, nan=0]Epoch 4:  86%|████████▋ | 44/51 [00:00<00:00, 84.68it/s, loss=8.4953, trans=0.0754, rot=0.9572, grad=169.49, nan=0]Epoch 4:  86%|████████▋ | 44/51 [00:00<00:00, 84.68it/s, loss=5.1242, trans=0.0422, rot=0.9066, grad=295.97, nan=0]Epoch 4: 100%|██████████| 51/51 [00:00<00:00, 80.33it/s, loss=5.1242, trans=0.0422, rot=0.9066, grad=295.97, nan=0]
Visual features - mean: -0.001646, std: 0.971844
IMU features - mean: 0.003916, std: 0.832158
GT translations (m) - mean: -0.001220, std: 0.030996
GT quaternions - mean: 0.251167, std: 0.432506
Predicted pose window shape: (1, 7)
[[-0.3480578  -0.324545    0.03507012 -0.6544398   0.442428   -0.20180246
  -0.5790007 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.40713444 -0.03312171  0.0249667  -0.12233978 -0.23995139  0.07848652
  -0.9598417 ]]
  Ground truth relative pose:
[[ 9.6278789e-05 -1.0377810e-03 -1.3989591e-04 -1.2603624e-03
  -1.7914770e-03 -4.0015572e-04  9.9999750e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  77%|███████▋  | 17/22 [00:00<00:00, 169.80it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 157.35it/s]

Epoch 4 Summary:
  Train Loss: 8.393217
  Val Loss: 2.886252
  Val Trans Error: 0.3112 m
  Val Rot Error: 48.87 degrees
  ✓ New best model saved

============================================================
Epoch 5/50
Learning rate: 0.00000588
============================================================
Epoch 5:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 5:   0%|          | 0/51 [00:00<?, ?it/s, loss=9.7887, trans=0.0878, rot=1.0103, grad=162.27, nan=0]Epoch 5:   0%|          | 0/51 [00:00<?, ?it/s, loss=7.9692, trans=0.0710, rot=0.8662, grad=168.39, nan=0]Epoch 5:   0%|          | 0/51 [00:00<?, ?it/s, loss=9.2316, trans=0.0826, rot=0.9691, grad=163.38, nan=0]Epoch 5:   0%|          | 0/51 [00:00<?, ?it/s, loss=8.6206, trans=0.0768, rot=0.9396, grad=215.00, nan=0]Epoch 5:   0%|          | 0/51 [00:00<?, ?it/s, loss=8.4753, trans=0.0735, rot=1.1277, grad=157.48, nan=0]Epoch 5:   0%|          | 0/51 [00:00<?, ?it/s, loss=8.5349, trans=0.0749, rot=1.0431, grad=148.45, nan=0]Epoch 5:  12%|█▏        | 6/51 [00:00<00:00, 56.36it/s, loss=8.5349, trans=0.0749, rot=1.0431, grad=148.45, nan=0]Epoch 5:  12%|█▏        | 6/51 [00:00<00:00, 56.36it/s, loss=8.0871, trans=0.0716, rot=0.9313, grad=180.39, nan=0]Epoch 5:  12%|█▏        | 6/51 [00:00<00:00, 56.36it/s, loss=9.0063, trans=0.0808, rot=0.9291, grad=151.34, nan=0]Epoch 5:  12%|█▏        | 6/51 [00:00<00:00, 56.36it/s, loss=6.1822, trans=0.0534, rot=0.8428, grad=124.10, nan=0]Epoch 5:  12%|█▏        | 6/51 [00:00<00:00, 56.36it/s, loss=8.1254, trans=0.0723, rot=0.8958, grad=152.18, nan=0]Epoch 5:  12%|█▏        | 6/51 [00:00<00:00, 56.36it/s, loss=9.3085, trans=0.0834, rot=0.9677, grad=161.47, nan=0]Epoch 5:  12%|█▏        | 6/51 [00:00<00:00, 56.36it/s, loss=9.0250, trans=0.0810, rot=0.9204, grad=187.99, nan=0]Epoch 5:  12%|█▏        | 6/51 [00:00<00:00, 56.36it/s, loss=9.3433, trans=0.0851, rot=0.8378, grad=157.40, nan=0]Epoch 5:  12%|█▏        | 6/51 [00:00<00:00, 56.36it/s, loss=6.8678, trans=0.0577, rot=1.0984, grad=141.79, nan=0]Epoch 5:  12%|█▏        | 6/51 [00:00<00:00, 56.36it/s, loss=6.6717, trans=0.0582, rot=0.8486, grad=151.28, nan=0]Epoch 5:  12%|█▏        | 6/51 [00:00<00:00, 56.36it/s, loss=6.6824, trans=0.0565, rot=1.0327, grad=134.30, nan=0]Epoch 5:  31%|███▏      | 16/51 [00:00<00:00, 78.81it/s, loss=6.6824, trans=0.0565, rot=1.0327, grad=134.30, nan=0]Epoch 5:  31%|███▏      | 16/51 [00:00<00:00, 78.81it/s, loss=7.1879, trans=0.0630, rot=0.8898, grad=139.73, nan=0]Epoch 5:  31%|███▏      | 16/51 [00:00<00:00, 78.81it/s, loss=8.1287, trans=0.0721, rot=0.9163, grad=167.02, nan=0]Epoch 5:  31%|███▏      | 16/51 [00:00<00:00, 78.81it/s, loss=8.9124, trans=0.0792, rot=0.9909, grad=234.15, nan=0]Epoch 5:  31%|███▏      | 16/51 [00:00<00:00, 78.81it/s, loss=8.0029, trans=0.0711, rot=0.8931, grad=132.75, nan=0]Epoch 5:  31%|███▏      | 16/51 [00:00<00:00, 78.81it/s, loss=7.5817, trans=0.0668, rot=0.9058, grad=162.55, nan=0]Epoch 5:  31%|███▏      | 16/51 [00:00<00:00, 78.81it/s, loss=7.7465, trans=0.0687, rot=0.8766, grad=165.01, nan=0]Epoch 5:  31%|███▏      | 16/51 [00:00<00:00, 78.81it/s, loss=8.3188, trans=0.0741, rot=0.9105, grad=136.45, nan=0]Epoch 5:  31%|███▏      | 16/51 [00:00<00:00, 78.81it/s, loss=8.0327, trans=0.0724, rot=0.7888, grad=172.88, nan=0]Epoch 5:  31%|███▏      | 16/51 [00:00<00:00, 78.81it/s, loss=9.1592, trans=0.0824, rot=0.9159, grad=150.74, nan=0]Epoch 5:  31%|███▏      | 16/51 [00:00<00:00, 78.81it/s, loss=7.6742, trans=0.0679, rot=0.8853, grad=138.67, nan=0]Epoch 5:  51%|█████     | 26/51 [00:00<00:00, 84.36it/s, loss=7.6742, trans=0.0679, rot=0.8853, grad=138.67, nan=0]Epoch 5:  51%|█████     | 26/51 [00:00<00:00, 84.36it/s, loss=7.6070, trans=0.0677, rot=0.8345, grad=150.38, nan=0]Epoch 5:  51%|█████     | 26/51 [00:00<00:00, 84.36it/s, loss=6.9692, trans=0.0605, rot=0.9157, grad=139.30, nan=0]Epoch 5:  51%|█████     | 26/51 [00:00<00:00, 84.36it/s, loss=7.9182, trans=0.0699, rot=0.9257, grad=153.76, nan=0]Epoch 5:  51%|█████     | 26/51 [00:00<00:00, 84.36it/s, loss=7.1031, trans=0.0621, rot=0.8890, grad=185.34, nan=0]Epoch 5:  51%|█████     | 26/51 [00:00<00:00, 84.36it/s, loss=7.9179, trans=0.0708, rot=0.8376, grad=160.63, nan=0]Epoch 5:  51%|█████     | 26/51 [00:00<00:00, 84.36it/s, loss=5.4408, trans=0.0477, rot=0.6668, grad=123.35, nan=0]Epoch 5:  51%|█████     | 26/51 [00:00<00:00, 84.36it/s, loss=8.0432, trans=0.0710, rot=0.9437, grad=194.80, nan=0]Epoch 5:  51%|█████     | 26/51 [00:00<00:00, 84.36it/s, loss=6.6875, trans=0.0579, rot=0.8977, grad=126.52, nan=0]Epoch 5:  51%|█████     | 26/51 [00:00<00:00, 84.36it/s, loss=6.7147, trans=0.0584, rot=0.8764, grad=122.62, nan=0]Epoch 5:  51%|█████     | 26/51 [00:00<00:00, 84.36it/s, loss=6.7910, trans=0.0598, rot=0.8106, grad=130.33, nan=0]Epoch 5:  71%|███████   | 36/51 [00:00<00:00, 87.41it/s, loss=6.7910, trans=0.0598, rot=0.8106, grad=130.33, nan=0]Epoch 5:  71%|███████   | 36/51 [00:00<00:00, 87.41it/s, loss=7.0061, trans=0.0607, rot=0.9366, grad=151.92, nan=0]Epoch 5:  71%|███████   | 36/51 [00:00<00:00, 87.41it/s, loss=7.2179, trans=0.0641, rot=0.8029, grad=147.24, nan=0]Epoch 5:  71%|███████   | 36/51 [00:00<00:00, 87.41it/s, loss=7.5664, trans=0.0675, rot=0.8154, grad=114.47, nan=0]Epoch 5:  71%|███████   | 36/51 [00:00<00:00, 87.41it/s, loss=7.2507, trans=0.0636, rot=0.8911, grad=170.10, nan=0]Epoch 5:  71%|███████   | 36/51 [00:00<00:00, 87.41it/s, loss=5.9715, trans=0.0511, rot=0.8619, grad=135.03, nan=0]Epoch 5:  71%|███████   | 36/51 [00:00<00:00, 87.41it/s, loss=8.5095, trans=0.0775, rot=0.7606, grad=182.52, nan=0]Epoch 5:  71%|███████   | 36/51 [00:00<00:00, 87.41it/s, loss=6.2758, trans=0.0547, rot=0.8025, grad=124.76, nan=0]Epoch 5:  71%|███████   | 36/51 [00:00<00:00, 87.41it/s, loss=8.0920, trans=0.0725, rot=0.8410, grad=153.20, nan=0]Epoch 5:  71%|███████   | 36/51 [00:00<00:00, 87.41it/s, loss=6.6753, trans=0.0585, rot=0.8246, grad=152.88, nan=0]Epoch 5:  71%|███████   | 36/51 [00:00<00:00, 87.41it/s, loss=8.7697, trans=0.0800, rot=0.7709, grad=163.43, nan=0]Epoch 5:  90%|█████████ | 46/51 [00:00<00:00, 89.75it/s, loss=8.7697, trans=0.0800, rot=0.7709, grad=163.43, nan=0]Epoch 5:  90%|█████████ | 46/51 [00:00<00:00, 89.75it/s, loss=6.0106, trans=0.0528, rot=0.7345, grad=158.21, nan=0]Epoch 5:  90%|█████████ | 46/51 [00:00<00:00, 89.75it/s, loss=6.4121, trans=0.0560, rot=0.8090, grad=123.13, nan=0]Epoch 5:  90%|█████████ | 46/51 [00:00<00:00, 89.75it/s, loss=9.2710, trans=0.0847, rot=0.8044, grad=156.49, nan=0]Epoch 5:  90%|█████████ | 46/51 [00:00<00:00, 89.75it/s, loss=8.7513, trans=0.0781, rot=0.9457, grad=155.51, nan=0]Epoch 5:  90%|█████████ | 46/51 [00:00<00:00, 89.75it/s, loss=4.5889, trans=0.0396, rot=0.6284, grad=236.73, nan=0]Epoch 5: 100%|██████████| 51/51 [00:00<00:00, 84.87it/s, loss=4.5889, trans=0.0396, rot=0.6284, grad=236.73, nan=0]
Visual features - mean: 0.002540, std: 0.990211
IMU features - mean: -0.001223, std: 1.030208
GT translations (m) - mean: 0.000236, std: 0.026025
GT quaternions - mean: 0.251386, std: 0.432378
Predicted pose window shape: (1, 7)
[[ 0.4068551  -0.29633656 -0.17891493 -0.24897389 -0.05303053 -0.07694618
  -0.9639912 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.11987468  0.04156611  0.3172283  -0.08590047 -0.2078115  -0.17567368
  -0.9584227 ]]
  Ground truth relative pose:
[[-1.0930961e-03 -1.9184416e-04 -3.9565813e-04  2.4216326e-03
  -4.4832830e-03 -1.5749338e-03  9.9998581e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 184.87it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 161.44it/s]

Epoch 5 Summary:
  Train Loss: 7.690714
  Val Loss: 2.294092
  Val Trans Error: 0.2766 m
  Val Rot Error: 38.21 degrees
  ✓ New best model saved

============================================================
Epoch 6/50
Learning rate: 0.00000588
============================================================
Epoch 6:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 6:   0%|          | 0/51 [00:00<?, ?it/s, loss=8.8994, trans=0.0813, rot=0.7730, grad=164.02, nan=0]Epoch 6:   0%|          | 0/51 [00:00<?, ?it/s, loss=8.2642, trans=0.0738, rot=0.8828, grad=164.44, nan=0]Epoch 6:   0%|          | 0/51 [00:00<?, ?it/s, loss=7.6069, trans=0.0689, rot=0.7149, grad=142.06, nan=0]Epoch 6:   0%|          | 0/51 [00:00<?, ?it/s, loss=5.7969, trans=0.0509, rot=0.7075, grad=152.04, nan=0]Epoch 6:   0%|          | 0/51 [00:00<?, ?it/s, loss=6.0803, trans=0.0524, rot=0.8389, grad=128.00, nan=0]Epoch 6:   0%|          | 0/51 [00:00<?, ?it/s, loss=8.3596, trans=0.0756, rot=0.7951, grad=129.64, nan=0]Epoch 6:  12%|█▏        | 6/51 [00:00<00:00, 58.91it/s, loss=8.3596, trans=0.0756, rot=0.7951, grad=129.64, nan=0]Epoch 6:  12%|█▏        | 6/51 [00:00<00:00, 58.91it/s, loss=6.6785, trans=0.0585, rot=0.8310, grad=159.36, nan=0]Epoch 6:  12%|█▏        | 6/51 [00:00<00:00, 58.91it/s, loss=10.2567, trans=0.0945, rot=0.8082, grad=206.91, nan=0]Epoch 6:  12%|█▏        | 6/51 [00:00<00:00, 58.91it/s, loss=8.2823, trans=0.0750, rot=0.7844, grad=151.44, nan=0] Epoch 6:  12%|█▏        | 6/51 [00:00<00:00, 58.91it/s, loss=6.6895, trans=0.0591, rot=0.7793, grad=145.50, nan=0]Epoch 6:  12%|█▏        | 6/51 [00:00<00:00, 58.91it/s, loss=7.1131, trans=0.0650, rot=0.6110, grad=152.92, nan=0]Epoch 6:  12%|█▏        | 6/51 [00:00<00:00, 58.91it/s, loss=6.2805, trans=0.0550, rot=0.7840, grad=164.75, nan=0]Epoch 6:  12%|█▏        | 6/51 [00:00<00:00, 58.91it/s, loss=7.1438, trans=0.0643, rot=0.7102, grad=126.72, nan=0]Epoch 6:  12%|█▏        | 6/51 [00:00<00:00, 58.91it/s, loss=7.7861, trans=0.0700, rot=0.7910, grad=129.27, nan=0]Epoch 6:  12%|█▏        | 6/51 [00:00<00:00, 58.91it/s, loss=7.7879, trans=0.0697, rot=0.8204, grad=159.86, nan=0]Epoch 6:  12%|█▏        | 6/51 [00:00<00:00, 58.91it/s, loss=6.2962, trans=0.0556, rot=0.7322, grad=122.28, nan=0]Epoch 6:  31%|███▏      | 16/51 [00:00<00:00, 78.28it/s, loss=6.2962, trans=0.0556, rot=0.7322, grad=122.28, nan=0]Epoch 6:  31%|███▏      | 16/51 [00:00<00:00, 78.28it/s, loss=9.8786, trans=0.0920, rot=0.6771, grad=167.82, nan=0]Epoch 6:  31%|███▏      | 16/51 [00:00<00:00, 78.28it/s, loss=6.3334, trans=0.0572, rot=0.6156, grad=145.73, nan=0]Epoch 6:  31%|███▏      | 16/51 [00:00<00:00, 78.28it/s, loss=4.5636, trans=0.0393, rot=0.6346, grad=116.24, nan=0]Epoch 6:  31%|███▏      | 16/51 [00:00<00:00, 78.28it/s, loss=7.1136, trans=0.0635, rot=0.7650, grad=127.61, nan=0]Epoch 6:  31%|███▏      | 16/51 [00:00<00:00, 78.28it/s, loss=6.6414, trans=0.0590, rot=0.7449, grad=182.29, nan=0]Epoch 6:  31%|███▏      | 16/51 [00:00<00:00, 78.28it/s, loss=6.2936, trans=0.0552, rot=0.7769, grad=127.52, nan=0]Epoch 6:  31%|███▏      | 16/51 [00:00<00:00, 78.28it/s, loss=6.8785, trans=0.0622, rot=0.6539, grad=165.71, nan=0]Epoch 6:  31%|███▏      | 16/51 [00:00<00:00, 78.28it/s, loss=7.1765, trans=0.0644, rot=0.7344, grad=131.60, nan=0]Epoch 6:  31%|███▏      | 16/51 [00:00<00:00, 78.28it/s, loss=7.4917, trans=0.0673, rot=0.7629, grad=215.79, nan=0]Epoch 6:  49%|████▉     | 25/51 [00:00<00:00, 81.24it/s, loss=7.4917, trans=0.0673, rot=0.7629, grad=215.79, nan=0]Epoch 6:  49%|████▉     | 25/51 [00:00<00:00, 81.24it/s, loss=7.2303, trans=0.0650, rot=0.7337, grad=147.22, nan=0]Epoch 6:  49%|████▉     | 25/51 [00:00<00:00, 81.24it/s, loss=5.5269, trans=0.0489, rot=0.6397, grad=135.79, nan=0]Epoch 6:  49%|████▉     | 25/51 [00:00<00:00, 81.24it/s, loss=7.1956, trans=0.0652, rot=0.6790, grad=189.42, nan=0]Epoch 6:  49%|████▉     | 25/51 [00:00<00:00, 81.24it/s, loss=7.3117, trans=0.0659, rot=0.7258, grad=134.92, nan=0]Epoch 6:  49%|████▉     | 25/51 [00:00<00:00, 81.24it/s, loss=7.3147, trans=0.0668, rot=0.6316, grad=223.12, nan=0]Epoch 6:  49%|████▉     | 25/51 [00:00<00:00, 81.24it/s, loss=5.8105, trans=0.0515, rot=0.6611, grad=106.80, nan=0]Epoch 6:  49%|████▉     | 25/51 [00:00<00:00, 81.24it/s, loss=8.2570, trans=0.0751, rot=0.7463, grad=145.58, nan=0]Epoch 6:  49%|████▉     | 25/51 [00:00<00:00, 81.24it/s, loss=5.8415, trans=0.0512, rot=0.7188, grad=113.67, nan=0]Epoch 6:  49%|████▉     | 25/51 [00:00<00:00, 81.24it/s, loss=7.1035, trans=0.0641, rot=0.6963, grad=150.58, nan=0]Epoch 6:  49%|████▉     | 25/51 [00:00<00:00, 81.24it/s, loss=7.5622, trans=0.0690, rot=0.6581, grad=137.11, nan=0]Epoch 6:  69%|██████▊   | 35/51 [00:00<00:00, 85.53it/s, loss=7.5622, trans=0.0690, rot=0.6581, grad=137.11, nan=0]Epoch 6:  69%|██████▊   | 35/51 [00:00<00:00, 85.53it/s, loss=7.7966, trans=0.0715, rot=0.6506, grad=133.30, nan=0]Epoch 6:  69%|██████▊   | 35/51 [00:00<00:00, 85.53it/s, loss=6.9424, trans=0.0627, rot=0.6699, grad=156.12, nan=0]Epoch 6:  69%|██████▊   | 35/51 [00:00<00:00, 85.53it/s, loss=6.8667, trans=0.0614, rot=0.7277, grad=127.79, nan=0]Epoch 6:  69%|██████▊   | 35/51 [00:00<00:00, 85.53it/s, loss=8.8031, trans=0.0811, rot=0.6929, grad=152.81, nan=0]Epoch 6:  69%|██████▊   | 35/51 [00:00<00:00, 85.53it/s, loss=5.7054, trans=0.0503, rot=0.6778, grad=113.35, nan=0]Epoch 6:  69%|██████▊   | 35/51 [00:00<00:00, 85.53it/s, loss=7.5693, trans=0.0678, rot=0.7936, grad=150.10, nan=0]Epoch 6:  69%|██████▊   | 35/51 [00:00<00:00, 85.53it/s, loss=6.4795, trans=0.0578, rot=0.7031, grad=144.60, nan=0]Epoch 6:  69%|██████▊   | 35/51 [00:00<00:00, 85.53it/s, loss=7.4864, trans=0.0678, rot=0.7102, grad=172.61, nan=0]Epoch 6:  69%|██████▊   | 35/51 [00:00<00:00, 85.53it/s, loss=3.9324, trans=0.0329, rot=0.6463, grad=114.61, nan=0]Epoch 6:  69%|██████▊   | 35/51 [00:00<00:00, 85.53it/s, loss=6.4140, trans=0.0578, rot=0.6387, grad=108.79, nan=0]Epoch 6:  88%|████████▊ | 45/51 [00:00<00:00, 88.72it/s, loss=6.4140, trans=0.0578, rot=0.6387, grad=108.79, nan=0]Epoch 6:  88%|████████▊ | 45/51 [00:00<00:00, 88.72it/s, loss=5.9690, trans=0.0528, rot=0.6862, grad=139.89, nan=0]Epoch 6:  88%|████████▊ | 45/51 [00:00<00:00, 88.72it/s, loss=5.1191, trans=0.0445, rot=0.6699, grad=119.79, nan=0]Epoch 6:  88%|████████▊ | 45/51 [00:00<00:00, 88.72it/s, loss=6.3057, trans=0.0560, rot=0.7057, grad=175.57, nan=0]Epoch 6:  88%|████████▊ | 45/51 [00:00<00:00, 88.72it/s, loss=8.3657, trans=0.0775, rot=0.6194, grad=159.87, nan=0]Epoch 6:  88%|████████▊ | 45/51 [00:00<00:00, 88.72it/s, loss=5.8011, trans=0.0510, rot=0.7007, grad=119.26, nan=0]Epoch 6:  88%|████████▊ | 45/51 [00:00<00:00, 88.72it/s, loss=6.0833, trans=0.0551, rot=0.5726, grad=318.85, nan=0]Epoch 6: 100%|██████████| 51/51 [00:00<00:00, 82.48it/s, loss=6.0833, trans=0.0551, rot=0.5726, grad=318.85, nan=0]
Visual features - mean: -0.002689, std: 0.977693
IMU features - mean: -0.004838, std: 0.931325
GT translations (m) - mean: 0.001102, std: 0.023785
GT quaternions - mean: 0.249330, std: 0.433568
Predicted pose window shape: (1, 7)
[[-0.7199457  -0.5428994  -0.3915891  -0.11345018  0.11962404  0.17546472
  -0.97058296]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.8512161   0.12175599  0.13749808 -0.48582476 -0.14519589  0.07969846
  -0.8582194 ]]
  Ground truth relative pose:
[[-1.8711335e-03  3.1616031e-03  3.9704610e-05  1.3146294e-02
  -4.8274524e-03  4.8754527e-03  9.9989003e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 186.69it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 175.17it/s]

Epoch 6 Summary:
  Train Loss: 6.989934
  Val Loss: 1.777593
  Val Trans Error: 0.2394 m
  Val Rot Error: 30.11 degrees
  ✓ New best model saved

============================================================
Epoch 7/50
Learning rate: 0.00000588
============================================================
Epoch 7:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 7:   0%|          | 0/51 [00:00<?, ?it/s, loss=6.0903, trans=0.0540, rot=0.6857, grad=135.43, nan=0]Epoch 7:   0%|          | 0/51 [00:00<?, ?it/s, loss=7.2649, trans=0.0664, rot=0.6280, grad=132.76, nan=0]Epoch 7:   0%|          | 0/51 [00:00<?, ?it/s, loss=5.1551, trans=0.0437, rot=0.7846, grad=106.10, nan=0]Epoch 7:   0%|          | 0/51 [00:00<?, ?it/s, loss=5.5005, trans=0.0495, rot=0.5547, grad=142.40, nan=0]Epoch 7:   0%|          | 0/51 [00:00<?, ?it/s, loss=6.0028, trans=0.0544, rot=0.5596, grad=120.78, nan=0]Epoch 7:   0%|          | 0/51 [00:00<?, ?it/s, loss=6.0852, trans=0.0542, rot=0.6627, grad=119.58, nan=0]Epoch 7:   0%|          | 0/51 [00:00<?, ?it/s, loss=5.4959, trans=0.0489, rot=0.6010, grad=148.47, nan=0]Epoch 7:  14%|█▎        | 7/51 [00:00<00:00, 63.92it/s, loss=5.4959, trans=0.0489, rot=0.6010, grad=148.47, nan=0]Epoch 7:  14%|█▎        | 7/51 [00:00<00:00, 63.92it/s, loss=4.7949, trans=0.0420, rot=0.5991, grad=116.71, nan=0]Epoch 7:  14%|█▎        | 7/51 [00:00<00:00, 63.92it/s, loss=7.1931, trans=0.0657, rot=0.6197, grad=125.45, nan=0]Epoch 7:  14%|█▎        | 7/51 [00:00<00:00, 63.92it/s, loss=6.0377, trans=0.0532, rot=0.7183, grad=96.75, nan=0] Epoch 7:  14%|█▎        | 7/51 [00:00<00:00, 63.92it/s, loss=5.9282, trans=0.0526, rot=0.6654, grad=170.06, nan=0]Epoch 7:  14%|█▎        | 7/51 [00:00<00:00, 63.92it/s, loss=6.4893, trans=0.0591, rot=0.5826, grad=112.97, nan=0]Epoch 7:  14%|█▎        | 7/51 [00:00<00:00, 63.92it/s, loss=5.5374, trans=0.0494, rot=0.6006, grad=135.81, nan=0]Epoch 7:  14%|█▎        | 7/51 [00:00<00:00, 63.92it/s, loss=6.2528, trans=0.0568, rot=0.5684, grad=121.34, nan=0]Epoch 7:  14%|█▎        | 7/51 [00:00<00:00, 63.92it/s, loss=6.9239, trans=0.0630, rot=0.6248, grad=157.65, nan=0]Epoch 7:  14%|█▎        | 7/51 [00:00<00:00, 63.92it/s, loss=5.9140, trans=0.0521, rot=0.7009, grad=117.99, nan=0]Epoch 7:  31%|███▏      | 16/51 [00:00<00:00, 77.52it/s, loss=5.9140, trans=0.0521, rot=0.7009, grad=117.99, nan=0]Epoch 7:  31%|███▏      | 16/51 [00:00<00:00, 77.52it/s, loss=5.5667, trans=0.0497, rot=0.5973, grad=114.14, nan=0]Epoch 7:  31%|███▏      | 16/51 [00:00<00:00, 77.52it/s, loss=6.4756, trans=0.0578, rot=0.6977, grad=180.14, nan=0]Epoch 7:  31%|███▏      | 16/51 [00:00<00:00, 77.52it/s, loss=7.0785, trans=0.0646, rot=0.6164, grad=116.26, nan=0]Epoch 7:  31%|███▏      | 16/51 [00:00<00:00, 77.52it/s, loss=5.0701, trans=0.0443, rot=0.6366, grad=102.06, nan=0]Epoch 7:  31%|███▏      | 16/51 [00:00<00:00, 77.52it/s, loss=5.2831, trans=0.0466, rot=0.6266, grad=98.11, nan=0] Epoch 7:  31%|███▏      | 16/51 [00:00<00:00, 77.52it/s, loss=6.6832, trans=0.0611, rot=0.5751, grad=115.79, nan=0]Epoch 7:  31%|███▏      | 16/51 [00:00<00:00, 77.52it/s, loss=5.0504, trans=0.0442, rot=0.6284, grad=114.44, nan=0]Epoch 7:  31%|███▏      | 16/51 [00:00<00:00, 77.52it/s, loss=7.8374, trans=0.0714, rot=0.6990, grad=133.06, nan=0]Epoch 7:  31%|███▏      | 16/51 [00:00<00:00, 77.52it/s, loss=6.0177, trans=0.0542, rot=0.5998, grad=126.45, nan=0]Epoch 7:  31%|███▏      | 16/51 [00:00<00:00, 77.52it/s, loss=5.4053, trans=0.0474, rot=0.6681, grad=96.20, nan=0] Epoch 7:  51%|█████     | 26/51 [00:00<00:00, 83.76it/s, loss=5.4053, trans=0.0474, rot=0.6681, grad=96.20, nan=0]Epoch 7:  51%|█████     | 26/51 [00:00<00:00, 83.76it/s, loss=5.4613, trans=0.0490, rot=0.5660, grad=153.02, nan=0]Epoch 7:  51%|█████     | 26/51 [00:00<00:00, 83.76it/s, loss=5.9838, trans=0.0528, rot=0.7057, grad=96.88, nan=0] Epoch 7:  51%|█████     | 26/51 [00:00<00:00, 83.76it/s, loss=6.0257, trans=0.0543, rot=0.5918, grad=107.35, nan=0]Epoch 7:  51%|█████     | 26/51 [00:00<00:00, 83.76it/s, loss=5.1726, trans=0.0462, rot=0.5512, grad=111.01, nan=0]Epoch 7:  51%|█████     | 26/51 [00:00<00:00, 83.76it/s, loss=5.7378, trans=0.0511, rot=0.6313, grad=101.44, nan=0]Epoch 7:  51%|█████     | 26/51 [00:00<00:00, 83.76it/s, loss=6.4921, trans=0.0590, rot=0.5931, grad=121.87, nan=0]Epoch 7:  51%|█████     | 26/51 [00:00<00:00, 83.76it/s, loss=5.8829, trans=0.0525, rot=0.6298, grad=108.91, nan=0]Epoch 7:  51%|█████     | 26/51 [00:00<00:00, 83.76it/s, loss=4.9983, trans=0.0442, rot=0.5751, grad=131.26, nan=0]Epoch 7:  51%|█████     | 26/51 [00:00<00:00, 83.76it/s, loss=4.6662, trans=0.0408, rot=0.5832, grad=95.67, nan=0] Epoch 7:  51%|█████     | 26/51 [00:00<00:00, 83.76it/s, loss=4.2528, trans=0.0371, rot=0.5435, grad=101.77, nan=0]Epoch 7:  71%|███████   | 36/51 [00:00<00:00, 87.80it/s, loss=4.2528, trans=0.0371, rot=0.5435, grad=101.77, nan=0]Epoch 7:  71%|███████   | 36/51 [00:00<00:00, 87.80it/s, loss=5.6089, trans=0.0510, rot=0.5065, grad=100.48, nan=0]Epoch 7:  71%|███████   | 36/51 [00:00<00:00, 87.80it/s, loss=6.4626, trans=0.0593, rot=0.5334, grad=127.12, nan=0]Epoch 7:  71%|███████   | 36/51 [00:00<00:00, 87.80it/s, loss=6.4589, trans=0.0595, rot=0.5083, grad=103.98, nan=0]Epoch 7:  71%|███████   | 36/51 [00:00<00:00, 87.80it/s, loss=6.2840, trans=0.0581, rot=0.4739, grad=139.97, nan=0]Epoch 7:  71%|███████   | 36/51 [00:00<00:00, 87.80it/s, loss=5.8262, trans=0.0520, rot=0.6292, grad=134.17, nan=0]Epoch 7:  71%|███████   | 36/51 [00:00<00:00, 87.80it/s, loss=4.5967, trans=0.0400, rot=0.5918, grad=91.62, nan=0] Epoch 7:  71%|███████   | 36/51 [00:00<00:00, 87.80it/s, loss=4.8001, trans=0.0424, rot=0.5645, grad=118.74, nan=0]Epoch 7:  71%|███████   | 36/51 [00:00<00:00, 87.80it/s, loss=5.9865, trans=0.0540, rot=0.5877, grad=152.36, nan=0]Epoch 7:  71%|███████   | 36/51 [00:00<00:00, 87.80it/s, loss=4.4974, trans=0.0395, rot=0.5491, grad=77.97, nan=0] Epoch 7:  88%|████████▊ | 45/51 [00:00<00:00, 87.88it/s, loss=4.4974, trans=0.0395, rot=0.5491, grad=77.97, nan=0]Epoch 7:  88%|████████▊ | 45/51 [00:00<00:00, 87.88it/s, loss=5.7045, trans=0.0511, rot=0.5985, grad=109.83, nan=0]Epoch 7:  88%|████████▊ | 45/51 [00:00<00:00, 87.88it/s, loss=5.6163, trans=0.0507, rot=0.5472, grad=128.87, nan=0]Epoch 7:  88%|████████▊ | 45/51 [00:00<00:00, 87.88it/s, loss=6.6188, trans=0.0606, rot=0.5565, grad=131.29, nan=0]Epoch 7:  88%|████████▊ | 45/51 [00:00<00:00, 87.88it/s, loss=4.9395, trans=0.0444, rot=0.5028, grad=124.13, nan=0]Epoch 7:  88%|████████▊ | 45/51 [00:00<00:00, 87.88it/s, loss=5.7615, trans=0.0527, rot=0.4869, grad=96.32, nan=0] Epoch 7:  88%|████████▊ | 45/51 [00:00<00:00, 87.88it/s, loss=5.3179, trans=0.0486, rot=0.4621, grad=258.72, nan=0]Epoch 7: 100%|██████████| 51/51 [00:00<00:00, 83.32it/s, loss=5.3179, trans=0.0486, rot=0.4621, grad=258.72, nan=0]
Visual features - mean: 0.006776, std: 0.945605
IMU features - mean: 0.009552, std: 0.876765
GT translations (m) - mean: -0.001481, std: 0.031725
GT quaternions - mean: 0.251423, std: 0.432357
Predicted pose window shape: (1, 7)
[[-0.5800701  -0.171065   -0.18612966 -0.0331218  -0.01473341  0.45014656
  -0.8922186 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.04739822 -0.07320614  0.26063102 -0.20790964  0.2448544   0.08700109
  -0.94300085]]
  Ground truth relative pose:
[[ 0.00479593 -0.0047388   0.00101262  0.00439352  0.00445814 -0.0128892
   0.99989736]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  77%|███████▋  | 17/22 [00:00<00:00, 168.57it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 160.93it/s]

Epoch 7 Summary:
  Train Loss: 5.809551
  Val Loss: 1.474870
  Val Trans Error: 0.2237 m
  Val Rot Error: 24.65 degrees
  ✓ New best model saved

============================================================
Epoch 8/50
Learning rate: 0.00000588
============================================================
Epoch 8:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 8:   0%|          | 0/51 [00:00<?, ?it/s, loss=5.9943, trans=0.0551, rot=0.4848, grad=142.23, nan=0]Epoch 8:   0%|          | 0/51 [00:00<?, ?it/s, loss=5.5460, trans=0.0497, rot=0.5798, grad=104.54, nan=0]Epoch 8:   0%|          | 0/51 [00:00<?, ?it/s, loss=4.6442, trans=0.0413, rot=0.5151, grad=93.00, nan=0] Epoch 8:   0%|          | 0/51 [00:00<?, ?it/s, loss=6.2025, trans=0.0564, rot=0.5618, grad=94.21, nan=0]Epoch 8:   0%|          | 0/51 [00:00<?, ?it/s, loss=5.3410, trans=0.0485, rot=0.4958, grad=97.64, nan=0]Epoch 8:   0%|          | 0/51 [00:00<?, ?it/s, loss=5.1560, trans=0.0462, rot=0.5405, grad=112.59, nan=0]Epoch 8:  12%|█▏        | 6/51 [00:00<00:00, 57.45it/s, loss=5.1560, trans=0.0462, rot=0.5405, grad=112.59, nan=0]Epoch 8:  12%|█▏        | 6/51 [00:00<00:00, 57.45it/s, loss=6.5831, trans=0.0597, rot=0.6146, grad=122.16, nan=0]Epoch 8:  12%|█▏        | 6/51 [00:00<00:00, 57.45it/s, loss=4.7905, trans=0.0425, rot=0.5447, grad=99.38, nan=0] Epoch 8:  12%|█▏        | 6/51 [00:00<00:00, 57.45it/s, loss=4.6607, trans=0.0417, rot=0.4932, grad=84.19, nan=0]Epoch 8:  12%|█▏        | 6/51 [00:00<00:00, 57.45it/s, loss=4.8682, trans=0.0434, rot=0.5320, grad=106.91, nan=0]Epoch 8:  12%|█▏        | 6/51 [00:00<00:00, 57.45it/s, loss=4.8941, trans=0.0427, rot=0.6197, grad=85.96, nan=0] Epoch 8:  12%|█▏        | 6/51 [00:00<00:00, 57.45it/s, loss=5.2229, trans=0.0462, rot=0.6009, grad=133.59, nan=0]Epoch 8:  12%|█▏        | 6/51 [00:00<00:00, 57.45it/s, loss=5.1111, trans=0.0446, rot=0.6560, grad=111.38, nan=0]Epoch 8:  12%|█▏        | 6/51 [00:00<00:00, 57.45it/s, loss=5.7345, trans=0.0517, rot=0.5611, grad=102.53, nan=0]Epoch 8:  12%|█▏        | 6/51 [00:00<00:00, 57.45it/s, loss=5.6146, trans=0.0503, rot=0.5827, grad=135.59, nan=0]Epoch 8:  29%|██▉       | 15/51 [00:00<00:00, 75.60it/s, loss=5.6146, trans=0.0503, rot=0.5827, grad=135.59, nan=0]Epoch 8:  29%|██▉       | 15/51 [00:00<00:00, 75.60it/s, loss=5.6868, trans=0.0509, rot=0.5964, grad=149.20, nan=0]Epoch 8:  29%|██▉       | 15/51 [00:00<00:00, 75.60it/s, loss=6.2758, trans=0.0566, rot=0.6171, grad=131.89, nan=0]Epoch 8:  29%|██▉       | 15/51 [00:00<00:00, 75.60it/s, loss=4.7781, trans=0.0423, rot=0.5479, grad=106.39, nan=0]Epoch 8:  29%|██▉       | 15/51 [00:00<00:00, 75.60it/s, loss=5.9974, trans=0.0545, rot=0.5498, grad=134.03, nan=0]Epoch 8:  29%|██▉       | 15/51 [00:00<00:00, 75.60it/s, loss=5.5802, trans=0.0500, rot=0.5789, grad=88.19, nan=0] Epoch 8:  29%|██▉       | 15/51 [00:00<00:00, 75.60it/s, loss=8.8604, trans=0.0834, rot=0.5253, grad=165.74, nan=0]Epoch 8:  29%|██▉       | 15/51 [00:00<00:00, 75.60it/s, loss=4.7155, trans=0.0413, rot=0.5828, grad=92.56, nan=0] Epoch 8:  29%|██▉       | 15/51 [00:00<00:00, 75.60it/s, loss=5.4481, trans=0.0498, rot=0.4633, grad=97.53, nan=0]Epoch 8:  29%|██▉       | 15/51 [00:00<00:00, 75.60it/s, loss=4.5448, trans=0.0407, rot=0.4793, grad=115.32, nan=0]Epoch 8:  29%|██▉       | 15/51 [00:00<00:00, 75.60it/s, loss=4.9361, trans=0.0441, rot=0.5304, grad=86.09, nan=0] Epoch 8:  49%|████▉     | 25/51 [00:00<00:00, 83.81it/s, loss=4.9361, trans=0.0441, rot=0.5304, grad=86.09, nan=0]Epoch 8:  49%|████▉     | 25/51 [00:00<00:00, 83.81it/s, loss=6.3989, trans=0.0587, rot=0.5272, grad=122.20, nan=0]Epoch 8:  49%|████▉     | 25/51 [00:00<00:00, 83.81it/s, loss=5.3590, trans=0.0489, rot=0.4724, grad=120.66, nan=0]Epoch 8:  49%|████▉     | 25/51 [00:00<00:00, 83.81it/s, loss=5.6841, trans=0.0520, rot=0.4815, grad=127.76, nan=0]Epoch 8:  49%|████▉     | 25/51 [00:00<00:00, 83.81it/s, loss=6.0518, trans=0.0555, rot=0.5006, grad=113.62, nan=0]Epoch 8:  49%|████▉     | 25/51 [00:00<00:00, 83.81it/s, loss=5.2926, trans=0.0477, rot=0.5244, grad=96.78, nan=0] Epoch 8:  49%|████▉     | 25/51 [00:00<00:00, 83.81it/s, loss=5.5951, trans=0.0510, rot=0.4937, grad=95.40, nan=0]Epoch 8:  49%|████▉     | 25/51 [00:00<00:00, 83.81it/s, loss=4.3647, trans=0.0393, rot=0.4382, grad=92.19, nan=0]Epoch 8:  49%|████▉     | 25/51 [00:00<00:00, 83.81it/s, loss=5.0940, trans=0.0455, rot=0.5435, grad=111.07, nan=0]Epoch 8:  49%|████▉     | 25/51 [00:00<00:00, 83.81it/s, loss=5.0483, trans=0.0457, rot=0.4785, grad=139.63, nan=0]Epoch 8:  49%|████▉     | 25/51 [00:00<00:00, 83.81it/s, loss=6.0640, trans=0.0554, rot=0.5240, grad=103.88, nan=0]Epoch 8:  69%|██████▊   | 35/51 [00:00<00:00, 87.56it/s, loss=6.0640, trans=0.0554, rot=0.5240, grad=103.88, nan=0]Epoch 8:  69%|██████▊   | 35/51 [00:00<00:00, 87.56it/s, loss=4.1460, trans=0.0362, rot=0.5304, grad=93.92, nan=0] Epoch 8:  69%|██████▊   | 35/51 [00:00<00:00, 87.56it/s, loss=6.1278, trans=0.0562, rot=0.5088, grad=99.22, nan=0]Epoch 8:  69%|██████▊   | 35/51 [00:00<00:00, 87.56it/s, loss=5.3228, trans=0.0475, rot=0.5762, grad=99.45, nan=0]Epoch 8:  69%|██████▊   | 35/51 [00:00<00:00, 87.56it/s, loss=5.6364, trans=0.0513, rot=0.5083, grad=122.42, nan=0]Epoch 8:  69%|██████▊   | 35/51 [00:00<00:00, 87.56it/s, loss=3.8064, trans=0.0334, rot=0.4673, grad=83.42, nan=0] Epoch 8:  69%|██████▊   | 35/51 [00:00<00:00, 87.56it/s, loss=4.8695, trans=0.0445, rot=0.4165, grad=102.05, nan=0]Epoch 8:  69%|██████▊   | 35/51 [00:00<00:00, 87.56it/s, loss=4.5522, trans=0.0409, rot=0.4589, grad=103.47, nan=0]Epoch 8:  69%|██████▊   | 35/51 [00:00<00:00, 87.56it/s, loss=4.0050, trans=0.0346, rot=0.5481, grad=74.59, nan=0] Epoch 8:  69%|██████▊   | 35/51 [00:00<00:00, 87.56it/s, loss=6.0060, trans=0.0545, rot=0.5564, grad=123.47, nan=0]Epoch 8:  86%|████████▋ | 44/51 [00:00<00:00, 88.10it/s, loss=6.0060, trans=0.0545, rot=0.5564, grad=123.47, nan=0]Epoch 8:  86%|████████▋ | 44/51 [00:00<00:00, 88.10it/s, loss=4.6578, trans=0.0413, rot=0.5252, grad=131.30, nan=0]Epoch 8:  86%|████████▋ | 44/51 [00:00<00:00, 88.10it/s, loss=5.4374, trans=0.0493, rot=0.5119, grad=87.43, nan=0] Epoch 8:  86%|████████▋ | 44/51 [00:00<00:00, 88.10it/s, loss=5.4237, trans=0.0497, rot=0.4528, grad=115.28, nan=0]Epoch 8:  86%|████████▋ | 44/51 [00:00<00:00, 88.10it/s, loss=5.2792, trans=0.0479, rot=0.4920, grad=99.11, nan=0] Epoch 8:  86%|████████▋ | 44/51 [00:00<00:00, 88.10it/s, loss=5.3912, trans=0.0489, rot=0.5026, grad=115.28, nan=0]Epoch 8:  86%|████████▋ | 44/51 [00:00<00:00, 88.10it/s, loss=4.9411, trans=0.0441, rot=0.5296, grad=154.79, nan=0]Epoch 8:  86%|████████▋ | 44/51 [00:00<00:00, 88.10it/s, loss=5.8649, trans=0.0536, rot=0.5093, grad=238.29, nan=0]Epoch 8: 100%|██████████| 51/51 [00:00<00:00, 83.08it/s, loss=5.8649, trans=0.0536, rot=0.5093, grad=238.29, nan=0]
Visual features - mean: -0.002679, std: 1.058775
IMU features - mean: 0.003909, std: 0.999118
GT translations (m) - mean: -0.000556, std: 0.047683
GT quaternions - mean: 0.248906, std: 0.433812
Predicted pose window shape: (1, 7)
[[-0.31344974 -0.19409159  0.08119784  0.07143351  0.03927784 -0.12370977
  -0.98896426]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.19061902  0.60287416 -0.37664533 -0.19652158  0.11541904  0.04468767
  -0.9726566 ]]
  Ground truth relative pose:
[[ 1.4988713e-03  6.7394902e-04  5.4147997e-04 -7.8901649e-04
  -1.6121566e-03 -2.8640181e-03  9.9999428e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  95%|█████████▌| 21/22 [00:00<00:00, 203.17it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 186.74it/s]

Epoch 8 Summary:
  Train Loss: 5.364844
  Val Loss: 1.232200
  Val Trans Error: 0.1979 m
  Val Rot Error: 20.60 degrees
  ✓ New best model saved

============================================================
Epoch 9/50
Learning rate: 0.00000588
============================================================
Epoch 9:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 9:   0%|          | 0/51 [00:00<?, ?it/s, loss=5.9387, trans=0.0548, rot=0.4597, grad=99.92, nan=0]Epoch 9:   0%|          | 0/51 [00:00<?, ?it/s, loss=5.3729, trans=0.0491, rot=0.4584, grad=105.95, nan=0]Epoch 9:   0%|          | 0/51 [00:00<?, ?it/s, loss=5.3112, trans=0.0477, rot=0.5432, grad=120.39, nan=0]Epoch 9:   0%|          | 0/51 [00:00<?, ?it/s, loss=7.1797, trans=0.0667, rot=0.5138, grad=143.48, nan=0]Epoch 9:   0%|          | 0/51 [00:00<?, ?it/s, loss=5.3890, trans=0.0486, rot=0.5265, grad=107.52, nan=0]Epoch 9:   0%|          | 0/51 [00:00<?, ?it/s, loss=6.5997, trans=0.0610, rot=0.4959, grad=134.45, nan=0]Epoch 9:  12%|█▏        | 6/51 [00:00<00:00, 57.13it/s, loss=6.5997, trans=0.0610, rot=0.4959, grad=134.45, nan=0]Epoch 9:  12%|█▏        | 6/51 [00:00<00:00, 57.13it/s, loss=5.8328, trans=0.0533, rot=0.4993, grad=151.00, nan=0]Epoch 9:  12%|█▏        | 6/51 [00:00<00:00, 57.13it/s, loss=4.4079, trans=0.0391, rot=0.4990, grad=129.38, nan=0]Epoch 9:  12%|█▏        | 6/51 [00:00<00:00, 57.13it/s, loss=4.9843, trans=0.0445, rot=0.5321, grad=120.27, nan=0]Epoch 9:  12%|█▏        | 6/51 [00:00<00:00, 57.13it/s, loss=5.1789, trans=0.0463, rot=0.5498, grad=94.71, nan=0] Epoch 9:  12%|█▏        | 6/51 [00:00<00:00, 57.13it/s, loss=5.1995, trans=0.0472, rot=0.4837, grad=115.67, nan=0]Epoch 9:  12%|█▏        | 6/51 [00:00<00:00, 57.13it/s, loss=5.5575, trans=0.0500, rot=0.5542, grad=110.92, nan=0]Epoch 9:  12%|█▏        | 6/51 [00:00<00:00, 57.13it/s, loss=6.6688, trans=0.0617, rot=0.4965, grad=119.46, nan=0]Epoch 9:  12%|█▏        | 6/51 [00:00<00:00, 57.13it/s, loss=5.6276, trans=0.0510, rot=0.5268, grad=109.42, nan=0]Epoch 9:  12%|█▏        | 6/51 [00:00<00:00, 57.13it/s, loss=4.7469, trans=0.0426, rot=0.4873, grad=98.14, nan=0] Epoch 9:  12%|█▏        | 6/51 [00:00<00:00, 57.13it/s, loss=3.7925, trans=0.0332, rot=0.4768, grad=91.24, nan=0]Epoch 9:  31%|███▏      | 16/51 [00:00<00:00, 78.75it/s, loss=3.7925, trans=0.0332, rot=0.4768, grad=91.24, nan=0]Epoch 9:  31%|███▏      | 16/51 [00:00<00:00, 78.75it/s, loss=5.3475, trans=0.0483, rot=0.5171, grad=114.32, nan=0]Epoch 9:  31%|███▏      | 16/51 [00:00<00:00, 78.75it/s, loss=4.9889, trans=0.0443, rot=0.5635, grad=87.31, nan=0] Epoch 9:  31%|███▏      | 16/51 [00:00<00:00, 78.75it/s, loss=5.0453, trans=0.0455, rot=0.4960, grad=151.43, nan=0]Epoch 9:  31%|███▏      | 16/51 [00:00<00:00, 78.75it/s, loss=5.1087, trans=0.0458, rot=0.5333, grad=117.85, nan=0]Epoch 9:  31%|███▏      | 16/51 [00:00<00:00, 78.75it/s, loss=5.2572, trans=0.0475, rot=0.5038, grad=132.30, nan=0]Epoch 9:  31%|███▏      | 16/51 [00:00<00:00, 78.75it/s, loss=5.1559, trans=0.0469, rot=0.4697, grad=105.45, nan=0]Epoch 9:  31%|███▏      | 16/51 [00:00<00:00, 78.75it/s, loss=4.4842, trans=0.0402, rot=0.4659, grad=94.69, nan=0] Epoch 9:  31%|███▏      | 16/51 [00:00<00:00, 78.75it/s, loss=4.1132, trans=0.0361, rot=0.5012, grad=98.24, nan=0]Epoch 9:  31%|███▏      | 16/51 [00:00<00:00, 78.75it/s, loss=4.3580, trans=0.0386, rot=0.4931, grad=74.18, nan=0]Epoch 9:  31%|███▏      | 16/51 [00:00<00:00, 78.75it/s, loss=4.3532, trans=0.0391, rot=0.4438, grad=101.52, nan=0]Epoch 9:  51%|█████     | 26/51 [00:00<00:00, 85.66it/s, loss=4.3532, trans=0.0391, rot=0.4438, grad=101.52, nan=0]Epoch 9:  51%|█████     | 26/51 [00:00<00:00, 85.66it/s, loss=3.9863, trans=0.0358, rot=0.4065, grad=70.87, nan=0] Epoch 9:  51%|█████     | 26/51 [00:00<00:00, 85.66it/s, loss=5.1924, trans=0.0471, rot=0.4851, grad=145.87, nan=0]Epoch 9:  51%|█████     | 26/51 [00:00<00:00, 85.66it/s, loss=4.8521, trans=0.0440, rot=0.4484, grad=83.37, nan=0] Epoch 9:  51%|█████     | 26/51 [00:00<00:00, 85.66it/s, loss=3.8283, trans=0.0328, rot=0.5439, grad=106.45, nan=0]Epoch 9:  51%|█████     | 26/51 [00:00<00:00, 85.66it/s, loss=3.8637, trans=0.0341, rot=0.4524, grad=105.97, nan=0]Epoch 9:  51%|█████     | 26/51 [00:00<00:00, 85.66it/s, loss=4.0443, trans=0.0351, rot=0.5324, grad=94.05, nan=0] Epoch 9:  51%|█████     | 26/51 [00:00<00:00, 85.66it/s, loss=4.3789, trans=0.0398, rot=0.4008, grad=137.04, nan=0]Epoch 9:  51%|█████     | 26/51 [00:00<00:00, 85.66it/s, loss=6.1130, trans=0.0559, rot=0.5213, grad=113.97, nan=0]Epoch 9:  51%|█████     | 26/51 [00:00<00:00, 85.66it/s, loss=5.3775, trans=0.0494, rot=0.4389, grad=117.36, nan=0]Epoch 9:  51%|█████     | 26/51 [00:00<00:00, 85.66it/s, loss=6.0898, trans=0.0570, rot=0.3883, grad=157.00, nan=0]Epoch 9:  71%|███████   | 36/51 [00:00<00:00, 87.77it/s, loss=6.0898, trans=0.0570, rot=0.3883, grad=157.00, nan=0]Epoch 9:  71%|███████   | 36/51 [00:00<00:00, 87.77it/s, loss=4.5182, trans=0.0398, rot=0.5378, grad=117.37, nan=0]Epoch 9:  71%|███████   | 36/51 [00:00<00:00, 87.77it/s, loss=4.3068, trans=0.0383, rot=0.4777, grad=91.11, nan=0] Epoch 9:  71%|███████   | 36/51 [00:00<00:00, 87.77it/s, loss=4.4313, trans=0.0399, rot=0.4447, grad=90.01, nan=0]Epoch 9:  71%|███████   | 36/51 [00:00<00:00, 87.77it/s, loss=4.4677, trans=0.0395, rot=0.5130, grad=89.70, nan=0]Epoch 9:  71%|███████   | 36/51 [00:00<00:00, 87.77it/s, loss=4.4069, trans=0.0397, rot=0.4371, grad=102.50, nan=0]Epoch 9:  71%|███████   | 36/51 [00:00<00:00, 87.77it/s, loss=4.8523, trans=0.0440, rot=0.4520, grad=125.36, nan=0]Epoch 9:  71%|███████   | 36/51 [00:00<00:00, 87.77it/s, loss=4.0093, trans=0.0351, rot=0.5029, grad=72.17, nan=0] Epoch 9:  71%|███████   | 36/51 [00:00<00:00, 87.77it/s, loss=4.3257, trans=0.0392, rot=0.4101, grad=80.48, nan=0]Epoch 9:  71%|███████   | 36/51 [00:00<00:00, 87.77it/s, loss=4.0394, trans=0.0360, rot=0.4362, grad=106.28, nan=0]Epoch 9:  88%|████████▊ | 45/51 [00:00<00:00, 87.43it/s, loss=4.0394, trans=0.0360, rot=0.4362, grad=106.28, nan=0]Epoch 9:  88%|████████▊ | 45/51 [00:00<00:00, 87.43it/s, loss=6.0861, trans=0.0563, rot=0.4515, grad=128.45, nan=0]Epoch 9:  88%|████████▊ | 45/51 [00:00<00:00, 87.43it/s, loss=3.4082, trans=0.0296, rot=0.4461, grad=71.24, nan=0] Epoch 9:  88%|████████▊ | 45/51 [00:00<00:00, 87.43it/s, loss=5.2814, trans=0.0480, rot=0.4783, grad=102.23, nan=0]Epoch 9:  88%|████████▊ | 45/51 [00:00<00:00, 87.43it/s, loss=4.8841, trans=0.0444, rot=0.4426, grad=95.45, nan=0] Epoch 9:  88%|████████▊ | 45/51 [00:00<00:00, 87.43it/s, loss=4.1191, trans=0.0367, rot=0.4447, grad=76.03, nan=0]Epoch 9:  88%|████████▊ | 45/51 [00:00<00:00, 87.43it/s, loss=3.2184, trans=0.0290, rot=0.3194, grad=168.49, nan=0]Epoch 9: 100%|██████████| 51/51 [00:00<00:00, 84.24it/s, loss=3.2184, trans=0.0290, rot=0.3194, grad=168.49, nan=0]
Visual features - mean: 0.002600, std: 1.017080
IMU features - mean: 0.002768, std: 0.794076
GT translations (m) - mean: -0.001307, std: 0.045999
GT quaternions - mean: 0.250518, std: 0.432883
Predicted pose window shape: (1, 7)
[[-0.19442344 -0.23265247 -0.0860002   0.00551182 -0.03984368  0.14807338
  -0.98815805]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.1416672  -0.02036671  0.17721806 -0.07206693  0.06588441  0.01167301
  -0.99515295]]
  Ground truth relative pose:
[[ 3.4211131e-04 -2.7373014e-04  4.1768694e-04  8.9704990e-05
  -1.0039508e-03  9.5073134e-04  9.9999905e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 184.39it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 174.79it/s]

Epoch 9 Summary:
  Train Loss: 4.903553
  Val Loss: 1.076210
  Val Trans Error: 0.1909 m
  Val Rot Error: 17.72 degrees
  ✓ New best model saved

============================================================
Epoch 10/50
Learning rate: 0.00000588
============================================================
Epoch 10:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 10:   0%|          | 0/51 [00:00<?, ?it/s, loss=4.5123, trans=0.0414, rot=0.3696, grad=86.56, nan=0]Epoch 10:   0%|          | 0/51 [00:00<?, ?it/s, loss=4.2725, trans=0.0376, rot=0.5159, grad=114.88, nan=0]Epoch 10:   0%|          | 0/51 [00:00<?, ?it/s, loss=5.9780, trans=0.0543, rot=0.5477, grad=110.36, nan=0]Epoch 10:   0%|          | 0/51 [00:00<?, ?it/s, loss=4.4812, trans=0.0399, rot=0.4897, grad=88.49, nan=0] Epoch 10:   0%|          | 0/51 [00:00<?, ?it/s, loss=5.2543, trans=0.0475, rot=0.5014, grad=125.78, nan=0]Epoch 10:   0%|          | 0/51 [00:00<?, ?it/s, loss=5.7928, trans=0.0529, rot=0.5053, grad=123.90, nan=0]Epoch 10:  12%|█▏        | 6/51 [00:00<00:00, 55.74it/s, loss=5.7928, trans=0.0529, rot=0.5053, grad=123.90, nan=0]Epoch 10:  12%|█▏        | 6/51 [00:00<00:00, 55.74it/s, loss=4.3420, trans=0.0386, rot=0.4860, grad=95.18, nan=0] Epoch 10:  12%|█▏        | 6/51 [00:00<00:00, 55.74it/s, loss=6.3811, trans=0.0589, rot=0.4925, grad=111.49, nan=0]Epoch 10:  12%|█▏        | 6/51 [00:00<00:00, 55.74it/s, loss=4.4473, trans=0.0403, rot=0.4220, grad=127.28, nan=0]Epoch 10:  12%|█▏        | 6/51 [00:00<00:00, 55.74it/s, loss=3.9249, trans=0.0343, rot=0.4997, grad=92.93, nan=0] Epoch 10:  12%|█▏        | 6/51 [00:00<00:00, 55.74it/s, loss=5.9036, trans=0.0544, rot=0.4654, grad=137.96, nan=0]Epoch 10:  12%|█▏        | 6/51 [00:00<00:00, 55.74it/s, loss=4.2425, trans=0.0375, rot=0.4949, grad=85.97, nan=0] Epoch 10:  12%|█▏        | 6/51 [00:00<00:00, 55.74it/s, loss=3.9401, trans=0.0343, rot=0.5150, grad=93.27, nan=0]Epoch 10:  12%|█▏        | 6/51 [00:00<00:00, 55.74it/s, loss=4.2113, trans=0.0373, rot=0.4771, grad=97.17, nan=0]Epoch 10:  12%|█▏        | 6/51 [00:00<00:00, 55.74it/s, loss=4.6382, trans=0.0424, rot=0.3939, grad=95.64, nan=0]Epoch 10:  29%|██▉       | 15/51 [00:00<00:00, 74.78it/s, loss=4.6382, trans=0.0424, rot=0.3939, grad=95.64, nan=0]Epoch 10:  29%|██▉       | 15/51 [00:00<00:00, 74.78it/s, loss=4.7275, trans=0.0431, rot=0.4207, grad=86.70, nan=0]Epoch 10:  29%|██▉       | 15/51 [00:00<00:00, 74.78it/s, loss=5.7359, trans=0.0522, rot=0.5157, grad=134.73, nan=0]Epoch 10:  29%|██▉       | 15/51 [00:00<00:00, 74.78it/s, loss=5.4765, trans=0.0499, rot=0.4830, grad=112.04, nan=0]Epoch 10:  29%|██▉       | 15/51 [00:00<00:00, 74.78it/s, loss=3.8809, trans=0.0346, rot=0.4201, grad=67.67, nan=0] Epoch 10:  29%|██▉       | 15/51 [00:00<00:00, 74.78it/s, loss=3.6170, trans=0.0316, rot=0.4531, grad=95.11, nan=0]Epoch 10:  29%|██▉       | 15/51 [00:00<00:00, 74.78it/s, loss=4.2643, trans=0.0378, rot=0.4824, grad=103.25, nan=0]Epoch 10:  29%|██▉       | 15/51 [00:00<00:00, 74.78it/s, loss=4.8413, trans=0.0443, rot=0.4161, grad=94.10, nan=0] Epoch 10:  29%|██▉       | 15/51 [00:00<00:00, 74.78it/s, loss=4.5309, trans=0.0404, rot=0.4889, grad=96.17, nan=0]Epoch 10:  29%|██▉       | 15/51 [00:00<00:00, 74.78it/s, loss=5.0617, trans=0.0463, rot=0.4275, grad=103.86, nan=0]Epoch 10:  29%|██▉       | 15/51 [00:00<00:00, 74.78it/s, loss=3.9890, trans=0.0356, rot=0.4306, grad=103.12, nan=0]Epoch 10:  49%|████▉     | 25/51 [00:00<00:00, 82.31it/s, loss=3.9890, trans=0.0356, rot=0.4306, grad=103.12, nan=0]Epoch 10:  49%|████▉     | 25/51 [00:00<00:00, 82.31it/s, loss=5.1131, trans=0.0470, rot=0.4096, grad=134.43, nan=0]Epoch 10:  49%|████▉     | 25/51 [00:00<00:00, 82.31it/s, loss=3.7659, trans=0.0333, rot=0.4367, grad=81.62, nan=0] Epoch 10:  49%|████▉     | 25/51 [00:00<00:00, 82.31it/s, loss=5.3966, trans=0.0492, rot=0.4730, grad=118.15, nan=0]Epoch 10:  49%|████▉     | 25/51 [00:00<00:00, 82.31it/s, loss=3.9839, trans=0.0352, rot=0.4630, grad=74.53, nan=0] Epoch 10:  49%|████▉     | 25/51 [00:00<00:00, 82.31it/s, loss=4.1554, trans=0.0373, rot=0.4291, grad=81.11, nan=0]Epoch 10:  49%|████▉     | 25/51 [00:00<00:00, 82.31it/s, loss=4.9285, trans=0.0451, rot=0.4164, grad=80.93, nan=0]Epoch 10:  49%|████▉     | 25/51 [00:00<00:00, 82.31it/s, loss=4.2764, trans=0.0384, rot=0.4349, grad=112.18, nan=0]Epoch 10:  49%|████▉     | 25/51 [00:00<00:00, 82.31it/s, loss=5.4746, trans=0.0511, rot=0.3635, grad=123.50, nan=0]Epoch 10:  49%|████▉     | 25/51 [00:00<00:00, 82.31it/s, loss=4.1300, trans=0.0372, rot=0.4073, grad=95.36, nan=0] Epoch 10:  49%|████▉     | 25/51 [00:00<00:00, 82.31it/s, loss=3.8085, trans=0.0339, rot=0.4224, grad=86.40, nan=0]Epoch 10:  69%|██████▊   | 35/51 [00:00<00:00, 86.51it/s, loss=3.8085, trans=0.0339, rot=0.4224, grad=86.40, nan=0]Epoch 10:  69%|██████▊   | 35/51 [00:00<00:00, 86.51it/s, loss=4.5660, trans=0.0415, rot=0.4129, grad=138.35, nan=0]Epoch 10:  69%|██████▊   | 35/51 [00:00<00:00, 86.51it/s, loss=3.6135, trans=0.0318, rot=0.4337, grad=70.14, nan=0] Epoch 10:  69%|██████▊   | 35/51 [00:00<00:00, 86.51it/s, loss=4.1165, trans=0.0365, rot=0.4704, grad=113.44, nan=0]Epoch 10:  69%|██████▊   | 35/51 [00:00<00:00, 86.51it/s, loss=5.0078, trans=0.0450, rot=0.5032, grad=91.37, nan=0] Epoch 10:  69%|██████▊   | 35/51 [00:00<00:00, 86.51it/s, loss=4.1429, trans=0.0373, rot=0.4094, grad=130.07, nan=0]Epoch 10:  69%|██████▊   | 35/51 [00:00<00:00, 86.51it/s, loss=4.0969, trans=0.0368, rot=0.4166, grad=88.17, nan=0] Epoch 10:  69%|██████▊   | 35/51 [00:00<00:00, 86.51it/s, loss=5.0168, trans=0.0461, rot=0.4036, grad=126.90, nan=0]Epoch 10:  69%|██████▊   | 35/51 [00:00<00:00, 86.51it/s, loss=4.0840, trans=0.0367, rot=0.4130, grad=87.75, nan=0] Epoch 10:  69%|██████▊   | 35/51 [00:00<00:00, 86.51it/s, loss=4.6542, trans=0.0424, rot=0.4137, grad=115.13, nan=0]Epoch 10:  69%|██████▊   | 35/51 [00:00<00:00, 86.51it/s, loss=5.4996, trans=0.0506, rot=0.4432, grad=110.36, nan=0]Epoch 10:  88%|████████▊ | 45/51 [00:00<00:00, 89.58it/s, loss=5.4996, trans=0.0506, rot=0.4432, grad=110.36, nan=0]Epoch 10:  88%|████████▊ | 45/51 [00:00<00:00, 89.58it/s, loss=5.7630, trans=0.0525, rot=0.5110, grad=103.85, nan=0]Epoch 10:  88%|████████▊ | 45/51 [00:00<00:00, 89.58it/s, loss=4.3410, trans=0.0387, rot=0.4677, grad=103.75, nan=0]Epoch 10:  88%|████████▊ | 45/51 [00:00<00:00, 89.58it/s, loss=3.9546, trans=0.0357, rot=0.3799, grad=76.98, nan=0] Epoch 10:  88%|████████▊ | 45/51 [00:00<00:00, 89.58it/s, loss=3.8604, trans=0.0345, rot=0.4057, grad=81.64, nan=0]Epoch 10:  88%|████████▊ | 45/51 [00:00<00:00, 89.58it/s, loss=3.8967, trans=0.0348, rot=0.4127, grad=77.39, nan=0]Epoch 10:  88%|████████▊ | 45/51 [00:00<00:00, 89.58it/s, loss=3.9116, trans=0.0349, rot=0.4176, grad=205.46, nan=0]Epoch 10: 100%|██████████| 51/51 [00:00<00:00, 83.23it/s, loss=3.9116, trans=0.0349, rot=0.4176, grad=205.46, nan=0]
Visual features - mean: 0.002266, std: 1.042038
IMU features - mean: -0.009486, std: 0.769693
GT translations (m) - mean: -0.001489, std: 0.033905
GT quaternions - mean: 0.250439, std: 0.432928
Predicted pose window shape: (1, 7)
[[-0.10585842  0.11953986  0.0480002   0.0233401  -0.07802372  0.00378052
  -0.99667114]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.23591849  0.06723985  0.53898704 -0.0502982   0.1433061   0.01256984
  -0.98831946]]
  Ground truth relative pose:
[[ 7.69699225e-04 -2.21063336e-03 -1.19017833e-03  5.39217144e-03
   1.05081126e-04  1.98266655e-03  9.99983549e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 183.54it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 167.40it/s]

Epoch 10 Summary:
  Train Loss: 4.588344
  Val Loss: 0.915629
  Val Trans Error: 0.1751 m
  Val Rot Error: 15.98 degrees
  ✓ New best model saved

============================================================
Epoch 11/50
Learning rate: 0.00000588
============================================================
Epoch 11:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 11:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.6069, trans=0.0322, rot=0.3822, grad=133.91, nan=0]Epoch 11:   0%|          | 0/51 [00:00<?, ?it/s, loss=4.2309, trans=0.0380, rot=0.4354, grad=86.31, nan=0] Epoch 11:   0%|          | 0/51 [00:00<?, ?it/s, loss=5.6469, trans=0.0513, rot=0.5149, grad=79.50, nan=0]Epoch 11:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.8078, trans=0.0339, rot=0.4221, grad=82.65, nan=0]Epoch 11:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.1689, trans=0.0268, rot=0.4935, grad=76.70, nan=0]Epoch 11:   0%|          | 0/51 [00:00<?, ?it/s, loss=5.3887, trans=0.0497, rot=0.4156, grad=92.62, nan=0]Epoch 11:  12%|█▏        | 6/51 [00:00<00:00, 59.44it/s, loss=5.3887, trans=0.0497, rot=0.4156, grad=92.62, nan=0]Epoch 11:  12%|█▏        | 6/51 [00:00<00:00, 59.44it/s, loss=4.2177, trans=0.0378, rot=0.4419, grad=77.75, nan=0]Epoch 11:  12%|█▏        | 6/51 [00:00<00:00, 59.44it/s, loss=4.2138, trans=0.0376, rot=0.4547, grad=91.28, nan=0]Epoch 11:  12%|█▏        | 6/51 [00:00<00:00, 59.44it/s, loss=4.9082, trans=0.0451, rot=0.4009, grad=95.11, nan=0]Epoch 11:  12%|█▏        | 6/51 [00:00<00:00, 59.44it/s, loss=3.9424, trans=0.0355, rot=0.3893, grad=113.65, nan=0]Epoch 11:  12%|█▏        | 6/51 [00:00<00:00, 59.44it/s, loss=5.1088, trans=0.0463, rot=0.4807, grad=121.13, nan=0]Epoch 11:  12%|█▏        | 6/51 [00:00<00:00, 59.44it/s, loss=5.5951, trans=0.0519, rot=0.4097, grad=114.27, nan=0]Epoch 11:  12%|█▏        | 6/51 [00:00<00:00, 59.44it/s, loss=4.8490, trans=0.0434, rot=0.5052, grad=103.53, nan=0]Epoch 11:  12%|█▏        | 6/51 [00:00<00:00, 59.44it/s, loss=4.7614, trans=0.0435, rot=0.4111, grad=95.73, nan=0] Epoch 11:  12%|█▏        | 6/51 [00:00<00:00, 59.44it/s, loss=4.7174, trans=0.0437, rot=0.3520, grad=85.81, nan=0]Epoch 11:  29%|██▉       | 15/51 [00:00<00:00, 77.15it/s, loss=4.7174, trans=0.0437, rot=0.3520, grad=85.81, nan=0]Epoch 11:  29%|██▉       | 15/51 [00:00<00:00, 77.15it/s, loss=4.7177, trans=0.0430, rot=0.4132, grad=75.53, nan=0]Epoch 11:  29%|██▉       | 15/51 [00:00<00:00, 77.15it/s, loss=4.1247, trans=0.0372, rot=0.4079, grad=79.25, nan=0]Epoch 11:  29%|██▉       | 15/51 [00:00<00:00, 77.15it/s, loss=3.6089, trans=0.0314, rot=0.4661, grad=114.48, nan=0]Epoch 11:  29%|██▉       | 15/51 [00:00<00:00, 77.15it/s, loss=4.7795, trans=0.0425, rot=0.5249, grad=88.38, nan=0] Epoch 11:  29%|██▉       | 15/51 [00:00<00:00, 77.15it/s, loss=4.6081, trans=0.0420, rot=0.4031, grad=101.87, nan=0]Epoch 11:  29%|██▉       | 15/51 [00:00<00:00, 77.15it/s, loss=3.6988, trans=0.0327, rot=0.4331, grad=111.33, nan=0]Epoch 11:  29%|██▉       | 15/51 [00:00<00:00, 77.15it/s, loss=3.4357, trans=0.0303, rot=0.4070, grad=72.54, nan=0] Epoch 11:  29%|██▉       | 15/51 [00:00<00:00, 77.15it/s, loss=4.4395, trans=0.0404, rot=0.4031, grad=73.10, nan=0]Epoch 11:  29%|██▉       | 15/51 [00:00<00:00, 77.15it/s, loss=4.4590, trans=0.0403, rot=0.4295, grad=113.77, nan=0]Epoch 11:  29%|██▉       | 15/51 [00:00<00:00, 77.15it/s, loss=3.5400, trans=0.0320, rot=0.3435, grad=79.14, nan=0] Epoch 11:  49%|████▉     | 25/51 [00:00<00:00, 83.57it/s, loss=3.5400, trans=0.0320, rot=0.3435, grad=79.14, nan=0]Epoch 11:  49%|████▉     | 25/51 [00:00<00:00, 83.57it/s, loss=4.0912, trans=0.0368, rot=0.4082, grad=96.86, nan=0]Epoch 11:  49%|████▉     | 25/51 [00:00<00:00, 83.57it/s, loss=5.6127, trans=0.0521, rot=0.4032, grad=125.01, nan=0]Epoch 11:  49%|████▉     | 25/51 [00:00<00:00, 83.57it/s, loss=4.0921, trans=0.0374, rot=0.3474, grad=72.66, nan=0] Epoch 11:  49%|████▉     | 25/51 [00:00<00:00, 83.57it/s, loss=4.1085, trans=0.0368, rot=0.4300, grad=113.65, nan=0]Epoch 11:  49%|████▉     | 25/51 [00:00<00:00, 83.57it/s, loss=3.6195, trans=0.0318, rot=0.4407, grad=107.08, nan=0]Epoch 11:  49%|████▉     | 25/51 [00:00<00:00, 83.57it/s, loss=4.4516, trans=0.0402, rot=0.4290, grad=125.04, nan=0]Epoch 11:  49%|████▉     | 25/51 [00:00<00:00, 83.57it/s, loss=3.7733, trans=0.0336, rot=0.4086, grad=73.65, nan=0] Epoch 11:  49%|████▉     | 25/51 [00:00<00:00, 83.57it/s, loss=4.0622, trans=0.0360, rot=0.4592, grad=77.17, nan=0]Epoch 11:  49%|████▉     | 25/51 [00:00<00:00, 83.57it/s, loss=5.1056, trans=0.0466, rot=0.4443, grad=108.47, nan=0]Epoch 11:  49%|████▉     | 25/51 [00:00<00:00, 83.57it/s, loss=4.9391, trans=0.0452, rot=0.4188, grad=78.13, nan=0] Epoch 11:  69%|██████▊   | 35/51 [00:00<00:00, 87.29it/s, loss=4.9391, trans=0.0452, rot=0.4188, grad=78.13, nan=0]Epoch 11:  69%|██████▊   | 35/51 [00:00<00:00, 87.29it/s, loss=5.2518, trans=0.0487, rot=0.3825, grad=77.80, nan=0]Epoch 11:  69%|██████▊   | 35/51 [00:00<00:00, 87.29it/s, loss=3.8033, trans=0.0340, rot=0.4021, grad=89.12, nan=0]Epoch 11:  69%|██████▊   | 35/51 [00:00<00:00, 87.29it/s, loss=3.9519, trans=0.0356, rot=0.3968, grad=76.21, nan=0]Epoch 11:  69%|██████▊   | 35/51 [00:00<00:00, 87.29it/s, loss=4.0297, trans=0.0363, rot=0.3966, grad=96.28, nan=0]Epoch 11:  69%|██████▊   | 35/51 [00:00<00:00, 87.29it/s, loss=3.7631, trans=0.0327, rot=0.4895, grad=87.03, nan=0]Epoch 11:  69%|██████▊   | 35/51 [00:00<00:00, 87.29it/s, loss=3.8352, trans=0.0344, rot=0.3972, grad=75.69, nan=0]Epoch 11:  69%|██████▊   | 35/51 [00:00<00:00, 87.29it/s, loss=3.3652, trans=0.0294, rot=0.4287, grad=96.44, nan=0]Epoch 11:  69%|██████▊   | 35/51 [00:00<00:00, 87.29it/s, loss=3.9927, trans=0.0358, rot=0.4173, grad=105.50, nan=0]Epoch 11:  69%|██████▊   | 35/51 [00:00<00:00, 87.29it/s, loss=3.9933, trans=0.0357, rot=0.4268, grad=89.62, nan=0] Epoch 11:  69%|██████▊   | 35/51 [00:00<00:00, 87.29it/s, loss=4.2181, trans=0.0379, rot=0.4253, grad=103.16, nan=0]Epoch 11:  88%|████████▊ | 45/51 [00:00<00:00, 89.69it/s, loss=4.2181, trans=0.0379, rot=0.4253, grad=103.16, nan=0]Epoch 11:  88%|████████▊ | 45/51 [00:00<00:00, 89.69it/s, loss=4.3607, trans=0.0399, rot=0.3754, grad=80.06, nan=0] Epoch 11:  88%|████████▊ | 45/51 [00:00<00:00, 89.69it/s, loss=4.4889, trans=0.0402, rot=0.4712, grad=109.06, nan=0]Epoch 11:  88%|████████▊ | 45/51 [00:00<00:00, 89.69it/s, loss=4.3832, trans=0.0392, rot=0.4596, grad=111.86, nan=0]Epoch 11:  88%|████████▊ | 45/51 [00:00<00:00, 89.69it/s, loss=3.1377, trans=0.0268, rot=0.4545, grad=70.65, nan=0] Epoch 11:  88%|████████▊ | 45/51 [00:00<00:00, 89.69it/s, loss=4.9249, trans=0.0452, rot=0.4033, grad=102.44, nan=0]Epoch 11:  88%|████████▊ | 45/51 [00:00<00:00, 89.69it/s, loss=3.9756, trans=0.0360, rot=0.3712, grad=215.72, nan=0]Epoch 11: 100%|██████████| 51/51 [00:00<00:00, 81.54it/s, loss=3.9756, trans=0.0360, rot=0.3712, grad=215.72, nan=0]
Visual features - mean: -0.001469, std: 0.894540
IMU features - mean: 0.007367, std: 0.867555
GT translations (m) - mean: 0.000178, std: 0.035766
GT quaternions - mean: 0.250871, std: 0.432678
Predicted pose window shape: (1, 7)
[[-0.20965612 -0.27758598 -0.05938397 -0.13111241 -0.17592986  0.16751352
  -0.9611438 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.641045   -0.31705633 -0.20525326  0.04147352  0.20432241 -0.02854695
  -0.97760797]]
  Ground truth relative pose:
[[ 7.7072525e-04 -6.6060323e-04  7.5374497e-04 -3.0013919e-04
   2.2058487e-03  1.0648817e-03  9.9999702e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 184.57it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 155.83it/s]

Epoch 11 Summary:
  Train Loss: 4.292296
  Val Loss: 0.788640
  Val Trans Error: 0.1616 m
  Val Rot Error: 14.37 degrees
  ✓ New best model saved

============================================================
Epoch 12/50
Learning rate: 0.00000588
============================================================
Epoch 12:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 12:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.5562, trans=0.0315, rot=0.4069, grad=85.93, nan=0]Epoch 12:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.9195, trans=0.0351, rot=0.4120, grad=71.17, nan=0]Epoch 12:   0%|          | 0/51 [00:00<?, ?it/s, loss=4.0160, trans=0.0365, rot=0.3683, grad=84.32, nan=0]Epoch 12:   0%|          | 0/51 [00:00<?, ?it/s, loss=4.8646, trans=0.0446, rot=0.4084, grad=75.29, nan=0]Epoch 12:   0%|          | 0/51 [00:00<?, ?it/s, loss=4.6767, trans=0.0430, rot=0.3798, grad=108.73, nan=0]Epoch 12:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.8792, trans=0.0351, rot=0.3729, grad=68.16, nan=0] Epoch 12:  12%|█▏        | 6/51 [00:00<00:00, 57.21it/s, loss=3.8792, trans=0.0351, rot=0.3729, grad=68.16, nan=0]Epoch 12:  12%|█▏        | 6/51 [00:00<00:00, 57.21it/s, loss=4.3509, trans=0.0394, rot=0.4154, grad=79.38, nan=0]Epoch 12:  12%|█▏        | 6/51 [00:00<00:00, 57.21it/s, loss=3.8588, trans=0.0351, rot=0.3532, grad=81.74, nan=0]Epoch 12:  12%|█▏        | 6/51 [00:00<00:00, 57.21it/s, loss=3.8076, trans=0.0336, rot=0.4487, grad=81.18, nan=0]Epoch 12:  12%|█▏        | 6/51 [00:00<00:00, 57.21it/s, loss=3.9663, trans=0.0355, rot=0.4167, grad=106.01, nan=0]Epoch 12:  12%|█▏        | 6/51 [00:00<00:00, 57.21it/s, loss=3.3955, trans=0.0296, rot=0.4331, grad=67.85, nan=0] Epoch 12:  12%|█▏        | 6/51 [00:00<00:00, 57.21it/s, loss=3.7014, trans=0.0331, rot=0.3895, grad=66.49, nan=0]Epoch 12:  12%|█▏        | 6/51 [00:00<00:00, 57.21it/s, loss=3.8196, trans=0.0344, rot=0.3789, grad=77.11, nan=0]Epoch 12:  12%|█▏        | 6/51 [00:00<00:00, 57.21it/s, loss=3.9789, trans=0.0354, rot=0.4356, grad=102.10, nan=0]Epoch 12:  12%|█▏        | 6/51 [00:00<00:00, 57.21it/s, loss=3.6268, trans=0.0325, rot=0.3720, grad=79.48, nan=0] Epoch 12:  12%|█▏        | 6/51 [00:00<00:00, 57.21it/s, loss=4.4600, trans=0.0403, rot=0.4339, grad=79.59, nan=0]Epoch 12:  31%|███▏      | 16/51 [00:00<00:00, 77.26it/s, loss=4.4600, trans=0.0403, rot=0.4339, grad=79.59, nan=0]Epoch 12:  31%|███▏      | 16/51 [00:00<00:00, 77.26it/s, loss=4.0096, trans=0.0366, rot=0.3480, grad=90.21, nan=0]Epoch 12:  31%|███▏      | 16/51 [00:00<00:00, 77.26it/s, loss=4.9364, trans=0.0448, rot=0.4575, grad=99.26, nan=0]Epoch 12:  31%|███▏      | 16/51 [00:00<00:00, 77.26it/s, loss=3.1381, trans=0.0276, rot=0.3756, grad=69.46, nan=0]Epoch 12:  31%|███▏      | 16/51 [00:00<00:00, 77.26it/s, loss=3.9555, trans=0.0357, rot=0.3896, grad=74.46, nan=0]Epoch 12:  31%|███▏      | 16/51 [00:00<00:00, 77.26it/s, loss=2.6773, trans=0.0225, rot=0.4267, grad=72.68, nan=0]Epoch 12:  31%|███▏      | 16/51 [00:00<00:00, 77.26it/s, loss=4.6789, trans=0.0423, rot=0.4441, grad=115.60, nan=0]Epoch 12:  31%|███▏      | 16/51 [00:00<00:00, 77.26it/s, loss=3.9873, trans=0.0361, rot=0.3757, grad=68.81, nan=0] Epoch 12:  31%|███▏      | 16/51 [00:00<00:00, 77.26it/s, loss=3.9557, trans=0.0352, rot=0.4310, grad=103.64, nan=0]Epoch 12:  31%|███▏      | 16/51 [00:00<00:00, 77.26it/s, loss=4.3502, trans=0.0390, rot=0.4459, grad=74.87, nan=0] Epoch 12:  49%|████▉     | 25/51 [00:00<00:00, 81.53it/s, loss=4.3502, trans=0.0390, rot=0.4459, grad=74.87, nan=0]Epoch 12:  49%|████▉     | 25/51 [00:00<00:00, 81.53it/s, loss=3.9537, trans=0.0354, rot=0.4094, grad=81.50, nan=0]Epoch 12:  49%|████▉     | 25/51 [00:00<00:00, 81.53it/s, loss=4.5635, trans=0.0418, rot=0.3850, grad=95.00, nan=0]Epoch 12:  49%|████▉     | 25/51 [00:00<00:00, 81.53it/s, loss=3.9741, trans=0.0359, rot=0.3794, grad=107.11, nan=0]Epoch 12:  49%|████▉     | 25/51 [00:00<00:00, 81.53it/s, loss=5.3478, trans=0.0500, rot=0.3485, grad=123.97, nan=0]Epoch 12:  49%|████▉     | 25/51 [00:00<00:00, 81.53it/s, loss=4.6847, trans=0.0430, rot=0.3850, grad=105.86, nan=0]Epoch 12:  49%|████▉     | 25/51 [00:00<00:00, 81.53it/s, loss=4.3555, trans=0.0394, rot=0.4153, grad=82.32, nan=0] Epoch 12:  49%|████▉     | 25/51 [00:00<00:00, 81.53it/s, loss=3.9047, trans=0.0357, rot=0.3377, grad=90.90, nan=0]Epoch 12:  49%|████▉     | 25/51 [00:00<00:00, 81.53it/s, loss=4.4880, trans=0.0411, rot=0.3748, grad=87.63, nan=0]Epoch 12:  49%|████▉     | 25/51 [00:00<00:00, 81.53it/s, loss=3.8740, trans=0.0346, rot=0.4123, grad=69.82, nan=0]Epoch 12:  67%|██████▋   | 34/51 [00:00<00:00, 81.72it/s, loss=3.8740, trans=0.0346, rot=0.4123, grad=69.82, nan=0]Epoch 12:  67%|██████▋   | 34/51 [00:00<00:00, 81.72it/s, loss=3.1685, trans=0.0272, rot=0.4475, grad=62.82, nan=0]Epoch 12:  67%|██████▋   | 34/51 [00:00<00:00, 81.72it/s, loss=3.9462, trans=0.0355, rot=0.3932, grad=67.80, nan=0]Epoch 12:  67%|██████▋   | 34/51 [00:00<00:00, 81.72it/s, loss=3.9120, trans=0.0354, rot=0.3713, grad=89.95, nan=0]Epoch 12:  67%|██████▋   | 34/51 [00:00<00:00, 81.72it/s, loss=3.9264, trans=0.0355, rot=0.3805, grad=91.41, nan=0]Epoch 12:  67%|██████▋   | 34/51 [00:00<00:00, 81.72it/s, loss=4.8175, trans=0.0446, rot=0.3598, grad=99.21, nan=0]Epoch 12:  67%|██████▋   | 34/51 [00:00<00:00, 81.72it/s, loss=3.5563, trans=0.0320, rot=0.3522, grad=67.40, nan=0]Epoch 12:  67%|██████▋   | 34/51 [00:00<00:00, 81.72it/s, loss=3.3986, trans=0.0304, rot=0.3540, grad=95.56, nan=0]Epoch 12:  67%|██████▋   | 34/51 [00:00<00:00, 81.72it/s, loss=4.0390, trans=0.0369, rot=0.3523, grad=98.91, nan=0]Epoch 12:  67%|██████▋   | 34/51 [00:00<00:00, 81.72it/s, loss=4.2047, trans=0.0375, rot=0.4595, grad=76.91, nan=0]Epoch 12:  84%|████████▍ | 43/51 [00:00<00:00, 80.84it/s, loss=4.2047, trans=0.0375, rot=0.4595, grad=76.91, nan=0]Epoch 12:  84%|████████▍ | 43/51 [00:00<00:00, 80.84it/s, loss=2.8078, trans=0.0243, rot=0.3784, grad=54.83, nan=0]Epoch 12:  84%|████████▍ | 43/51 [00:00<00:00, 80.84it/s, loss=3.9124, trans=0.0351, rot=0.3991, grad=102.62, nan=0]Epoch 12:  84%|████████▍ | 43/51 [00:00<00:00, 80.84it/s, loss=3.0900, trans=0.0275, rot=0.3422, grad=65.08, nan=0] Epoch 12:  84%|████████▍ | 43/51 [00:00<00:00, 80.84it/s, loss=3.9827, trans=0.0358, rot=0.3997, grad=70.41, nan=0]Epoch 12:  84%|████████▍ | 43/51 [00:00<00:00, 80.84it/s, loss=4.5078, trans=0.0410, rot=0.4077, grad=90.78, nan=0]Epoch 12:  84%|████████▍ | 43/51 [00:00<00:00, 80.84it/s, loss=3.1512, trans=0.0278, rot=0.3740, grad=78.85, nan=0]Epoch 12:  84%|████████▍ | 43/51 [00:00<00:00, 80.84it/s, loss=3.4602, trans=0.0306, rot=0.3979, grad=82.03, nan=0]Epoch 12:  84%|████████▍ | 43/51 [00:00<00:00, 80.84it/s, loss=8.1666, trans=0.0778, rot=0.3848, grad=257.23, nan=0]Epoch 12: 100%|██████████| 51/51 [00:00<00:00, 77.96it/s, loss=8.1666, trans=0.0778, rot=0.3848, grad=257.23, nan=0]
Visual features - mean: -0.002893, std: 1.007640
IMU features - mean: -0.000992, std: 1.028662
GT translations (m) - mean: -0.002209, std: 0.043852
GT quaternions - mean: 0.250448, std: 0.432923
Predicted pose window shape: (1, 7)
[[-0.37822554  0.06463112 -0.00778008  0.19057941  0.03716797 -0.01252722
  -0.9808879 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.06995863 -0.5141751   0.23315014  0.07203881  0.16732217 -0.13738455
  -0.9736217 ]]
  Ground truth relative pose:
[[-4.6505826e-04 -9.7898475e-05 -3.8119318e-04  2.8200299e-03
  -3.3805966e-03 -3.8026795e-03  9.9998307e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  64%|██████▎   | 14/22 [00:00<00:00, 134.89it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 139.68it/s]

Epoch 12 Summary:
  Train Loss: 4.054144
  Val Loss: 0.648279
  Val Trans Error: 0.1414 m
  Val Rot Error: 12.98 degrees
  ✓ New best model saved

============================================================
Epoch 13/50
Learning rate: 0.00000588
============================================================
Epoch 13:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 13:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.3128, trans=0.0297, rot=0.3389, grad=117.30, nan=0]Epoch 13:   0%|          | 0/51 [00:00<?, ?it/s, loss=4.1527, trans=0.0379, rot=0.3604, grad=84.85, nan=0] Epoch 13:   0%|          | 0/51 [00:00<?, ?it/s, loss=4.5247, trans=0.0413, rot=0.3952, grad=85.79, nan=0]Epoch 13:   0%|          | 0/51 [00:00<?, ?it/s, loss=4.5545, trans=0.0414, rot=0.4116, grad=79.87, nan=0]Epoch 13:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.8376, trans=0.0246, rot=0.3739, grad=78.93, nan=0]Epoch 13:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.6730, trans=0.0230, rot=0.3713, grad=50.14, nan=0]Epoch 13:  12%|█▏        | 6/51 [00:00<00:00, 55.44it/s, loss=2.6730, trans=0.0230, rot=0.3713, grad=50.14, nan=0]Epoch 13:  12%|█▏        | 6/51 [00:00<00:00, 55.44it/s, loss=4.2960, trans=0.0388, rot=0.4134, grad=92.52, nan=0]Epoch 13:  12%|█▏        | 6/51 [00:00<00:00, 55.44it/s, loss=3.3617, trans=0.0299, rot=0.3694, grad=54.89, nan=0]Epoch 13:  12%|█▏        | 6/51 [00:00<00:00, 55.44it/s, loss=3.9259, trans=0.0357, rot=0.3589, grad=97.16, nan=0]Epoch 13:  12%|█▏        | 6/51 [00:00<00:00, 55.44it/s, loss=4.3674, trans=0.0402, rot=0.3494, grad=81.33, nan=0]Epoch 13:  12%|█▏        | 6/51 [00:00<00:00, 55.44it/s, loss=3.3231, trans=0.0296, rot=0.3630, grad=66.61, nan=0]Epoch 13:  12%|█▏        | 6/51 [00:00<00:00, 55.44it/s, loss=3.2832, trans=0.0289, rot=0.3930, grad=91.14, nan=0]Epoch 13:  12%|█▏        | 6/51 [00:00<00:00, 55.44it/s, loss=3.4208, trans=0.0301, rot=0.4106, grad=59.08, nan=0]Epoch 13:  12%|█▏        | 6/51 [00:00<00:00, 55.44it/s, loss=3.7408, trans=0.0333, rot=0.4065, grad=84.32, nan=0]Epoch 13:  27%|██▋       | 14/51 [00:00<00:00, 65.86it/s, loss=3.7408, trans=0.0333, rot=0.4065, grad=84.32, nan=0]Epoch 13:  27%|██▋       | 14/51 [00:00<00:00, 65.86it/s, loss=3.8443, trans=0.0349, rot=0.3527, grad=50.42, nan=0]Epoch 13:  27%|██▋       | 14/51 [00:00<00:00, 65.86it/s, loss=4.7013, trans=0.0434, rot=0.3648, grad=91.76, nan=0]Epoch 13:  27%|██▋       | 14/51 [00:00<00:00, 65.86it/s, loss=3.9534, trans=0.0360, rot=0.3521, grad=104.87, nan=0]Epoch 13:  27%|██▋       | 14/51 [00:00<00:00, 65.86it/s, loss=3.8043, trans=0.0339, rot=0.4109, grad=67.90, nan=0] Epoch 13:  27%|██▋       | 14/51 [00:00<00:00, 65.86it/s, loss=3.5681, trans=0.0320, rot=0.3667, grad=67.65, nan=0]Epoch 13:  27%|██▋       | 14/51 [00:00<00:00, 65.86it/s, loss=3.5323, trans=0.0315, rot=0.3852, grad=67.71, nan=0]Epoch 13:  27%|██▋       | 14/51 [00:00<00:00, 65.86it/s, loss=3.0561, trans=0.0269, rot=0.3621, grad=137.87, nan=0]Epoch 13:  27%|██▋       | 14/51 [00:00<00:00, 65.86it/s, loss=3.7472, trans=0.0338, rot=0.3657, grad=77.60, nan=0] Epoch 13:  27%|██▋       | 14/51 [00:00<00:00, 65.86it/s, loss=4.0578, trans=0.0367, rot=0.3831, grad=64.43, nan=0]Epoch 13:  45%|████▌     | 23/51 [00:00<00:00, 74.14it/s, loss=4.0578, trans=0.0367, rot=0.3831, grad=64.43, nan=0]Epoch 13:  45%|████▌     | 23/51 [00:00<00:00, 74.14it/s, loss=3.0013, trans=0.0267, rot=0.3355, grad=65.05, nan=0]Epoch 13:  45%|████▌     | 23/51 [00:00<00:00, 74.14it/s, loss=2.8208, trans=0.0243, rot=0.3906, grad=88.71, nan=0]Epoch 13:  45%|████▌     | 23/51 [00:00<00:00, 74.14it/s, loss=3.6505, trans=0.0322, rot=0.4345, grad=101.73, nan=0]Epoch 13:  45%|████▌     | 23/51 [00:00<00:00, 74.14it/s, loss=3.4563, trans=0.0305, rot=0.4056, grad=71.92, nan=0] Epoch 13:  45%|████▌     | 23/51 [00:00<00:00, 74.14it/s, loss=3.4818, trans=0.0313, rot=0.3558, grad=63.38, nan=0]Epoch 13:  45%|████▌     | 23/51 [00:00<00:00, 74.14it/s, loss=2.9863, trans=0.0266, rot=0.3310, grad=83.88, nan=0]Epoch 13:  45%|████▌     | 23/51 [00:00<00:00, 74.14it/s, loss=3.1239, trans=0.0279, rot=0.3376, grad=79.42, nan=0]Epoch 13:  45%|████▌     | 23/51 [00:00<00:00, 74.14it/s, loss=3.3059, trans=0.0290, rot=0.4030, grad=57.52, nan=0]Epoch 13:  45%|████▌     | 23/51 [00:00<00:00, 74.14it/s, loss=3.3025, trans=0.0294, rot=0.3587, grad=65.60, nan=0]Epoch 13:  63%|██████▎   | 32/51 [00:00<00:00, 79.77it/s, loss=3.3025, trans=0.0294, rot=0.3587, grad=65.60, nan=0]Epoch 13:  63%|██████▎   | 32/51 [00:00<00:00, 79.77it/s, loss=3.9975, trans=0.0367, rot=0.3299, grad=103.12, nan=0]Epoch 13:  63%|██████▎   | 32/51 [00:00<00:00, 79.77it/s, loss=3.6048, trans=0.0315, rot=0.4564, grad=77.87, nan=0] Epoch 13:  63%|██████▎   | 32/51 [00:00<00:00, 79.77it/s, loss=3.2040, trans=0.0281, rot=0.3986, grad=68.70, nan=0]Epoch 13:  63%|██████▎   | 32/51 [00:00<00:00, 79.77it/s, loss=3.4319, trans=0.0306, rot=0.3685, grad=61.19, nan=0]Epoch 13:  63%|██████▎   | 32/51 [00:00<00:00, 79.77it/s, loss=3.2631, trans=0.0292, rot=0.3479, grad=67.70, nan=0]Epoch 13:  63%|██████▎   | 32/51 [00:00<00:00, 79.77it/s, loss=3.5910, trans=0.0326, rot=0.3275, grad=81.35, nan=0]Epoch 13:  63%|██████▎   | 32/51 [00:00<00:00, 79.77it/s, loss=3.5838, trans=0.0321, rot=0.3758, grad=94.37, nan=0]Epoch 13:  63%|██████▎   | 32/51 [00:00<00:00, 79.77it/s, loss=3.6533, trans=0.0328, rot=0.3729, grad=114.64, nan=0]Epoch 13:  63%|██████▎   | 32/51 [00:00<00:00, 79.77it/s, loss=3.4633, trans=0.0308, rot=0.3874, grad=60.37, nan=0] Epoch 13:  63%|██████▎   | 32/51 [00:00<00:00, 79.77it/s, loss=4.4515, trans=0.0407, rot=0.3776, grad=74.33, nan=0]Epoch 13:  82%|████████▏ | 42/51 [00:00<00:00, 85.83it/s, loss=4.4515, trans=0.0407, rot=0.3776, grad=74.33, nan=0]Epoch 13:  82%|████████▏ | 42/51 [00:00<00:00, 85.83it/s, loss=3.3156, trans=0.0295, rot=0.3630, grad=69.82, nan=0]Epoch 13:  82%|████████▏ | 42/51 [00:00<00:00, 85.83it/s, loss=4.1765, trans=0.0379, rot=0.3912, grad=89.91, nan=0]Epoch 13:  82%|████████▏ | 42/51 [00:00<00:00, 85.83it/s, loss=3.4829, trans=0.0311, rot=0.3735, grad=67.36, nan=0]Epoch 13:  82%|████████▏ | 42/51 [00:00<00:00, 85.83it/s, loss=4.0844, trans=0.0369, rot=0.3902, grad=91.57, nan=0]Epoch 13:  82%|████████▏ | 42/51 [00:00<00:00, 85.83it/s, loss=3.6628, trans=0.0332, rot=0.3469, grad=84.98, nan=0]Epoch 13:  82%|████████▏ | 42/51 [00:00<00:00, 85.83it/s, loss=3.8652, trans=0.0348, rot=0.3892, grad=69.49, nan=0]Epoch 13:  82%|████████▏ | 42/51 [00:00<00:00, 85.83it/s, loss=3.3758, trans=0.0298, rot=0.3932, grad=87.38, nan=0]Epoch 13:  82%|████████▏ | 42/51 [00:00<00:00, 85.83it/s, loss=3.2694, trans=0.0284, rot=0.4328, grad=71.55, nan=0]Epoch 13:  82%|████████▏ | 42/51 [00:00<00:00, 85.83it/s, loss=1.1798, trans=0.0090, rot=0.2762, grad=73.06, nan=0]Epoch 13: 100%|██████████| 51/51 [00:00<00:00, 79.98it/s, loss=1.1798, trans=0.0090, rot=0.2762, grad=73.06, nan=0]
Visual features - mean: 0.004178, std: 0.951588
IMU features - mean: 0.000936, std: 0.906209
GT translations (m) - mean: -0.000580, std: 0.035206
GT quaternions - mean: 0.250903, std: 0.432659
Predicted pose window shape: (1, 7)
[[ 0.23717295 -0.02360515  0.48384118 -0.07356299 -0.10929827 -0.04321851
  -0.99034065]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.21142733 -0.09281197  0.03889549  0.03824044  0.06463546  0.14912654
  -0.98596203]]
  Ground truth relative pose:
[[ 3.0214959e-03  1.0134224e-03  3.1316560e-04  8.8592404e-03
  -8.3977291e-03 -6.7782481e-03  9.9990255e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 187.75it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 176.24it/s]

Epoch 13 Summary:
  Train Loss: 3.565195
  Val Loss: 0.608997
  Val Trans Error: 0.1383 m
  Val Rot Error: 11.83 degrees
  ✓ New best model saved

============================================================
Epoch 14/50
Learning rate: 0.00000588
============================================================
Epoch 14:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 14:   0%|          | 0/51 [00:00<?, ?it/s, loss=4.1465, trans=0.0377, rot=0.3768, grad=91.17, nan=0]Epoch 14:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.9387, trans=0.0357, rot=0.3717, grad=97.48, nan=0]Epoch 14:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.2976, trans=0.0293, rot=0.3723, grad=56.32, nan=0]Epoch 14:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.2063, trans=0.0286, rot=0.3462, grad=71.45, nan=0]Epoch 14:   0%|          | 0/51 [00:00<?, ?it/s, loss=4.0099, trans=0.0359, rot=0.4199, grad=81.29, nan=0]Epoch 14:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.5934, trans=0.0322, rot=0.3730, grad=54.84, nan=0]Epoch 14:  12%|█▏        | 6/51 [00:00<00:00, 58.00it/s, loss=3.5934, trans=0.0322, rot=0.3730, grad=54.84, nan=0]Epoch 14:  12%|█▏        | 6/51 [00:00<00:00, 58.00it/s, loss=4.3112, trans=0.0399, rot=0.3173, grad=73.91, nan=0]Epoch 14:  12%|█▏        | 6/51 [00:00<00:00, 58.00it/s, loss=2.8896, trans=0.0258, rot=0.3064, grad=74.33, nan=0]Epoch 14:  12%|█▏        | 6/51 [00:00<00:00, 58.00it/s, loss=3.4691, trans=0.0309, rot=0.3799, grad=97.07, nan=0]Epoch 14:  12%|█▏        | 6/51 [00:00<00:00, 58.00it/s, loss=3.5682, trans=0.0319, rot=0.3805, grad=60.57, nan=0]Epoch 14:  12%|█▏        | 6/51 [00:00<00:00, 58.00it/s, loss=2.7752, trans=0.0234, rot=0.4340, grad=52.08, nan=0]Epoch 14:  12%|█▏        | 6/51 [00:00<00:00, 58.00it/s, loss=3.3297, trans=0.0297, rot=0.3645, grad=72.58, nan=0]Epoch 14:  12%|█▏        | 6/51 [00:00<00:00, 58.00it/s, loss=3.6817, trans=0.0333, rot=0.3534, grad=74.20, nan=0]Epoch 14:  12%|█▏        | 6/51 [00:00<00:00, 58.00it/s, loss=3.2157, trans=0.0286, rot=0.3569, grad=57.14, nan=0]Epoch 14:  12%|█▏        | 6/51 [00:00<00:00, 58.00it/s, loss=3.8528, trans=0.0347, rot=0.3805, grad=72.64, nan=0]Epoch 14:  12%|█▏        | 6/51 [00:00<00:00, 58.00it/s, loss=3.7949, trans=0.0345, rot=0.3425, grad=65.17, nan=0]Epoch 14:  31%|███▏      | 16/51 [00:00<00:00, 80.35it/s, loss=3.7949, trans=0.0345, rot=0.3425, grad=65.17, nan=0]Epoch 14:  31%|███▏      | 16/51 [00:00<00:00, 80.35it/s, loss=3.7408, trans=0.0340, rot=0.3408, grad=68.00, nan=0]Epoch 14:  31%|███▏      | 16/51 [00:00<00:00, 80.35it/s, loss=3.4883, trans=0.0315, rot=0.3407, grad=72.63, nan=0]Epoch 14:  31%|███▏      | 16/51 [00:00<00:00, 80.35it/s, loss=3.8991, trans=0.0346, rot=0.4360, grad=77.27, nan=0]Epoch 14:  31%|███▏      | 16/51 [00:00<00:00, 80.35it/s, loss=3.2005, trans=0.0286, rot=0.3453, grad=96.86, nan=0]Epoch 14:  31%|███▏      | 16/51 [00:00<00:00, 80.35it/s, loss=3.3457, trans=0.0300, rot=0.3421, grad=64.23, nan=0]Epoch 14:  31%|███▏      | 16/51 [00:00<00:00, 80.35it/s, loss=2.6021, trans=0.0226, rot=0.3434, grad=60.10, nan=0]Epoch 14:  31%|███▏      | 16/51 [00:00<00:00, 80.35it/s, loss=3.1833, trans=0.0285, rot=0.3372, grad=72.96, nan=0]Epoch 14:  31%|███▏      | 16/51 [00:00<00:00, 80.35it/s, loss=3.6304, trans=0.0330, rot=0.3284, grad=61.68, nan=0]Epoch 14:  31%|███▏      | 16/51 [00:00<00:00, 80.35it/s, loss=3.4402, trans=0.0306, rot=0.3772, grad=89.43, nan=0]Epoch 14:  31%|███▏      | 16/51 [00:00<00:00, 80.35it/s, loss=3.6075, trans=0.0323, rot=0.3776, grad=87.76, nan=0]Epoch 14:  51%|█████     | 26/51 [00:00<00:00, 84.59it/s, loss=3.6075, trans=0.0323, rot=0.3776, grad=87.76, nan=0]Epoch 14:  51%|█████     | 26/51 [00:00<00:00, 84.59it/s, loss=3.3510, trans=0.0298, rot=0.3749, grad=56.15, nan=0]Epoch 14:  51%|█████     | 26/51 [00:00<00:00, 84.59it/s, loss=2.9511, trans=0.0260, rot=0.3474, grad=53.06, nan=0]Epoch 14:  51%|█████     | 26/51 [00:00<00:00, 84.59it/s, loss=4.2026, trans=0.0384, rot=0.3651, grad=104.46, nan=0]Epoch 14:  51%|█████     | 26/51 [00:00<00:00, 84.59it/s, loss=3.5825, trans=0.0323, rot=0.3511, grad=80.50, nan=0] Epoch 14:  51%|█████     | 26/51 [00:00<00:00, 84.59it/s, loss=4.1594, trans=0.0377, rot=0.3877, grad=90.99, nan=0]Epoch 14:  51%|█████     | 26/51 [00:00<00:00, 84.59it/s, loss=3.2178, trans=0.0292, rot=0.2995, grad=73.97, nan=0]Epoch 14:  51%|█████     | 26/51 [00:00<00:00, 84.59it/s, loss=3.2415, trans=0.0292, rot=0.3234, grad=68.09, nan=0]Epoch 14:  51%|█████     | 26/51 [00:00<00:00, 84.59it/s, loss=4.4290, trans=0.0406, rot=0.3701, grad=85.44, nan=0]Epoch 14:  51%|█████     | 26/51 [00:00<00:00, 84.59it/s, loss=3.0631, trans=0.0270, rot=0.3590, grad=53.98, nan=0]Epoch 14:  69%|██████▊   | 35/51 [00:00<00:00, 84.78it/s, loss=3.0631, trans=0.0270, rot=0.3590, grad=53.98, nan=0]Epoch 14:  69%|██████▊   | 35/51 [00:00<00:00, 84.78it/s, loss=4.2739, trans=0.0396, rot=0.3142, grad=93.18, nan=0]Epoch 14:  69%|██████▊   | 35/51 [00:00<00:00, 84.78it/s, loss=2.8248, trans=0.0247, rot=0.3549, grad=55.99, nan=0]Epoch 14:  69%|██████▊   | 35/51 [00:00<00:00, 84.78it/s, loss=4.2863, trans=0.0395, rot=0.3319, grad=80.76, nan=0]Epoch 14:  69%|██████▊   | 35/51 [00:00<00:00, 84.78it/s, loss=3.5961, trans=0.0325, rot=0.3487, grad=89.55, nan=0]Epoch 14:  69%|██████▊   | 35/51 [00:00<00:00, 84.78it/s, loss=3.5734, trans=0.0321, rot=0.3676, grad=101.59, nan=0]Epoch 14:  69%|██████▊   | 35/51 [00:00<00:00, 84.78it/s, loss=4.0585, trans=0.0373, rot=0.3271, grad=114.89, nan=0]Epoch 14:  69%|██████▊   | 35/51 [00:00<00:00, 84.78it/s, loss=3.6231, trans=0.0332, rot=0.3007, grad=64.71, nan=0] Epoch 14:  69%|██████▊   | 35/51 [00:00<00:00, 84.78it/s, loss=3.1791, trans=0.0285, rot=0.3246, grad=67.77, nan=0]Epoch 14:  69%|██████▊   | 35/51 [00:00<00:00, 84.78it/s, loss=3.5135, trans=0.0318, rot=0.3380, grad=60.88, nan=0]Epoch 14:  69%|██████▊   | 35/51 [00:00<00:00, 84.78it/s, loss=3.4643, trans=0.0314, rot=0.3261, grad=61.95, nan=0]Epoch 14:  88%|████████▊ | 45/51 [00:00<00:00, 88.65it/s, loss=3.4643, trans=0.0314, rot=0.3261, grad=61.95, nan=0]Epoch 14:  88%|████████▊ | 45/51 [00:00<00:00, 88.65it/s, loss=3.0789, trans=0.0269, rot=0.3846, grad=49.31, nan=0]Epoch 14:  88%|████████▊ | 45/51 [00:00<00:00, 88.65it/s, loss=3.0614, trans=0.0272, rot=0.3449, grad=56.17, nan=0]Epoch 14:  88%|████████▊ | 45/51 [00:00<00:00, 88.65it/s, loss=3.7265, trans=0.0331, rot=0.4146, grad=74.74, nan=0]Epoch 14:  88%|████████▊ | 45/51 [00:00<00:00, 88.65it/s, loss=3.1909, trans=0.0284, rot=0.3541, grad=70.34, nan=0]Epoch 14:  88%|████████▊ | 45/51 [00:00<00:00, 88.65it/s, loss=3.6230, trans=0.0322, rot=0.4073, grad=91.43, nan=0]Epoch 14:  88%|████████▊ | 45/51 [00:00<00:00, 88.65it/s, loss=3.3543, trans=0.0287, rot=0.4833, grad=128.28, nan=0]Epoch 14: 100%|██████████| 51/51 [00:00<00:00, 83.89it/s, loss=3.3543, trans=0.0287, rot=0.4833, grad=128.28, nan=0]
Visual features - mean: -0.002824, std: 0.983385
IMU features - mean: 0.003184, std: 0.905951
GT translations (m) - mean: -0.001787, std: 0.038520
GT quaternions - mean: 0.249666, std: 0.433375
Predicted pose window shape: (1, 7)
[[ 0.3208771   0.04129889  0.01830347  0.00867385  0.0901481  -0.19655138
  -0.97630197]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.0991128   0.10599338  0.02668921  0.1544781  -0.04377222 -0.05962772
  -0.98522335]]
  Ground truth relative pose:
[[-4.9884198e-05 -4.4931544e-04 -2.0355927e-03  9.5359534e-03
   8.3183646e-03  5.3185672e-03  9.9990582e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  91%|█████████ | 20/22 [00:00<00:00, 199.09it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 175.50it/s]

Epoch 14 Summary:
  Train Loss: 3.526358
  Val Loss: 0.527946
  Val Trans Error: 0.1259 m
  Val Rot Error: 10.98 degrees
  ✓ New best model saved

============================================================
Epoch 15/50
Learning rate: 0.00000588
============================================================
Epoch 15:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 15:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.4840, trans=0.0312, rot=0.3599, grad=85.82, nan=0]Epoch 15:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.6408, trans=0.0327, rot=0.3727, grad=74.33, nan=0]Epoch 15:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.2043, trans=0.0289, rot=0.3110, grad=76.61, nan=0]Epoch 15:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.6039, trans=0.0324, rot=0.3630, grad=91.85, nan=0]Epoch 15:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.6983, trans=0.0336, rot=0.3426, grad=85.12, nan=0]Epoch 15:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.0379, trans=0.0268, rot=0.3595, grad=100.70, nan=0]Epoch 15:  12%|█▏        | 6/51 [00:00<00:00, 59.66it/s, loss=3.0379, trans=0.0268, rot=0.3595, grad=100.70, nan=0]Epoch 15:  12%|█▏        | 6/51 [00:00<00:00, 59.66it/s, loss=2.8183, trans=0.0244, rot=0.3751, grad=51.94, nan=0] Epoch 15:  12%|█▏        | 6/51 [00:00<00:00, 59.66it/s, loss=3.1824, trans=0.0287, rot=0.3124, grad=80.62, nan=0]Epoch 15:  12%|█▏        | 6/51 [00:00<00:00, 59.66it/s, loss=3.4078, trans=0.0303, rot=0.3741, grad=80.52, nan=0]Epoch 15:  12%|█▏        | 6/51 [00:00<00:00, 59.66it/s, loss=3.9205, trans=0.0354, rot=0.3849, grad=129.03, nan=0]Epoch 15:  12%|█▏        | 6/51 [00:00<00:00, 59.66it/s, loss=2.6795, trans=0.0233, rot=0.3473, grad=68.20, nan=0] Epoch 15:  12%|█▏        | 6/51 [00:00<00:00, 59.66it/s, loss=3.0158, trans=0.0271, rot=0.3059, grad=69.06, nan=0]Epoch 15:  12%|█▏        | 6/51 [00:00<00:00, 59.66it/s, loss=3.2677, trans=0.0293, rot=0.3344, grad=72.01, nan=0]Epoch 15:  12%|█▏        | 6/51 [00:00<00:00, 59.66it/s, loss=3.3226, trans=0.0299, rot=0.3329, grad=65.85, nan=0]Epoch 15:  12%|█▏        | 6/51 [00:00<00:00, 59.66it/s, loss=3.6979, trans=0.0333, rot=0.3642, grad=106.97, nan=0]Epoch 15:  12%|█▏        | 6/51 [00:00<00:00, 59.66it/s, loss=3.4454, trans=0.0310, rot=0.3468, grad=53.60, nan=0] Epoch 15:  31%|███▏      | 16/51 [00:00<00:00, 79.31it/s, loss=3.4454, trans=0.0310, rot=0.3468, grad=53.60, nan=0]Epoch 15:  31%|███▏      | 16/51 [00:00<00:00, 79.31it/s, loss=3.1631, trans=0.0286, rot=0.3006, grad=70.97, nan=0]Epoch 15:  31%|███▏      | 16/51 [00:00<00:00, 79.31it/s, loss=3.0695, trans=0.0268, rot=0.3861, grad=70.50, nan=0]Epoch 15:  31%|███▏      | 16/51 [00:00<00:00, 79.31it/s, loss=3.1119, trans=0.0275, rot=0.3668, grad=76.22, nan=0]Epoch 15:  31%|███▏      | 16/51 [00:00<00:00, 79.31it/s, loss=3.7303, trans=0.0332, rot=0.4059, grad=65.10, nan=0]Epoch 15:  31%|███▏      | 16/51 [00:00<00:00, 79.31it/s, loss=3.4119, trans=0.0308, rot=0.3304, grad=56.65, nan=0]Epoch 15:  31%|███▏      | 16/51 [00:00<00:00, 79.31it/s, loss=3.4820, trans=0.0316, rot=0.3231, grad=54.89, nan=0]Epoch 15:  31%|███▏      | 16/51 [00:00<00:00, 79.31it/s, loss=2.9711, trans=0.0261, rot=0.3651, grad=74.97, nan=0]Epoch 15:  31%|███▏      | 16/51 [00:00<00:00, 79.31it/s, loss=2.8067, trans=0.0246, rot=0.3466, grad=65.05, nan=0]Epoch 15:  31%|███▏      | 16/51 [00:00<00:00, 79.31it/s, loss=4.0152, trans=0.0362, rot=0.3963, grad=89.52, nan=0]Epoch 15:  49%|████▉     | 25/51 [00:00<00:00, 81.42it/s, loss=4.0152, trans=0.0362, rot=0.3963, grad=89.52, nan=0]Epoch 15:  49%|████▉     | 25/51 [00:00<00:00, 81.42it/s, loss=3.2974, trans=0.0293, rot=0.3644, grad=77.33, nan=0]Epoch 15:  49%|████▉     | 25/51 [00:00<00:00, 81.42it/s, loss=3.6091, trans=0.0329, rot=0.3209, grad=66.18, nan=0]Epoch 15:  49%|████▉     | 25/51 [00:00<00:00, 81.42it/s, loss=3.1226, trans=0.0278, rot=0.3474, grad=62.61, nan=0]Epoch 15:  49%|████▉     | 25/51 [00:00<00:00, 81.42it/s, loss=3.0734, trans=0.0272, rot=0.3568, grad=63.38, nan=0]Epoch 15:  49%|████▉     | 25/51 [00:00<00:00, 81.42it/s, loss=2.8119, trans=0.0248, rot=0.3335, grad=79.82, nan=0]Epoch 15:  49%|████▉     | 25/51 [00:00<00:00, 81.42it/s, loss=2.9245, trans=0.0262, rot=0.3077, grad=63.29, nan=0]Epoch 15:  49%|████▉     | 25/51 [00:00<00:00, 81.42it/s, loss=2.5441, trans=0.0219, rot=0.3538, grad=39.36, nan=0]Epoch 15:  49%|████▉     | 25/51 [00:00<00:00, 81.42it/s, loss=3.2292, trans=0.0289, rot=0.3383, grad=78.38, nan=0]Epoch 15:  49%|████▉     | 25/51 [00:00<00:00, 81.42it/s, loss=3.1929, trans=0.0283, rot=0.3586, grad=54.25, nan=0]Epoch 15:  49%|████▉     | 25/51 [00:00<00:00, 81.42it/s, loss=2.7627, trans=0.0238, rot=0.3780, grad=61.92, nan=0]Epoch 15:  69%|██████▊   | 35/51 [00:00<00:00, 88.34it/s, loss=2.7627, trans=0.0238, rot=0.3780, grad=61.92, nan=0]Epoch 15:  69%|██████▊   | 35/51 [00:00<00:00, 88.34it/s, loss=2.3801, trans=0.0205, rot=0.3310, grad=54.38, nan=0]Epoch 15:  69%|██████▊   | 35/51 [00:00<00:00, 88.34it/s, loss=3.5095, trans=0.0316, rot=0.3489, grad=50.89, nan=0]Epoch 15:  69%|██████▊   | 35/51 [00:00<00:00, 88.34it/s, loss=3.5387, trans=0.0325, rot=0.2879, grad=59.06, nan=0]Epoch 15:  69%|██████▊   | 35/51 [00:00<00:00, 88.34it/s, loss=3.3620, trans=0.0299, rot=0.3765, grad=79.85, nan=0]Epoch 15:  69%|██████▊   | 35/51 [00:00<00:00, 88.34it/s, loss=2.9607, trans=0.0262, rot=0.3362, grad=73.06, nan=0]Epoch 15:  69%|██████▊   | 35/51 [00:00<00:00, 88.34it/s, loss=2.7849, trans=0.0247, rot=0.3181, grad=51.31, nan=0]Epoch 15:  69%|██████▊   | 35/51 [00:00<00:00, 88.34it/s, loss=3.6458, trans=0.0332, rot=0.3267, grad=60.95, nan=0]Epoch 15:  69%|██████▊   | 35/51 [00:00<00:00, 88.34it/s, loss=3.4068, trans=0.0309, rot=0.3215, grad=91.33, nan=0]Epoch 15:  69%|██████▊   | 35/51 [00:00<00:00, 88.34it/s, loss=4.3064, trans=0.0401, rot=0.2966, grad=74.14, nan=0]Epoch 15:  69%|██████▊   | 35/51 [00:00<00:00, 88.34it/s, loss=3.6339, trans=0.0328, rot=0.3493, grad=82.97, nan=0]Epoch 15:  69%|██████▊   | 35/51 [00:00<00:00, 88.34it/s, loss=3.0979, trans=0.0275, rot=0.3519, grad=66.55, nan=0]Epoch 15:  90%|█████████ | 46/51 [00:00<00:00, 92.83it/s, loss=3.0979, trans=0.0275, rot=0.3519, grad=66.55, nan=0]Epoch 15:  90%|█████████ | 46/51 [00:00<00:00, 92.83it/s, loss=2.9529, trans=0.0258, rot=0.3694, grad=42.15, nan=0]Epoch 15:  90%|█████████ | 46/51 [00:00<00:00, 92.83it/s, loss=3.7560, trans=0.0345, rot=0.3091, grad=77.77, nan=0]Epoch 15:  90%|█████████ | 46/51 [00:00<00:00, 92.83it/s, loss=3.4990, trans=0.0310, rot=0.3988, grad=72.80, nan=0]Epoch 15:  90%|█████████ | 46/51 [00:00<00:00, 92.83it/s, loss=3.6193, trans=0.0330, rot=0.3231, grad=59.78, nan=0]Epoch 15:  90%|█████████ | 46/51 [00:00<00:00, 92.83it/s, loss=2.1229, trans=0.0186, rot=0.2654, grad=142.09, nan=0]Epoch 15: 100%|██████████| 51/51 [00:00<00:00, 85.34it/s, loss=2.1229, trans=0.0186, rot=0.2654, grad=142.09, nan=0]
Visual features - mean: 0.000229, std: 0.984656
IMU features - mean: -0.003657, std: 1.122644
GT translations (m) - mean: 0.002097, std: 0.037056
GT quaternions - mean: 0.248448, std: 0.434075
Predicted pose window shape: (1, 7)
[[ 0.01523415 -0.18279105  0.4263027  -0.18130875  0.10184282 -0.0279469
  -0.9777393 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.17576517 -0.21853575  0.09850674  0.10498952  0.0143489   0.03797328
  -0.9936445 ]]
  Ground truth relative pose:
[[-2.1142868e-04 -1.3765299e-03 -2.6722690e-03  2.4022013e-03
   1.5991330e-03 -3.2781214e-03  9.9999046e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 184.65it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 167.20it/s]

Epoch 15 Summary:
  Train Loss: 3.261436
  Val Loss: 0.447290
  Val Trans Error: 0.1130 m
  Val Rot Error: 10.21 degrees
  ✓ New best model saved

============================================================
Epoch 16/50
Learning rate: 0.00000588
============================================================
Epoch 16:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 16:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.5633, trans=0.0227, rot=0.2919, grad=45.26, nan=0]Epoch 16:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.3168, trans=0.0296, rot=0.3546, grad=86.62, nan=0]Epoch 16:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.8389, trans=0.0247, rot=0.3708, grad=65.70, nan=0]Epoch 16:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.8689, trans=0.0253, rot=0.3382, grad=58.14, nan=0]Epoch 16:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.0412, trans=0.0274, rot=0.3022, grad=60.10, nan=0]Epoch 16:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.3198, trans=0.0301, rot=0.3103, grad=60.02, nan=0]Epoch 16:  12%|█▏        | 6/51 [00:00<00:00, 56.75it/s, loss=3.3198, trans=0.0301, rot=0.3103, grad=60.02, nan=0]Epoch 16:  12%|█▏        | 6/51 [00:00<00:00, 56.75it/s, loss=2.4161, trans=0.0207, rot=0.3507, grad=40.54, nan=0]Epoch 16:  12%|█▏        | 6/51 [00:00<00:00, 56.75it/s, loss=2.7522, trans=0.0245, rot=0.2995, grad=58.64, nan=0]Epoch 16:  12%|█▏        | 6/51 [00:00<00:00, 56.75it/s, loss=3.0478, trans=0.0272, rot=0.3296, grad=58.55, nan=0]Epoch 16:  12%|█▏        | 6/51 [00:00<00:00, 56.75it/s, loss=3.4905, trans=0.0319, rot=0.2997, grad=80.89, nan=0]Epoch 16:  12%|█▏        | 6/51 [00:00<00:00, 56.75it/s, loss=3.5084, trans=0.0316, rot=0.3496, grad=81.24, nan=0]Epoch 16:  12%|█▏        | 6/51 [00:00<00:00, 56.75it/s, loss=2.8805, trans=0.0256, rot=0.3155, grad=73.31, nan=0]Epoch 16:  12%|█▏        | 6/51 [00:00<00:00, 56.75it/s, loss=2.9823, trans=0.0269, rot=0.2880, grad=58.49, nan=0]Epoch 16:  12%|█▏        | 6/51 [00:00<00:00, 56.75it/s, loss=3.3217, trans=0.0298, rot=0.3444, grad=72.57, nan=0]Epoch 16:  12%|█▏        | 6/51 [00:00<00:00, 56.75it/s, loss=2.9777, trans=0.0263, rot=0.3453, grad=82.23, nan=0]Epoch 16:  12%|█▏        | 6/51 [00:00<00:00, 56.75it/s, loss=2.7138, trans=0.0237, rot=0.3441, grad=48.47, nan=0]Epoch 16:  31%|███▏      | 16/51 [00:00<00:00, 77.93it/s, loss=2.7138, trans=0.0237, rot=0.3441, grad=48.47, nan=0]Epoch 16:  31%|███▏      | 16/51 [00:00<00:00, 77.93it/s, loss=3.0122, trans=0.0268, rot=0.3317, grad=56.41, nan=0]Epoch 16:  31%|███▏      | 16/51 [00:00<00:00, 77.93it/s, loss=2.9901, trans=0.0266, rot=0.3286, grad=73.28, nan=0]Epoch 16:  31%|███▏      | 16/51 [00:00<00:00, 77.93it/s, loss=3.3966, trans=0.0309, rot=0.3077, grad=65.10, nan=0]Epoch 16:  31%|███▏      | 16/51 [00:00<00:00, 77.93it/s, loss=2.7734, trans=0.0244, rot=0.3348, grad=60.42, nan=0]Epoch 16:  31%|███▏      | 16/51 [00:00<00:00, 77.93it/s, loss=3.3442, trans=0.0297, rot=0.3731, grad=66.67, nan=0]Epoch 16:  31%|███▏      | 16/51 [00:00<00:00, 77.93it/s, loss=3.3244, trans=0.0297, rot=0.3503, grad=72.65, nan=0]Epoch 16:  31%|███▏      | 16/51 [00:00<00:00, 77.93it/s, loss=3.1067, trans=0.0279, rot=0.3123, grad=106.95, nan=0]Epoch 16:  31%|███▏      | 16/51 [00:00<00:00, 77.93it/s, loss=3.1453, trans=0.0279, rot=0.3512, grad=67.78, nan=0] Epoch 16:  47%|████▋     | 24/51 [00:00<00:00, 78.59it/s, loss=3.1453, trans=0.0279, rot=0.3512, grad=67.78, nan=0]Epoch 16:  47%|████▋     | 24/51 [00:00<00:00, 78.59it/s, loss=2.8947, trans=0.0259, rot=0.3090, grad=54.80, nan=0]Epoch 16:  47%|████▋     | 24/51 [00:00<00:00, 78.59it/s, loss=2.8480, trans=0.0251, rot=0.3403, grad=56.03, nan=0]Epoch 16:  47%|████▋     | 24/51 [00:00<00:00, 78.59it/s, loss=3.5605, trans=0.0321, rot=0.3486, grad=58.43, nan=0]Epoch 16:  47%|████▋     | 24/51 [00:00<00:00, 78.59it/s, loss=2.3881, trans=0.0202, rot=0.3725, grad=40.52, nan=0]Epoch 16:  47%|████▋     | 24/51 [00:00<00:00, 78.59it/s, loss=2.5711, trans=0.0231, rot=0.2611, grad=56.88, nan=0]Epoch 16:  47%|████▋     | 24/51 [00:00<00:00, 78.59it/s, loss=3.0368, trans=0.0266, rot=0.3743, grad=69.40, nan=0]Epoch 16:  47%|████▋     | 24/51 [00:00<00:00, 78.59it/s, loss=2.8203, trans=0.0253, rot=0.2938, grad=55.87, nan=0]Epoch 16:  47%|████▋     | 24/51 [00:00<00:00, 78.59it/s, loss=2.5635, trans=0.0222, rot=0.3458, grad=46.84, nan=0]Epoch 16:  47%|████▋     | 24/51 [00:00<00:00, 78.59it/s, loss=2.4620, trans=0.0212, rot=0.3447, grad=65.59, nan=0]Epoch 16:  65%|██████▍   | 33/51 [00:00<00:00, 82.91it/s, loss=2.4620, trans=0.0212, rot=0.3447, grad=65.59, nan=0]Epoch 16:  65%|██████▍   | 33/51 [00:00<00:00, 82.91it/s, loss=2.5061, trans=0.0214, rot=0.3700, grad=57.57, nan=0]Epoch 16:  65%|██████▍   | 33/51 [00:00<00:00, 82.91it/s, loss=2.2308, trans=0.0195, rot=0.2794, grad=59.46, nan=0]Epoch 16:  65%|██████▍   | 33/51 [00:00<00:00, 82.91it/s, loss=3.2533, trans=0.0289, rot=0.3603, grad=70.05, nan=0]Epoch 16:  65%|██████▍   | 33/51 [00:00<00:00, 82.91it/s, loss=3.0342, trans=0.0272, rot=0.3146, grad=45.53, nan=0]Epoch 16:  65%|██████▍   | 33/51 [00:00<00:00, 82.91it/s, loss=2.2361, trans=0.0191, rot=0.3300, grad=53.24, nan=0]Epoch 16:  65%|██████▍   | 33/51 [00:00<00:00, 82.91it/s, loss=2.1652, trans=0.0187, rot=0.2914, grad=52.32, nan=0]Epoch 16:  65%|██████▍   | 33/51 [00:00<00:00, 82.91it/s, loss=2.9245, trans=0.0260, rot=0.3199, grad=48.17, nan=0]Epoch 16:  65%|██████▍   | 33/51 [00:00<00:00, 82.91it/s, loss=2.5870, trans=0.0222, rot=0.3702, grad=41.42, nan=0]Epoch 16:  65%|██████▍   | 33/51 [00:00<00:00, 82.91it/s, loss=2.5685, trans=0.0226, rot=0.3108, grad=48.82, nan=0]Epoch 16:  82%|████████▏ | 42/51 [00:00<00:00, 85.01it/s, loss=2.5685, trans=0.0226, rot=0.3108, grad=48.82, nan=0]Epoch 16:  82%|████████▏ | 42/51 [00:00<00:00, 85.01it/s, loss=3.0768, trans=0.0272, rot=0.3523, grad=61.49, nan=0]Epoch 16:  82%|████████▏ | 42/51 [00:00<00:00, 85.01it/s, loss=3.4496, trans=0.0306, rot=0.3918, grad=62.12, nan=0]Epoch 16:  82%|████████▏ | 42/51 [00:00<00:00, 85.01it/s, loss=3.2823, trans=0.0291, rot=0.3728, grad=61.78, nan=0]Epoch 16:  82%|████████▏ | 42/51 [00:00<00:00, 85.01it/s, loss=3.2464, trans=0.0294, rot=0.3098, grad=83.10, nan=0]Epoch 16:  82%|████████▏ | 42/51 [00:00<00:00, 85.01it/s, loss=2.8427, trans=0.0250, rot=0.3476, grad=77.00, nan=0]Epoch 16:  82%|████████▏ | 42/51 [00:00<00:00, 85.01it/s, loss=1.9919, trans=0.0170, rot=0.2896, grad=53.26, nan=0]Epoch 16:  82%|████████▏ | 42/51 [00:00<00:00, 85.01it/s, loss=3.1719, trans=0.0283, rot=0.3373, grad=49.48, nan=0]Epoch 16:  82%|████████▏ | 42/51 [00:00<00:00, 85.01it/s, loss=3.0347, trans=0.0270, rot=0.3315, grad=63.29, nan=0]Epoch 16:  82%|████████▏ | 42/51 [00:00<00:00, 85.01it/s, loss=2.5673, trans=0.0222, rot=0.3440, grad=118.70, nan=0]Epoch 16: 100%|██████████| 51/51 [00:00<00:00, 81.35it/s, loss=2.5673, trans=0.0222, rot=0.3440, grad=118.70, nan=0]
Visual features - mean: 0.000925, std: 0.977791
IMU features - mean: -0.004276, std: 0.940942
GT translations (m) - mean: 0.001623, std: 0.035283
GT quaternions - mean: 0.248618, std: 0.433977
Predicted pose window shape: (1, 7)
[[-0.01630178  0.05726488  0.25720426 -0.08131486 -0.02714548  0.05614672
  -0.9947354 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.11774625 -0.10138676 -0.18451229 -0.01531971  0.00822273  0.07459927
  -0.997062  ]]
  Ground truth relative pose:
[[-1.2323195e-03 -7.2117904e-03 -7.4394047e-05  6.4022844e-03
  -2.2786157e-02 -1.9373061e-02  9.9953216e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 184.87it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 175.92it/s]

Epoch 16 Summary:
  Train Loss: 2.910726
  Val Loss: 0.409760
  Val Trans Error: 0.1101 m
  Val Rot Error: 9.40 degrees
  ✓ New best model saved

============================================================
Epoch 17/50
Learning rate: 0.00000588
============================================================
Epoch 17:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 17:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.8552, trans=0.0252, rot=0.3360, grad=50.20, nan=0]Epoch 17:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.9298, trans=0.0256, rot=0.3746, grad=66.71, nan=0]Epoch 17:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.6190, trans=0.0233, rot=0.2874, grad=85.65, nan=0]Epoch 17:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.6865, trans=0.0238, rot=0.3115, grad=56.71, nan=0]Epoch 17:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.7112, trans=0.0237, rot=0.3372, grad=75.82, nan=0]Epoch 17:  10%|▉         | 5/51 [00:00<00:00, 46.08it/s, loss=2.7112, trans=0.0237, rot=0.3372, grad=75.82, nan=0]Epoch 17:  10%|▉         | 5/51 [00:00<00:00, 46.08it/s, loss=2.4166, trans=0.0205, rot=0.3646, grad=57.53, nan=0]Epoch 17:  10%|▉         | 5/51 [00:00<00:00, 46.08it/s, loss=3.4103, trans=0.0312, rot=0.2862, grad=55.22, nan=0]Epoch 17:  10%|▉         | 5/51 [00:00<00:00, 46.08it/s, loss=2.8674, trans=0.0255, rot=0.3196, grad=66.93, nan=0]Epoch 17:  10%|▉         | 5/51 [00:00<00:00, 46.08it/s, loss=3.0214, trans=0.0268, rot=0.3456, grad=68.94, nan=0]Epoch 17:  10%|▉         | 5/51 [00:00<00:00, 46.08it/s, loss=2.9752, trans=0.0265, rot=0.3261, grad=49.68, nan=0]Epoch 17:  10%|▉         | 5/51 [00:00<00:00, 46.08it/s, loss=2.7394, trans=0.0244, rot=0.3013, grad=44.78, nan=0]Epoch 17:  10%|▉         | 5/51 [00:00<00:00, 46.08it/s, loss=2.7004, trans=0.0236, rot=0.3422, grad=46.41, nan=0]Epoch 17:  10%|▉         | 5/51 [00:00<00:00, 46.08it/s, loss=2.3774, trans=0.0206, rot=0.3167, grad=42.90, nan=0]Epoch 17:  10%|▉         | 5/51 [00:00<00:00, 46.08it/s, loss=2.5541, trans=0.0216, rot=0.3960, grad=81.16, nan=0]Epoch 17:  10%|▉         | 5/51 [00:00<00:00, 46.08it/s, loss=3.1367, trans=0.0284, rot=0.3013, grad=41.46, nan=0]Epoch 17:  29%|██▉       | 15/51 [00:00<00:00, 73.79it/s, loss=3.1367, trans=0.0284, rot=0.3013, grad=41.46, nan=0]Epoch 17:  29%|██▉       | 15/51 [00:00<00:00, 73.79it/s, loss=2.5663, trans=0.0222, rot=0.3444, grad=54.53, nan=0]Epoch 17:  29%|██▉       | 15/51 [00:00<00:00, 73.79it/s, loss=2.8512, trans=0.0252, rot=0.3325, grad=60.68, nan=0]Epoch 17:  29%|██▉       | 15/51 [00:00<00:00, 73.79it/s, loss=3.2768, trans=0.0294, rot=0.3388, grad=101.70, nan=0]Epoch 17:  29%|██▉       | 15/51 [00:00<00:00, 73.79it/s, loss=3.4238, trans=0.0305, rot=0.3731, grad=97.23, nan=0] Epoch 17:  29%|██▉       | 15/51 [00:00<00:00, 73.79it/s, loss=3.1016, trans=0.0279, rot=0.3127, grad=49.35, nan=0]Epoch 17:  29%|██▉       | 15/51 [00:00<00:00, 73.79it/s, loss=3.3989, trans=0.0304, rot=0.3601, grad=59.38, nan=0]Epoch 17:  29%|██▉       | 15/51 [00:00<00:00, 73.79it/s, loss=2.0814, trans=0.0180, rot=0.2800, grad=70.60, nan=0]Epoch 17:  29%|██▉       | 15/51 [00:00<00:00, 73.79it/s, loss=3.3335, trans=0.0298, rot=0.3542, grad=84.27, nan=0]Epoch 17:  45%|████▌     | 23/51 [00:00<00:00, 76.18it/s, loss=3.3335, trans=0.0298, rot=0.3542, grad=84.27, nan=0]Epoch 17:  45%|████▌     | 23/51 [00:00<00:00, 76.18it/s, loss=3.5389, trans=0.0322, rot=0.3192, grad=81.26, nan=0]Epoch 17:  45%|████▌     | 23/51 [00:00<00:00, 76.18it/s, loss=2.1802, trans=0.0185, rot=0.3263, grad=49.10, nan=0]Epoch 17:  45%|████▌     | 23/51 [00:00<00:00, 76.18it/s, loss=2.7908, trans=0.0252, rot=0.2731, grad=72.55, nan=0]Epoch 17:  45%|████▌     | 23/51 [00:00<00:00, 76.18it/s, loss=2.5026, trans=0.0217, rot=0.3295, grad=73.41, nan=0]Epoch 17:  45%|████▌     | 23/51 [00:00<00:00, 76.18it/s, loss=2.6402, trans=0.0229, rot=0.3455, grad=51.87, nan=0]Epoch 17:  45%|████▌     | 23/51 [00:00<00:00, 76.18it/s, loss=3.0985, trans=0.0278, rot=0.3155, grad=66.63, nan=0]Epoch 17:  45%|████▌     | 23/51 [00:00<00:00, 76.18it/s, loss=2.4580, trans=0.0212, rot=0.3337, grad=46.91, nan=0]Epoch 17:  45%|████▌     | 23/51 [00:00<00:00, 76.18it/s, loss=2.8566, trans=0.0253, rot=0.3224, grad=48.71, nan=0]Epoch 17:  45%|████▌     | 23/51 [00:00<00:00, 76.18it/s, loss=2.5650, trans=0.0220, rot=0.3634, grad=66.34, nan=0]Epoch 17:  45%|████▌     | 23/51 [00:00<00:00, 76.18it/s, loss=2.9081, trans=0.0260, rot=0.3119, grad=61.62, nan=0]Epoch 17:  65%|██████▍   | 33/51 [00:00<00:00, 81.53it/s, loss=2.9081, trans=0.0260, rot=0.3119, grad=61.62, nan=0]Epoch 17:  65%|██████▍   | 33/51 [00:00<00:00, 81.53it/s, loss=2.8079, trans=0.0251, rot=0.3017, grad=83.80, nan=0]Epoch 17:  65%|██████▍   | 33/51 [00:00<00:00, 81.53it/s, loss=2.3516, trans=0.0203, rot=0.3250, grad=37.92, nan=0]Epoch 17:  65%|██████▍   | 33/51 [00:00<00:00, 81.53it/s, loss=2.3686, trans=0.0208, rot=0.2914, grad=64.96, nan=0]Epoch 17:  65%|██████▍   | 33/51 [00:00<00:00, 81.53it/s, loss=2.8907, trans=0.0256, rot=0.3302, grad=42.24, nan=0]Epoch 17:  65%|██████▍   | 33/51 [00:00<00:00, 81.53it/s, loss=2.8130, trans=0.0249, rot=0.3204, grad=40.23, nan=0]Epoch 17:  65%|██████▍   | 33/51 [00:00<00:00, 81.53it/s, loss=3.1394, trans=0.0283, rot=0.3077, grad=45.93, nan=0]Epoch 17:  65%|██████▍   | 33/51 [00:00<00:00, 81.53it/s, loss=2.6456, trans=0.0232, rot=0.3273, grad=74.93, nan=0]Epoch 17:  65%|██████▍   | 33/51 [00:00<00:00, 81.53it/s, loss=3.6756, trans=0.0334, rot=0.3405, grad=50.57, nan=0]Epoch 17:  65%|██████▍   | 33/51 [00:00<00:00, 81.53it/s, loss=2.5850, trans=0.0228, rot=0.3002, grad=49.20, nan=0]Epoch 17:  82%|████████▏ | 42/51 [00:00<00:00, 78.19it/s, loss=2.5850, trans=0.0228, rot=0.3002, grad=49.20, nan=0]Epoch 17:  82%|████████▏ | 42/51 [00:00<00:00, 78.19it/s, loss=3.1950, trans=0.0286, rot=0.3304, grad=64.40, nan=0]Epoch 17:  82%|████████▏ | 42/51 [00:00<00:00, 78.19it/s, loss=2.5189, trans=0.0224, rot=0.2805, grad=59.48, nan=0]Epoch 17:  82%|████████▏ | 42/51 [00:00<00:00, 78.19it/s, loss=3.4788, trans=0.0314, rot=0.3391, grad=49.55, nan=0]Epoch 17:  82%|████████▏ | 42/51 [00:00<00:00, 78.19it/s, loss=2.3528, trans=0.0204, rot=0.3138, grad=50.66, nan=0]Epoch 17:  82%|████████▏ | 42/51 [00:00<00:00, 78.19it/s, loss=2.9473, trans=0.0263, rot=0.3187, grad=77.58, nan=0]Epoch 17:  82%|████████▏ | 42/51 [00:00<00:00, 78.19it/s, loss=2.0147, trans=0.0172, rot=0.2973, grad=71.15, nan=0]Epoch 17:  82%|████████▏ | 42/51 [00:00<00:00, 78.19it/s, loss=2.4973, trans=0.0219, rot=0.3104, grad=62.88, nan=0]Epoch 17:  82%|████████▏ | 42/51 [00:00<00:00, 78.19it/s, loss=2.8132, trans=0.0251, rot=0.3072, grad=48.64, nan=0]Epoch 17:  82%|████████▏ | 42/51 [00:00<00:00, 78.19it/s, loss=3.2506, trans=0.0293, rot=0.3192, grad=156.43, nan=0]Epoch 17: 100%|██████████| 51/51 [00:00<00:00, 80.22it/s, loss=3.2506, trans=0.0293, rot=0.3192, grad=156.43, nan=0]Epoch 17: 100%|██████████| 51/51 [00:00<00:00, 76.00it/s, loss=3.2506, trans=0.0293, rot=0.3192, grad=156.43, nan=0]
Visual features - mean: -0.000252, std: 1.069968
IMU features - mean: -0.000932, std: 0.985286
GT translations (m) - mean: -0.006156, std: 0.043523
GT quaternions - mean: 0.252207, std: 0.431900
Predicted pose window shape: (1, 7)
[[ 0.03396782  0.51256436 -0.4070395  -0.1139989  -0.04554644 -0.14341132
  -0.98201984]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.0772731  -0.03543257  0.15604253  0.12218935  0.06873722 -0.02937943
  -0.98968774]]
  Ground truth relative pose:
[[-9.36079537e-04 -2.48595420e-02 -1.23481285e-02  4.13345965e-03
  -1.24863116e-02 -1.69710082e-03  9.99912083e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  91%|█████████ | 20/22 [00:00<00:00, 195.28it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 173.96it/s]

Epoch 17 Summary:
  Train Loss: 2.821947
  Val Loss: 0.389147
  Val Trans Error: 0.1090 m
  Val Rot Error: 8.83 degrees
  ✓ New best model saved

============================================================
Epoch 18/50
Learning rate: 0.00000588
============================================================
Epoch 18:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 18:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.0385, trans=0.0275, rot=0.2849, grad=76.70, nan=0]Epoch 18:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.1606, trans=0.0185, rot=0.3071, grad=46.60, nan=0]Epoch 18:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.8383, trans=0.0255, rot=0.2895, grad=55.21, nan=0]Epoch 18:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.9237, trans=0.0262, rot=0.3086, grad=59.77, nan=0]Epoch 18:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.5286, trans=0.0224, rot=0.2906, grad=60.81, nan=0]Epoch 18:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.1628, trans=0.0187, rot=0.2956, grad=51.75, nan=0]Epoch 18:  12%|█▏        | 6/51 [00:00<00:00, 56.44it/s, loss=2.1628, trans=0.0187, rot=0.2956, grad=51.75, nan=0]Epoch 18:  12%|█▏        | 6/51 [00:00<00:00, 56.44it/s, loss=2.6331, trans=0.0232, rot=0.3144, grad=71.31, nan=0]Epoch 18:  12%|█▏        | 6/51 [00:00<00:00, 56.44it/s, loss=2.5352, trans=0.0218, rot=0.3515, grad=58.30, nan=0]Epoch 18:  12%|█▏        | 6/51 [00:00<00:00, 56.44it/s, loss=2.6897, trans=0.0234, rot=0.3512, grad=63.72, nan=0]Epoch 18:  12%|█▏        | 6/51 [00:00<00:00, 56.44it/s, loss=2.7717, trans=0.0247, rot=0.2995, grad=82.29, nan=0]Epoch 18:  12%|█▏        | 6/51 [00:00<00:00, 56.44it/s, loss=2.6840, trans=0.0233, rot=0.3509, grad=49.76, nan=0]Epoch 18:  12%|█▏        | 6/51 [00:00<00:00, 56.44it/s, loss=2.8100, trans=0.0249, rot=0.3241, grad=56.87, nan=0]Epoch 18:  12%|█▏        | 6/51 [00:00<00:00, 56.44it/s, loss=2.6148, trans=0.0231, rot=0.3042, grad=54.53, nan=0]Epoch 18:  12%|█▏        | 6/51 [00:00<00:00, 56.44it/s, loss=2.5475, trans=0.0225, rot=0.2974, grad=56.68, nan=0]Epoch 18:  12%|█▏        | 6/51 [00:00<00:00, 56.44it/s, loss=2.9356, trans=0.0264, rot=0.2970, grad=47.62, nan=0]Epoch 18:  29%|██▉       | 15/51 [00:00<00:00, 71.69it/s, loss=2.9356, trans=0.0264, rot=0.2970, grad=47.62, nan=0]Epoch 18:  29%|██▉       | 15/51 [00:00<00:00, 71.69it/s, loss=2.2981, trans=0.0196, rot=0.3361, grad=60.79, nan=0]Epoch 18:  29%|██▉       | 15/51 [00:00<00:00, 71.69it/s, loss=2.6522, trans=0.0236, rot=0.2923, grad=89.81, nan=0]Epoch 18:  29%|██▉       | 15/51 [00:00<00:00, 71.69it/s, loss=2.8947, trans=0.0260, rot=0.2923, grad=63.84, nan=0]Epoch 18:  29%|██▉       | 15/51 [00:00<00:00, 71.69it/s, loss=2.7048, trans=0.0239, rot=0.3110, grad=59.52, nan=0]Epoch 18:  29%|██▉       | 15/51 [00:00<00:00, 71.69it/s, loss=3.1721, trans=0.0280, rot=0.3767, grad=58.83, nan=0]Epoch 18:  29%|██▉       | 15/51 [00:00<00:00, 71.69it/s, loss=2.7536, trans=0.0250, rot=0.2500, grad=86.97, nan=0]Epoch 18:  29%|██▉       | 15/51 [00:00<00:00, 71.69it/s, loss=2.2984, trans=0.0199, rot=0.3085, grad=66.70, nan=0]Epoch 18:  29%|██▉       | 15/51 [00:00<00:00, 71.69it/s, loss=2.4556, trans=0.0212, rot=0.3355, grad=65.79, nan=0]Epoch 18:  29%|██▉       | 15/51 [00:00<00:00, 71.69it/s, loss=2.3063, trans=0.0194, rot=0.3653, grad=40.50, nan=0]Epoch 18:  29%|██▉       | 15/51 [00:00<00:00, 71.69it/s, loss=2.3953, trans=0.0208, rot=0.3181, grad=49.85, nan=0]Epoch 18:  49%|████▉     | 25/51 [00:00<00:00, 82.29it/s, loss=2.3953, trans=0.0208, rot=0.3181, grad=49.85, nan=0]Epoch 18:  49%|████▉     | 25/51 [00:00<00:00, 82.29it/s, loss=1.9506, trans=0.0164, rot=0.3152, grad=39.77, nan=0]Epoch 18:  49%|████▉     | 25/51 [00:00<00:00, 82.29it/s, loss=3.2874, trans=0.0302, rot=0.2663, grad=53.86, nan=0]Epoch 18:  49%|████▉     | 25/51 [00:00<00:00, 82.29it/s, loss=2.3689, trans=0.0207, rot=0.2993, grad=54.96, nan=0]Epoch 18:  49%|████▉     | 25/51 [00:00<00:00, 82.29it/s, loss=2.1831, trans=0.0180, rot=0.3809, grad=41.18, nan=0]Epoch 18:  49%|████▉     | 25/51 [00:00<00:00, 82.29it/s, loss=2.1957, trans=0.0187, rot=0.3254, grad=43.71, nan=0]Epoch 18:  49%|████▉     | 25/51 [00:00<00:00, 82.29it/s, loss=2.2369, trans=0.0194, rot=0.2975, grad=53.61, nan=0]Epoch 18:  49%|████▉     | 25/51 [00:00<00:00, 82.29it/s, loss=2.4243, trans=0.0215, rot=0.2708, grad=66.68, nan=0]Epoch 18:  49%|████▉     | 25/51 [00:00<00:00, 82.29it/s, loss=2.5074, trans=0.0217, rot=0.3348, grad=37.17, nan=0]Epoch 18:  49%|████▉     | 25/51 [00:00<00:00, 82.29it/s, loss=2.3696, trans=0.0205, rot=0.3173, grad=47.77, nan=0]Epoch 18:  67%|██████▋   | 34/51 [00:00<00:00, 80.38it/s, loss=2.3696, trans=0.0205, rot=0.3173, grad=47.77, nan=0]Epoch 18:  67%|██████▋   | 34/51 [00:00<00:00, 80.38it/s, loss=2.3516, trans=0.0203, rot=0.3235, grad=62.64, nan=0]Epoch 18:  67%|██████▋   | 34/51 [00:00<00:00, 80.38it/s, loss=2.5697, trans=0.0229, rot=0.2835, grad=54.20, nan=0]Epoch 18:  67%|██████▋   | 34/51 [00:00<00:00, 80.38it/s, loss=1.9323, trans=0.0164, rot=0.2906, grad=63.21, nan=0]Epoch 18:  67%|██████▋   | 34/51 [00:00<00:00, 80.38it/s, loss=2.5430, trans=0.0221, rot=0.3354, grad=70.49, nan=0]Epoch 18:  67%|██████▋   | 34/51 [00:00<00:00, 80.38it/s, loss=2.5795, trans=0.0226, rot=0.3239, grad=61.18, nan=0]Epoch 18:  67%|██████▋   | 34/51 [00:00<00:00, 80.38it/s, loss=2.8394, trans=0.0250, rot=0.3400, grad=61.41, nan=0]Epoch 18:  67%|██████▋   | 34/51 [00:00<00:00, 80.38it/s, loss=3.2372, trans=0.0291, rot=0.3277, grad=66.96, nan=0]Epoch 18:  67%|██████▋   | 34/51 [00:00<00:00, 80.38it/s, loss=2.1644, trans=0.0182, rot=0.3403, grad=55.38, nan=0]Epoch 18:  67%|██████▋   | 34/51 [00:00<00:00, 80.38it/s, loss=3.3626, trans=0.0305, rot=0.3139, grad=58.91, nan=0]Epoch 18:  84%|████████▍ | 43/51 [00:00<00:00, 82.67it/s, loss=3.3626, trans=0.0305, rot=0.3139, grad=58.91, nan=0]Epoch 18:  84%|████████▍ | 43/51 [00:00<00:00, 82.67it/s, loss=2.0839, trans=0.0181, rot=0.2722, grad=48.58, nan=0]Epoch 18:  84%|████████▍ | 43/51 [00:00<00:00, 82.67it/s, loss=2.6225, trans=0.0236, rot=0.2596, grad=49.28, nan=0]Epoch 18:  84%|████████▍ | 43/51 [00:00<00:00, 82.67it/s, loss=2.7335, trans=0.0238, rot=0.3508, grad=91.56, nan=0]Epoch 18:  84%|████████▍ | 43/51 [00:00<00:00, 82.67it/s, loss=2.4857, trans=0.0215, rot=0.3341, grad=60.64, nan=0]Epoch 18:  84%|████████▍ | 43/51 [00:00<00:00, 82.67it/s, loss=2.3346, trans=0.0200, rot=0.3323, grad=61.01, nan=0]Epoch 18:  84%|████████▍ | 43/51 [00:00<00:00, 82.67it/s, loss=3.0966, trans=0.0278, rot=0.3205, grad=59.91, nan=0]Epoch 18:  84%|████████▍ | 43/51 [00:00<00:00, 82.67it/s, loss=2.4792, trans=0.0213, rot=0.3448, grad=60.88, nan=0]Epoch 18:  84%|████████▍ | 43/51 [00:00<00:00, 82.67it/s, loss=1.8238, trans=0.0150, rot=0.3219, grad=72.71, nan=0]Epoch 18: 100%|██████████| 51/51 [00:00<00:00, 80.23it/s, loss=1.8238, trans=0.0150, rot=0.3219, grad=72.71, nan=0]
Visual features - mean: -0.000745, std: 0.900316
IMU features - mean: 0.001995, std: 0.891288
GT translations (m) - mean: -0.000163, std: 0.025179
GT quaternions - mean: 0.248979, std: 0.433770
Predicted pose window shape: (1, 7)
[[-0.04625168 -0.28351402 -0.12472158  0.02881883  0.0740169  -0.06349608
  -0.99481624]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.00677537 -0.37486553  0.32195747 -0.07340718 -0.18308021 -0.04652918
  -0.9792487 ]]
  Ground truth relative pose:
[[ 8.4642152e-04 -1.1401437e-03 -1.5693842e-03 -3.1795193e-02
   3.7298801e-03 -5.4367338e-03  9.9947268e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  91%|█████████ | 20/22 [00:00<00:00, 193.84it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 182.48it/s]

Epoch 18 Summary:
  Train Loss: 2.560164
  Val Loss: 0.351685
  Val Trans Error: 0.0995 m
  Val Rot Error: 8.16 degrees
  ✓ New best model saved

============================================================
Epoch 19/50
Learning rate: 0.00000588
============================================================
Epoch 19:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 19:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.1871, trans=0.0190, rot=0.2891, grad=47.19, nan=0]Epoch 19:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.6659, trans=0.0240, rot=0.2650, grad=59.76, nan=0]Epoch 19:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.7022, trans=0.0241, rot=0.2924, grad=64.33, nan=0]Epoch 19:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.5128, trans=0.0218, rot=0.3287, grad=87.29, nan=0]Epoch 19:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.4398, trans=0.0212, rot=0.3235, grad=84.46, nan=0]Epoch 19:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.5801, trans=0.0225, rot=0.3334, grad=63.10, nan=0]Epoch 19:  12%|█▏        | 6/51 [00:00<00:00, 57.06it/s, loss=2.5801, trans=0.0225, rot=0.3334, grad=63.10, nan=0]Epoch 19:  12%|█▏        | 6/51 [00:00<00:00, 57.06it/s, loss=2.1790, trans=0.0185, rot=0.3299, grad=32.37, nan=0]Epoch 19:  12%|█▏        | 6/51 [00:00<00:00, 57.06it/s, loss=3.1319, trans=0.0282, rot=0.3100, grad=76.31, nan=0]Epoch 19:  12%|█▏        | 6/51 [00:00<00:00, 57.06it/s, loss=2.1031, trans=0.0178, rot=0.3219, grad=69.80, nan=0]Epoch 19:  12%|█▏        | 6/51 [00:00<00:00, 57.06it/s, loss=2.5534, trans=0.0223, rot=0.3230, grad=59.78, nan=0]Epoch 19:  12%|█▏        | 6/51 [00:00<00:00, 57.06it/s, loss=2.2062, trans=0.0188, rot=0.3285, grad=40.04, nan=0]Epoch 19:  12%|█▏        | 6/51 [00:00<00:00, 57.06it/s, loss=2.8077, trans=0.0251, rot=0.3001, grad=54.24, nan=0]Epoch 19:  12%|█▏        | 6/51 [00:00<00:00, 57.06it/s, loss=2.9462, trans=0.0267, rot=0.2804, grad=40.22, nan=0]Epoch 19:  12%|█▏        | 6/51 [00:00<00:00, 57.06it/s, loss=2.7963, trans=0.0252, rot=0.2806, grad=59.28, nan=0]Epoch 19:  12%|█▏        | 6/51 [00:00<00:00, 57.06it/s, loss=2.5919, trans=0.0232, rot=0.2715, grad=72.09, nan=0]Epoch 19:  12%|█▏        | 6/51 [00:00<00:00, 57.06it/s, loss=2.1213, trans=0.0185, rot=0.2754, grad=47.33, nan=0]Epoch 19:  31%|███▏      | 16/51 [00:00<00:00, 79.35it/s, loss=2.1213, trans=0.0185, rot=0.2754, grad=47.33, nan=0]Epoch 19:  31%|███▏      | 16/51 [00:00<00:00, 79.35it/s, loss=2.1475, trans=0.0183, rot=0.3206, grad=47.26, nan=0]Epoch 19:  31%|███▏      | 16/51 [00:00<00:00, 79.35it/s, loss=3.3856, trans=0.0302, rot=0.3683, grad=54.22, nan=0]Epoch 19:  31%|███▏      | 16/51 [00:00<00:00, 79.35it/s, loss=2.1099, trans=0.0178, rot=0.3254, grad=36.97, nan=0]Epoch 19:  31%|███▏      | 16/51 [00:00<00:00, 79.35it/s, loss=3.5592, trans=0.0327, rot=0.2905, grad=65.38, nan=0]Epoch 19:  31%|███▏      | 16/51 [00:00<00:00, 79.35it/s, loss=2.3785, trans=0.0211, rot=0.2714, grad=37.32, nan=0]Epoch 19:  31%|███▏      | 16/51 [00:00<00:00, 79.35it/s, loss=2.3744, trans=0.0204, rot=0.3316, grad=41.57, nan=0]Epoch 19:  31%|███▏      | 16/51 [00:00<00:00, 79.35it/s, loss=2.8520, trans=0.0250, rot=0.3546, grad=64.96, nan=0]Epoch 19:  31%|███▏      | 16/51 [00:00<00:00, 79.35it/s, loss=2.4350, trans=0.0219, rot=0.2468, grad=50.77, nan=0]Epoch 19:  31%|███▏      | 16/51 [00:00<00:00, 79.35it/s, loss=1.9043, trans=0.0166, rot=0.2436, grad=42.11, nan=0]Epoch 19:  31%|███▏      | 16/51 [00:00<00:00, 79.35it/s, loss=3.2339, trans=0.0286, rot=0.3709, grad=78.13, nan=0]Epoch 19:  51%|█████     | 26/51 [00:00<00:00, 88.08it/s, loss=3.2339, trans=0.0286, rot=0.3709, grad=78.13, nan=0]Epoch 19:  51%|█████     | 26/51 [00:00<00:00, 88.08it/s, loss=2.3478, trans=0.0204, rot=0.3091, grad=77.96, nan=0]Epoch 19:  51%|█████     | 26/51 [00:00<00:00, 88.08it/s, loss=2.8662, trans=0.0255, rot=0.3181, grad=77.96, nan=0]Epoch 19:  51%|█████     | 26/51 [00:00<00:00, 88.08it/s, loss=2.5144, trans=0.0220, rot=0.3154, grad=61.47, nan=0]Epoch 19:  51%|█████     | 26/51 [00:00<00:00, 88.08it/s, loss=2.6036, trans=0.0230, rot=0.3005, grad=51.09, nan=0]Epoch 19:  51%|█████     | 26/51 [00:00<00:00, 88.08it/s, loss=2.4763, trans=0.0221, rot=0.2698, grad=51.11, nan=0]Epoch 19:  51%|█████     | 26/51 [00:00<00:00, 88.08it/s, loss=2.4041, trans=0.0209, rot=0.3189, grad=52.52, nan=0]Epoch 19:  51%|█████     | 26/51 [00:00<00:00, 88.08it/s, loss=2.4311, trans=0.0213, rot=0.3031, grad=48.31, nan=0]Epoch 19:  51%|█████     | 26/51 [00:00<00:00, 88.08it/s, loss=2.9422, trans=0.0264, rot=0.2984, grad=70.54, nan=0]Epoch 19:  51%|█████     | 26/51 [00:00<00:00, 88.08it/s, loss=1.7406, trans=0.0149, rot=0.2532, grad=32.71, nan=0]Epoch 19:  51%|█████     | 26/51 [00:00<00:00, 88.08it/s, loss=2.0847, trans=0.0175, rot=0.3350, grad=50.19, nan=0]Epoch 19:  71%|███████   | 36/51 [00:00<00:00, 91.05it/s, loss=2.0847, trans=0.0175, rot=0.3350, grad=50.19, nan=0]Epoch 19:  71%|███████   | 36/51 [00:00<00:00, 91.05it/s, loss=2.6914, trans=0.0237, rot=0.3180, grad=77.95, nan=0]Epoch 19:  71%|███████   | 36/51 [00:00<00:00, 91.05it/s, loss=3.0447, trans=0.0278, rot=0.2647, grad=58.08, nan=0]Epoch 19:  71%|███████   | 36/51 [00:00<00:00, 91.05it/s, loss=2.3219, trans=0.0203, rot=0.2926, grad=49.52, nan=0]Epoch 19:  71%|███████   | 36/51 [00:00<00:00, 91.05it/s, loss=2.7030, trans=0.0241, rot=0.2904, grad=71.30, nan=0]Epoch 19:  71%|███████   | 36/51 [00:00<00:00, 91.05it/s, loss=2.1584, trans=0.0186, rot=0.2951, grad=35.29, nan=0]Epoch 19:  71%|███████   | 36/51 [00:00<00:00, 91.05it/s, loss=2.7334, trans=0.0240, rot=0.3319, grad=58.06, nan=0]Epoch 19:  71%|███████   | 36/51 [00:00<00:00, 91.05it/s, loss=2.0995, trans=0.0181, rot=0.2941, grad=65.14, nan=0]Epoch 19:  71%|███████   | 36/51 [00:00<00:00, 91.05it/s, loss=2.3474, trans=0.0206, rot=0.2909, grad=66.78, nan=0]Epoch 19:  71%|███████   | 36/51 [00:00<00:00, 91.05it/s, loss=2.3860, trans=0.0207, rot=0.3158, grad=55.27, nan=0]Epoch 19:  71%|███████   | 36/51 [00:00<00:00, 91.05it/s, loss=2.3144, trans=0.0199, rot=0.3294, grad=56.37, nan=0]Epoch 19:  90%|█████████ | 46/51 [00:00<00:00, 87.78it/s, loss=2.3144, trans=0.0199, rot=0.3294, grad=56.37, nan=0]Epoch 19:  90%|█████████ | 46/51 [00:00<00:00, 87.78it/s, loss=2.2093, trans=0.0191, rot=0.3019, grad=35.23, nan=0]Epoch 19:  90%|█████████ | 46/51 [00:00<00:00, 87.78it/s, loss=2.8066, trans=0.0251, rot=0.2971, grad=50.48, nan=0]Epoch 19:  90%|█████████ | 46/51 [00:00<00:00, 87.78it/s, loss=2.4321, trans=0.0213, rot=0.3020, grad=65.04, nan=0]Epoch 19:  90%|█████████ | 46/51 [00:00<00:00, 87.78it/s, loss=2.1563, trans=0.0190, rot=0.2600, grad=45.85, nan=0]Epoch 19:  90%|█████████ | 46/51 [00:00<00:00, 87.78it/s, loss=3.1817, trans=0.0284, rot=0.3405, grad=109.48, nan=0]Epoch 19: 100%|██████████| 51/51 [00:00<00:00, 83.85it/s, loss=3.1817, trans=0.0284, rot=0.3405, grad=109.48, nan=0]
Visual features - mean: 0.004238, std: 1.057341
IMU features - mean: 0.001787, std: 0.831723
GT translations (m) - mean: 0.001270, std: 0.042524
GT quaternions - mean: 0.252206, std: 0.431900
Predicted pose window shape: (1, 7)
[[-0.25244075  0.03152946 -0.00740416  0.07355327  0.02833513  0.00771049
  -0.9968589 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.11682092 -0.14081185 -0.5865567  -0.0212668  -0.15595482 -0.12148029
  -0.9800349 ]]
  Ground truth relative pose:
[[-6.2936719e-04  4.1086666e-04 -3.1595986e-04  2.0264538e-03
  -2.9549303e-03 -3.8833919e-04  9.9999350e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 185.05it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 177.84it/s]

Epoch 19 Summary:
  Train Loss: 2.527497
  Val Loss: 0.296810
  Val Trans Error: 0.0908 m
  Val Rot Error: 7.72 degrees
  ✓ New best model saved

============================================================
Epoch 20/50
Learning rate: 0.00000588
============================================================
Epoch 20:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 20:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.3877, trans=0.0206, rot=0.3268, grad=45.05, nan=0]Epoch 20:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.1919, trans=0.0193, rot=0.2662, grad=45.42, nan=0]Epoch 20:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.3859, trans=0.0209, rot=0.2979, grad=42.29, nan=0]Epoch 20:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.3462, trans=0.0207, rot=0.2762, grad=37.76, nan=0]Epoch 20:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.3214, trans=0.0203, rot=0.2886, grad=47.13, nan=0]Epoch 20:   0%|          | 0/51 [00:00<?, ?it/s, loss=3.2395, trans=0.0292, rot=0.3176, grad=86.70, nan=0]Epoch 20:  12%|█▏        | 6/51 [00:00<00:00, 58.79it/s, loss=3.2395, trans=0.0292, rot=0.3176, grad=86.70, nan=0]Epoch 20:  12%|█▏        | 6/51 [00:00<00:00, 58.79it/s, loss=2.5398, trans=0.0221, rot=0.3283, grad=34.87, nan=0]Epoch 20:  12%|█▏        | 6/51 [00:00<00:00, 58.79it/s, loss=2.1244, trans=0.0181, rot=0.3165, grad=42.22, nan=0]Epoch 20:  12%|█▏        | 6/51 [00:00<00:00, 58.79it/s, loss=2.2341, trans=0.0194, rot=0.2951, grad=48.86, nan=0]Epoch 20:  12%|█▏        | 6/51 [00:00<00:00, 58.79it/s, loss=2.1965, trans=0.0191, rot=0.2891, grad=43.05, nan=0]Epoch 20:  12%|█▏        | 6/51 [00:00<00:00, 58.79it/s, loss=2.3521, trans=0.0206, rot=0.2963, grad=54.04, nan=0]Epoch 20:  12%|█▏        | 6/51 [00:00<00:00, 58.79it/s, loss=2.4167, trans=0.0211, rot=0.3076, grad=51.45, nan=0]Epoch 20:  12%|█▏        | 6/51 [00:00<00:00, 58.79it/s, loss=2.1307, trans=0.0181, rot=0.3174, grad=49.38, nan=0]Epoch 20:  12%|█▏        | 6/51 [00:00<00:00, 58.79it/s, loss=2.1730, trans=0.0186, rot=0.3105, grad=68.96, nan=0]Epoch 20:  12%|█▏        | 6/51 [00:00<00:00, 58.79it/s, loss=2.7211, trans=0.0243, rot=0.2887, grad=46.53, nan=0]Epoch 20:  12%|█▏        | 6/51 [00:00<00:00, 58.79it/s, loss=2.5283, trans=0.0225, rot=0.2803, grad=53.28, nan=0]Epoch 20:  31%|███▏      | 16/51 [00:00<00:00, 79.60it/s, loss=2.5283, trans=0.0225, rot=0.2803, grad=53.28, nan=0]Epoch 20:  31%|███▏      | 16/51 [00:00<00:00, 79.60it/s, loss=1.8953, trans=0.0158, rot=0.3127, grad=35.87, nan=0]Epoch 20:  31%|███▏      | 16/51 [00:00<00:00, 79.60it/s, loss=2.0917, trans=0.0180, rot=0.2886, grad=42.80, nan=0]Epoch 20:  31%|███▏      | 16/51 [00:00<00:00, 79.60it/s, loss=1.7342, trans=0.0149, rot=0.2490, grad=27.67, nan=0]Epoch 20:  31%|███▏      | 16/51 [00:00<00:00, 79.60it/s, loss=2.0610, trans=0.0178, rot=0.2780, grad=43.71, nan=0]Epoch 20:  31%|███▏      | 16/51 [00:00<00:00, 79.60it/s, loss=2.7481, trans=0.0247, rot=0.2807, grad=45.94, nan=0]Epoch 20:  31%|███▏      | 16/51 [00:00<00:00, 79.60it/s, loss=2.4570, trans=0.0213, rot=0.3239, grad=54.31, nan=0]Epoch 20:  31%|███▏      | 16/51 [00:00<00:00, 79.60it/s, loss=1.9186, trans=0.0162, rot=0.2966, grad=41.12, nan=0]Epoch 20:  31%|███▏      | 16/51 [00:00<00:00, 79.60it/s, loss=3.0504, trans=0.0274, rot=0.3140, grad=62.01, nan=0]Epoch 20:  31%|███▏      | 16/51 [00:00<00:00, 79.60it/s, loss=2.5870, trans=0.0231, rot=0.2744, grad=51.10, nan=0]Epoch 20:  31%|███▏      | 16/51 [00:00<00:00, 79.60it/s, loss=2.9582, trans=0.0263, rot=0.3265, grad=57.00, nan=0]Epoch 20:  51%|█████     | 26/51 [00:00<00:00, 87.07it/s, loss=2.9582, trans=0.0263, rot=0.3265, grad=57.00, nan=0]Epoch 20:  51%|█████     | 26/51 [00:00<00:00, 87.07it/s, loss=1.8780, trans=0.0159, rot=0.2927, grad=56.34, nan=0]Epoch 20:  51%|█████     | 26/51 [00:00<00:00, 87.07it/s, loss=2.5164, trans=0.0227, rot=0.2477, grad=36.38, nan=0]Epoch 20:  51%|█████     | 26/51 [00:00<00:00, 87.07it/s, loss=2.3462, trans=0.0203, rot=0.3119, grad=44.91, nan=0]Epoch 20:  51%|█████     | 26/51 [00:00<00:00, 87.07it/s, loss=2.5873, trans=0.0229, rot=0.2999, grad=46.60, nan=0]Epoch 20:  51%|█████     | 26/51 [00:00<00:00, 87.07it/s, loss=2.5720, trans=0.0227, rot=0.2991, grad=62.17, nan=0]Epoch 20:  51%|█████     | 26/51 [00:00<00:00, 87.07it/s, loss=2.1896, trans=0.0187, rot=0.3192, grad=58.81, nan=0]Epoch 20:  51%|█████     | 26/51 [00:00<00:00, 87.07it/s, loss=2.7244, trans=0.0244, rot=0.2803, grad=56.35, nan=0]Epoch 20:  51%|█████     | 26/51 [00:00<00:00, 87.07it/s, loss=2.2849, trans=0.0199, rot=0.2912, grad=49.44, nan=0]Epoch 20:  51%|█████     | 26/51 [00:00<00:00, 87.07it/s, loss=2.0029, trans=0.0170, rot=0.3034, grad=48.92, nan=0]Epoch 20:  51%|█████     | 26/51 [00:00<00:00, 87.07it/s, loss=2.3720, trans=0.0207, rot=0.2980, grad=79.98, nan=0]Epoch 20:  71%|███████   | 36/51 [00:00<00:00, 91.52it/s, loss=2.3720, trans=0.0207, rot=0.2980, grad=79.98, nan=0]Epoch 20:  71%|███████   | 36/51 [00:00<00:00, 91.52it/s, loss=2.4631, trans=0.0217, rot=0.2946, grad=46.61, nan=0]Epoch 20:  71%|███████   | 36/51 [00:00<00:00, 91.52it/s, loss=1.7567, trans=0.0143, rot=0.3294, grad=38.34, nan=0]Epoch 20:  71%|███████   | 36/51 [00:00<00:00, 91.52it/s, loss=2.2083, trans=0.0188, rot=0.3298, grad=48.77, nan=0]Epoch 20:  71%|███████   | 36/51 [00:00<00:00, 91.52it/s, loss=2.6594, trans=0.0235, rot=0.3061, grad=56.31, nan=0]Epoch 20:  71%|███████   | 36/51 [00:00<00:00, 91.52it/s, loss=2.8900, trans=0.0255, rot=0.3429, grad=62.04, nan=0]Epoch 20:  71%|███████   | 36/51 [00:00<00:00, 91.52it/s, loss=1.9689, trans=0.0167, rot=0.3034, grad=37.06, nan=0]Epoch 20:  71%|███████   | 36/51 [00:00<00:00, 91.52it/s, loss=2.2570, trans=0.0198, rot=0.2814, grad=43.31, nan=0]Epoch 20:  71%|███████   | 36/51 [00:00<00:00, 91.52it/s, loss=2.1358, trans=0.0188, rot=0.2588, grad=56.02, nan=0]Epoch 20:  71%|███████   | 36/51 [00:00<00:00, 91.52it/s, loss=1.7989, trans=0.0154, rot=0.2624, grad=43.51, nan=0]Epoch 20:  71%|███████   | 36/51 [00:00<00:00, 91.52it/s, loss=2.4519, trans=0.0214, rot=0.3092, grad=61.31, nan=0]Epoch 20:  90%|█████████ | 46/51 [00:00<00:00, 93.73it/s, loss=2.4519, trans=0.0214, rot=0.3092, grad=61.31, nan=0]Epoch 20:  90%|█████████ | 46/51 [00:00<00:00, 93.73it/s, loss=2.1011, trans=0.0181, rot=0.2908, grad=30.48, nan=0]Epoch 20:  90%|█████████ | 46/51 [00:00<00:00, 93.73it/s, loss=2.6610, trans=0.0235, rot=0.3156, grad=74.81, nan=0]Epoch 20:  90%|█████████ | 46/51 [00:00<00:00, 93.73it/s, loss=2.2348, trans=0.0194, rot=0.2924, grad=50.83, nan=0]Epoch 20:  90%|█████████ | 46/51 [00:00<00:00, 93.73it/s, loss=1.5870, trans=0.0133, rot=0.2582, grad=34.59, nan=0]Epoch 20:  90%|█████████ | 46/51 [00:00<00:00, 93.73it/s, loss=1.5678, trans=0.0135, rot=0.2212, grad=58.68, nan=0]Epoch 20: 100%|██████████| 51/51 [00:00<00:00, 86.93it/s, loss=1.5678, trans=0.0135, rot=0.2212, grad=58.68, nan=0]
Visual features - mean: 0.008321, std: 1.033657
IMU features - mean: -0.011705, std: 1.202125
GT translations (m) - mean: -0.001243, std: 0.025897
GT quaternions - mean: 0.250741, std: 0.432753
Predicted pose window shape: (1, 7)
[[-0.26633304 -0.21325365  0.09793522  0.12907027 -0.0117103   0.02396323
  -0.9912767 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.02505504  0.0805365   0.15478541 -0.01254445  0.06784035 -0.06687695
  -0.99537325]]
  Ground truth relative pose:
[[ 1.0470286e-02  5.6590792e-03 -8.9055672e-04 -1.0227539e-01
  -3.1915501e-02 -5.6805164e-02  9.9261993e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  77%|███████▋  | 17/22 [00:00<00:00, 169.20it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 166.41it/s]

Epoch 20 Summary:
  Train Loss: 2.313847
  Val Loss: 0.288858
  Val Trans Error: 0.0925 m
  Val Rot Error: 7.36 degrees
  ✓ New best model saved

============================================================
Epoch 21/50
Learning rate: 0.00000588
============================================================
Epoch 21:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 21:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.2275, trans=0.0192, rot=0.3120, grad=36.93, nan=0]Epoch 21:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.2345, trans=0.0195, rot=0.2852, grad=53.69, nan=0]Epoch 21:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.3501, trans=0.0204, rot=0.3105, grad=39.67, nan=0]Epoch 21:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.0384, trans=0.0172, rot=0.3192, grad=59.52, nan=0]Epoch 21:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.0863, trans=0.0181, rot=0.2779, grad=43.32, nan=0]Epoch 21:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.2070, trans=0.0195, rot=0.2588, grad=75.51, nan=0]Epoch 21:  12%|█▏        | 6/51 [00:00<00:00, 59.28it/s, loss=2.2070, trans=0.0195, rot=0.2588, grad=75.51, nan=0]Epoch 21:  12%|█▏        | 6/51 [00:00<00:00, 59.28it/s, loss=1.6217, trans=0.0136, rot=0.2570, grad=38.60, nan=0]Epoch 21:  12%|█▏        | 6/51 [00:00<00:00, 59.28it/s, loss=2.2593, trans=0.0194, rot=0.3195, grad=51.30, nan=0]Epoch 21:  12%|█▏        | 6/51 [00:00<00:00, 59.28it/s, loss=2.1854, trans=0.0188, rot=0.3013, grad=45.81, nan=0]Epoch 21:  12%|█▏        | 6/51 [00:00<00:00, 59.28it/s, loss=2.3554, trans=0.0203, rot=0.3301, grad=57.87, nan=0]Epoch 21:  12%|█▏        | 6/51 [00:00<00:00, 59.28it/s, loss=1.8690, trans=0.0155, rot=0.3200, grad=32.89, nan=0]Epoch 21:  12%|█▏        | 6/51 [00:00<00:00, 59.28it/s, loss=2.1714, trans=0.0188, rot=0.2889, grad=40.53, nan=0]Epoch 21:  12%|█▏        | 6/51 [00:00<00:00, 59.28it/s, loss=2.3204, trans=0.0197, rot=0.3500, grad=36.87, nan=0]Epoch 21:  12%|█▏        | 6/51 [00:00<00:00, 59.28it/s, loss=2.0320, trans=0.0174, rot=0.2935, grad=39.33, nan=0]Epoch 21:  12%|█▏        | 6/51 [00:00<00:00, 59.28it/s, loss=2.2598, trans=0.0199, rot=0.2663, grad=44.15, nan=0]Epoch 21:  12%|█▏        | 6/51 [00:00<00:00, 59.28it/s, loss=2.0542, trans=0.0174, rot=0.3170, grad=42.38, nan=0]Epoch 21:  31%|███▏      | 16/51 [00:00<00:00, 79.75it/s, loss=2.0542, trans=0.0174, rot=0.3170, grad=42.38, nan=0]Epoch 21:  31%|███▏      | 16/51 [00:00<00:00, 79.75it/s, loss=2.1782, trans=0.0191, rot=0.2704, grad=41.20, nan=0]Epoch 21:  31%|███▏      | 16/51 [00:00<00:00, 79.75it/s, loss=1.8683, trans=0.0162, rot=0.2491, grad=45.77, nan=0]Epoch 21:  31%|███▏      | 16/51 [00:00<00:00, 79.75it/s, loss=2.7252, trans=0.0246, rot=0.2685, grad=45.38, nan=0]Epoch 21:  31%|███▏      | 16/51 [00:00<00:00, 79.75it/s, loss=2.3384, trans=0.0210, rot=0.2398, grad=49.77, nan=0]Epoch 21:  31%|███▏      | 16/51 [00:00<00:00, 79.75it/s, loss=1.9543, trans=0.0167, rot=0.2882, grad=28.60, nan=0]Epoch 21:  31%|███▏      | 16/51 [00:00<00:00, 79.75it/s, loss=2.2456, trans=0.0191, rot=0.3327, grad=38.48, nan=0]Epoch 21:  31%|███▏      | 16/51 [00:00<00:00, 79.75it/s, loss=2.2002, trans=0.0192, rot=0.2821, grad=39.82, nan=0]Epoch 21:  31%|███▏      | 16/51 [00:00<00:00, 79.75it/s, loss=2.0796, trans=0.0182, rot=0.2639, grad=43.65, nan=0]Epoch 21:  31%|███▏      | 16/51 [00:00<00:00, 79.75it/s, loss=2.1680, trans=0.0186, rot=0.3061, grad=43.87, nan=0]Epoch 21:  31%|███▏      | 16/51 [00:00<00:00, 79.75it/s, loss=2.1353, trans=0.0179, rot=0.3454, grad=46.90, nan=0]Epoch 21:  51%|█████     | 26/51 [00:00<00:00, 87.17it/s, loss=2.1353, trans=0.0179, rot=0.3454, grad=46.90, nan=0]Epoch 21:  51%|█████     | 26/51 [00:00<00:00, 87.17it/s, loss=2.3490, trans=0.0202, rot=0.3326, grad=54.30, nan=0]Epoch 21:  51%|█████     | 26/51 [00:00<00:00, 87.17it/s, loss=2.2014, trans=0.0193, rot=0.2718, grad=68.68, nan=0]Epoch 21:  51%|█████     | 26/51 [00:00<00:00, 87.17it/s, loss=2.2599, trans=0.0193, rot=0.3338, grad=34.20, nan=0]Epoch 21:  51%|█████     | 26/51 [00:00<00:00, 87.17it/s, loss=2.6280, trans=0.0232, rot=0.3032, grad=43.48, nan=0]Epoch 21:  51%|█████     | 26/51 [00:00<00:00, 87.17it/s, loss=1.6864, trans=0.0143, rot=0.2525, grad=36.99, nan=0]Epoch 21:  51%|█████     | 26/51 [00:00<00:00, 87.17it/s, loss=1.8375, trans=0.0157, rot=0.2723, grad=41.08, nan=0]Epoch 21:  51%|█████     | 26/51 [00:00<00:00, 87.17it/s, loss=2.3851, trans=0.0206, rot=0.3244, grad=66.64, nan=0]Epoch 21:  51%|█████     | 26/51 [00:00<00:00, 87.17it/s, loss=2.3911, trans=0.0209, rot=0.2977, grad=67.17, nan=0]Epoch 21:  51%|█████     | 26/51 [00:00<00:00, 87.17it/s, loss=2.1974, trans=0.0190, rot=0.3007, grad=71.02, nan=0]Epoch 21:  51%|█████     | 26/51 [00:00<00:00, 87.17it/s, loss=1.6777, trans=0.0140, rot=0.2807, grad=63.99, nan=0]Epoch 21:  51%|█████     | 26/51 [00:00<00:00, 87.17it/s, loss=2.1421, trans=0.0186, rot=0.2817, grad=37.33, nan=0]Epoch 21:  73%|███████▎  | 37/51 [00:00<00:00, 92.76it/s, loss=2.1421, trans=0.0186, rot=0.2817, grad=37.33, nan=0]Epoch 21:  73%|███████▎  | 37/51 [00:00<00:00, 92.76it/s, loss=2.0659, trans=0.0184, rot=0.2238, grad=33.06, nan=0]Epoch 21:  73%|███████▎  | 37/51 [00:00<00:00, 92.76it/s, loss=1.9269, trans=0.0164, rot=0.2846, grad=58.49, nan=0]Epoch 21:  73%|███████▎  | 37/51 [00:00<00:00, 92.76it/s, loss=2.4930, trans=0.0223, rot=0.2611, grad=39.47, nan=0]Epoch 21:  73%|███████▎  | 37/51 [00:00<00:00, 92.76it/s, loss=2.2431, trans=0.0199, rot=0.2504, grad=41.86, nan=0]Epoch 21:  73%|███████▎  | 37/51 [00:00<00:00, 92.76it/s, loss=2.6937, trans=0.0242, rot=0.2701, grad=65.54, nan=0]Epoch 21:  73%|███████▎  | 37/51 [00:00<00:00, 92.76it/s, loss=2.6351, trans=0.0227, rot=0.3604, grad=62.00, nan=0]Epoch 21:  73%|███████▎  | 37/51 [00:00<00:00, 92.76it/s, loss=2.3835, trans=0.0206, rot=0.3204, grad=92.58, nan=0]Epoch 21:  73%|███████▎  | 37/51 [00:00<00:00, 92.76it/s, loss=2.3578, trans=0.0211, rot=0.2446, grad=80.19, nan=0]Epoch 21:  73%|███████▎  | 37/51 [00:00<00:00, 92.76it/s, loss=1.5286, trans=0.0124, rot=0.2906, grad=38.33, nan=0]Epoch 21:  73%|███████▎  | 37/51 [00:00<00:00, 92.76it/s, loss=2.5104, trans=0.0219, rot=0.3205, grad=88.12, nan=0]Epoch 21:  92%|█████████▏| 47/51 [00:00<00:00, 92.26it/s, loss=2.5104, trans=0.0219, rot=0.3205, grad=88.12, nan=0]Epoch 21:  92%|█████████▏| 47/51 [00:00<00:00, 92.26it/s, loss=2.1279, trans=0.0182, rot=0.3125, grad=48.98, nan=0]Epoch 21:  92%|█████████▏| 47/51 [00:00<00:00, 92.26it/s, loss=2.4919, trans=0.0219, rot=0.3001, grad=72.38, nan=0]Epoch 21:  92%|█████████▏| 47/51 [00:00<00:00, 92.26it/s, loss=1.8817, trans=0.0157, rot=0.3145, grad=34.00, nan=0]Epoch 21:  92%|█████████▏| 47/51 [00:00<00:00, 92.26it/s, loss=2.2524, trans=0.0183, rot=0.4272, grad=90.11, nan=0]Epoch 21: 100%|██████████| 51/51 [00:00<00:00, 87.79it/s, loss=2.2524, trans=0.0183, rot=0.4272, grad=90.11, nan=0]
Visual features - mean: 0.000218, std: 0.993934
IMU features - mean: 0.001446, std: 0.984960
GT translations (m) - mean: 0.005014, std: 0.041106
GT quaternions - mean: 0.247506, std: 0.434613
Predicted pose window shape: (1, 7)
[[-0.26561844  0.15888777 -0.2514789   0.05098353 -0.01795904 -0.08764603
  -0.994684  ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.41104293  0.2589959  -0.03173662 -0.13063635  0.20301804 -0.1784642
  -0.95387024]]
  Ground truth relative pose:
[[-0.0148468   0.00755819 -0.00792421 -0.01236197  0.01209624 -0.01041453
   0.9997962 ]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 186.59it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 179.60it/s]

Epoch 21 Summary:
  Train Loss: 2.186533
  Val Loss: 0.272461
  Val Trans Error: 0.0867 m
  Val Rot Error: 7.01 degrees
  ✓ New best model saved

============================================================
Epoch 22/50
Learning rate: 0.00000588
============================================================
Epoch 22:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 22:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.1979, trans=0.0195, rot=0.2500, grad=43.03, nan=0]Epoch 22:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.7439, trans=0.0141, rot=0.3322, grad=28.30, nan=0]Epoch 22:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.5275, trans=0.0226, rot=0.2690, grad=50.33, nan=0]Epoch 22:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.2016, trans=0.0189, rot=0.3080, grad=76.63, nan=0]Epoch 22:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.2564, trans=0.0193, rot=0.3220, grad=68.28, nan=0]Epoch 22:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.4843, trans=0.0223, rot=0.2592, grad=68.55, nan=0]Epoch 22:  12%|█▏        | 6/51 [00:00<00:00, 56.21it/s, loss=2.4843, trans=0.0223, rot=0.2592, grad=68.55, nan=0]Epoch 22:  12%|█▏        | 6/51 [00:00<00:00, 56.21it/s, loss=2.3324, trans=0.0205, rot=0.2873, grad=63.48, nan=0]Epoch 22:  12%|█▏        | 6/51 [00:00<00:00, 56.21it/s, loss=2.2833, trans=0.0196, rot=0.3252, grad=46.71, nan=0]Epoch 22:  12%|█▏        | 6/51 [00:00<00:00, 56.21it/s, loss=2.7882, trans=0.0245, rot=0.3355, grad=36.62, nan=0]Epoch 22:  12%|█▏        | 6/51 [00:00<00:00, 56.21it/s, loss=2.0914, trans=0.0179, rot=0.3046, grad=49.97, nan=0]Epoch 22:  12%|█▏        | 6/51 [00:00<00:00, 56.21it/s, loss=2.3881, trans=0.0212, rot=0.2694, grad=71.52, nan=0]Epoch 22:  12%|█▏        | 6/51 [00:00<00:00, 56.21it/s, loss=2.3507, trans=0.0206, rot=0.2916, grad=40.48, nan=0]Epoch 22:  12%|█▏        | 6/51 [00:00<00:00, 56.21it/s, loss=2.3960, trans=0.0211, rot=0.2897, grad=46.94, nan=0]Epoch 22:  12%|█▏        | 6/51 [00:00<00:00, 56.21it/s, loss=1.8448, trans=0.0155, rot=0.2927, grad=36.95, nan=0]Epoch 22:  12%|█▏        | 6/51 [00:00<00:00, 56.21it/s, loss=2.1127, trans=0.0180, rot=0.3133, grad=45.53, nan=0]Epoch 22:  12%|█▏        | 6/51 [00:00<00:00, 56.21it/s, loss=2.2449, trans=0.0195, rot=0.2954, grad=61.84, nan=0]Epoch 22:  31%|███▏      | 16/51 [00:00<00:00, 78.29it/s, loss=2.2449, trans=0.0195, rot=0.2954, grad=61.84, nan=0]Epoch 22:  31%|███▏      | 16/51 [00:00<00:00, 78.29it/s, loss=2.0104, trans=0.0176, rot=0.2533, grad=47.42, nan=0]Epoch 22:  31%|███▏      | 16/51 [00:00<00:00, 78.29it/s, loss=2.5751, trans=0.0229, rot=0.2883, grad=53.64, nan=0]Epoch 22:  31%|███▏      | 16/51 [00:00<00:00, 78.29it/s, loss=1.5219, trans=0.0123, rot=0.2899, grad=43.18, nan=0]Epoch 22:  31%|███▏      | 16/51 [00:00<00:00, 78.29it/s, loss=1.7913, trans=0.0149, rot=0.3037, grad=46.03, nan=0]Epoch 22:  31%|███▏      | 16/51 [00:00<00:00, 78.29it/s, loss=2.0324, trans=0.0176, rot=0.2771, grad=44.25, nan=0]Epoch 22:  31%|███▏      | 16/51 [00:00<00:00, 78.29it/s, loss=2.1380, trans=0.0180, rot=0.3344, grad=38.22, nan=0]Epoch 22:  31%|███▏      | 16/51 [00:00<00:00, 78.29it/s, loss=2.0150, trans=0.0175, rot=0.2621, grad=38.86, nan=0]Epoch 22:  31%|███▏      | 16/51 [00:00<00:00, 78.29it/s, loss=1.8663, trans=0.0156, rot=0.3055, grad=35.05, nan=0]Epoch 22:  31%|███▏      | 16/51 [00:00<00:00, 78.29it/s, loss=2.1922, trans=0.0192, rot=0.2715, grad=56.43, nan=0]Epoch 22:  31%|███▏      | 16/51 [00:00<00:00, 78.29it/s, loss=1.8188, trans=0.0152, rot=0.2945, grad=38.62, nan=0]Epoch 22:  51%|█████     | 26/51 [00:00<00:00, 84.76it/s, loss=1.8188, trans=0.0152, rot=0.2945, grad=38.62, nan=0]Epoch 22:  51%|█████     | 26/51 [00:00<00:00, 84.76it/s, loss=2.3472, trans=0.0208, rot=0.2629, grad=47.53, nan=0]Epoch 22:  51%|█████     | 26/51 [00:00<00:00, 84.76it/s, loss=1.9292, trans=0.0171, rot=0.2236, grad=67.16, nan=0]Epoch 22:  51%|█████     | 26/51 [00:00<00:00, 84.76it/s, loss=1.8289, trans=0.0158, rot=0.2453, grad=54.26, nan=0]Epoch 22:  51%|█████     | 26/51 [00:00<00:00, 84.76it/s, loss=1.8688, trans=0.0158, rot=0.2838, grad=50.01, nan=0]Epoch 22:  51%|█████     | 26/51 [00:00<00:00, 84.76it/s, loss=1.8756, trans=0.0155, rot=0.3288, grad=40.41, nan=0]Epoch 22:  51%|█████     | 26/51 [00:00<00:00, 84.76it/s, loss=2.2411, trans=0.0197, rot=0.2696, grad=77.90, nan=0]Epoch 22:  51%|█████     | 26/51 [00:00<00:00, 84.76it/s, loss=2.1684, trans=0.0188, rot=0.2866, grad=61.26, nan=0]Epoch 22:  51%|█████     | 26/51 [00:00<00:00, 84.76it/s, loss=1.7169, trans=0.0143, rot=0.2875, grad=31.22, nan=0]Epoch 22:  51%|█████     | 26/51 [00:00<00:00, 84.76it/s, loss=2.6366, trans=0.0236, rot=0.2784, grad=37.05, nan=0]Epoch 22:  51%|█████     | 26/51 [00:00<00:00, 84.76it/s, loss=2.1061, trans=0.0183, rot=0.2806, grad=46.09, nan=0]Epoch 22:  71%|███████   | 36/51 [00:00<00:00, 89.16it/s, loss=2.1061, trans=0.0183, rot=0.2806, grad=46.09, nan=0]Epoch 22:  71%|███████   | 36/51 [00:00<00:00, 89.16it/s, loss=1.7926, trans=0.0152, rot=0.2754, grad=43.11, nan=0]Epoch 22:  71%|███████   | 36/51 [00:00<00:00, 89.16it/s, loss=1.7031, trans=0.0144, rot=0.2581, grad=31.79, nan=0]Epoch 22:  71%|███████   | 36/51 [00:00<00:00, 89.16it/s, loss=1.8381, trans=0.0155, rot=0.2901, grad=26.59, nan=0]Epoch 22:  71%|███████   | 36/51 [00:00<00:00, 89.16it/s, loss=1.9066, trans=0.0161, rot=0.2923, grad=31.91, nan=0]Epoch 22:  71%|███████   | 36/51 [00:00<00:00, 89.16it/s, loss=1.6581, trans=0.0139, rot=0.2704, grad=31.56, nan=0]Epoch 22:  71%|███████   | 36/51 [00:00<00:00, 89.16it/s, loss=2.3393, trans=0.0203, rot=0.3077, grad=65.97, nan=0]Epoch 22:  71%|███████   | 36/51 [00:00<00:00, 89.16it/s, loss=2.2507, trans=0.0193, rot=0.3205, grad=71.83, nan=0]Epoch 22:  71%|███████   | 36/51 [00:00<00:00, 89.16it/s, loss=1.9856, trans=0.0170, rot=0.2827, grad=56.82, nan=0]Epoch 22:  71%|███████   | 36/51 [00:00<00:00, 89.16it/s, loss=2.0457, trans=0.0176, rot=0.2815, grad=58.99, nan=0]Epoch 22:  71%|███████   | 36/51 [00:00<00:00, 89.16it/s, loss=2.3918, trans=0.0212, rot=0.2672, grad=75.01, nan=0]Epoch 22:  90%|█████████ | 46/51 [00:00<00:00, 91.66it/s, loss=2.3918, trans=0.0212, rot=0.2672, grad=75.01, nan=0]Epoch 22:  90%|█████████ | 46/51 [00:00<00:00, 91.66it/s, loss=2.0694, trans=0.0176, rot=0.3065, grad=41.12, nan=0]Epoch 22:  90%|█████████ | 46/51 [00:00<00:00, 91.66it/s, loss=2.0074, trans=0.0169, rot=0.3213, grad=42.71, nan=0]Epoch 22:  90%|█████████ | 46/51 [00:00<00:00, 91.66it/s, loss=2.4227, trans=0.0213, rot=0.2970, grad=48.51, nan=0]Epoch 22:  90%|█████████ | 46/51 [00:00<00:00, 91.66it/s, loss=1.7912, trans=0.0154, rot=0.2527, grad=31.61, nan=0]Epoch 22:  90%|█████████ | 46/51 [00:00<00:00, 91.66it/s, loss=1.5621, trans=0.0127, rot=0.2898, grad=86.34, nan=0]Epoch 22: 100%|██████████| 51/51 [00:00<00:00, 86.50it/s, loss=1.5621, trans=0.0127, rot=0.2898, grad=86.34, nan=0]
Visual features - mean: 0.000260, std: 1.014754
IMU features - mean: 0.000336, std: 0.899580
GT translations (m) - mean: -0.001564, std: 0.044928
GT quaternions - mean: 0.249721, std: 0.433343
Predicted pose window shape: (1, 7)
[[-1.4100513e-01  1.9135782e-01  1.0711889e-01 -7.0092484e-04
  -8.9091152e-02 -8.6651713e-02 -9.9224687e-01]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.16673405 -0.07002893 -0.22299832  0.0097177  -0.08682641 -0.01026303
  -0.9961232 ]]
  Ground truth relative pose:
[[-1.0571148e-03 -3.1730831e-03  3.5017403e-04  2.7671156e-03
  -1.7181260e-03  4.1183676e-03  9.9998623e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  82%|████████▏ | 18/22 [00:00<00:00, 175.52it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 172.83it/s]

Epoch 22 Summary:
  Train Loss: 2.091930
  Val Loss: 0.241476
  Val Trans Error: 0.0815 m
  Val Rot Error: 6.66 degrees
  ✓ New best model saved

============================================================
Epoch 23/50
Learning rate: 0.00000588
============================================================
Epoch 23:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 23:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.5363, trans=0.0126, rot=0.2795, grad=47.01, nan=0]Epoch 23:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.3836, trans=0.0208, rot=0.3063, grad=58.64, nan=0]Epoch 23:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.7172, trans=0.0146, rot=0.2596, grad=42.19, nan=0]Epoch 23:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.3152, trans=0.0198, rot=0.3322, grad=39.12, nan=0]Epoch 23:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.2130, trans=0.0196, rot=0.2513, grad=49.88, nan=0]Epoch 23:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.9985, trans=0.0171, rot=0.2863, grad=35.28, nan=0]Epoch 23:  12%|█▏        | 6/51 [00:00<00:00, 58.65it/s, loss=1.9985, trans=0.0171, rot=0.2863, grad=35.28, nan=0]Epoch 23:  12%|█▏        | 6/51 [00:00<00:00, 58.65it/s, loss=1.6377, trans=0.0135, rot=0.2883, grad=38.35, nan=0]Epoch 23:  12%|█▏        | 6/51 [00:00<00:00, 58.65it/s, loss=2.0587, trans=0.0176, rot=0.3010, grad=38.44, nan=0]Epoch 23:  12%|█▏        | 6/51 [00:00<00:00, 58.65it/s, loss=2.1591, trans=0.0188, rot=0.2825, grad=74.01, nan=0]Epoch 23:  12%|█▏        | 6/51 [00:00<00:00, 58.65it/s, loss=1.9245, trans=0.0162, rot=0.3065, grad=44.27, nan=0]Epoch 23:  12%|█▏        | 6/51 [00:00<00:00, 58.65it/s, loss=2.4947, trans=0.0221, rot=0.2858, grad=72.48, nan=0]Epoch 23:  12%|█▏        | 6/51 [00:00<00:00, 58.65it/s, loss=2.4767, trans=0.0217, rot=0.3064, grad=92.13, nan=0]Epoch 23:  12%|█▏        | 6/51 [00:00<00:00, 58.65it/s, loss=1.8627, trans=0.0159, rot=0.2739, grad=44.32, nan=0]Epoch 23:  12%|█▏        | 6/51 [00:00<00:00, 58.65it/s, loss=1.9786, trans=0.0167, rot=0.3081, grad=44.10, nan=0]Epoch 23:  12%|█▏        | 6/51 [00:00<00:00, 58.65it/s, loss=1.8030, trans=0.0155, rot=0.2542, grad=49.95, nan=0]Epoch 23:  29%|██▉       | 15/51 [00:00<00:00, 74.86it/s, loss=1.8030, trans=0.0155, rot=0.2542, grad=49.95, nan=0]Epoch 23:  29%|██▉       | 15/51 [00:00<00:00, 74.86it/s, loss=1.9672, trans=0.0167, rot=0.2989, grad=44.28, nan=0]Epoch 23:  29%|██▉       | 15/51 [00:00<00:00, 74.86it/s, loss=2.5392, trans=0.0221, rot=0.3298, grad=57.03, nan=0]Epoch 23:  29%|██▉       | 15/51 [00:00<00:00, 74.86it/s, loss=2.1701, trans=0.0191, rot=0.2632, grad=42.89, nan=0]Epoch 23:  29%|██▉       | 15/51 [00:00<00:00, 74.86it/s, loss=1.8311, trans=0.0154, rot=0.2911, grad=52.61, nan=0]Epoch 23:  29%|██▉       | 15/51 [00:00<00:00, 74.86it/s, loss=2.4483, trans=0.0210, rot=0.3455, grad=47.62, nan=0]Epoch 23:  29%|██▉       | 15/51 [00:00<00:00, 74.86it/s, loss=1.9346, trans=0.0165, rot=0.2798, grad=38.85, nan=0]Epoch 23:  29%|██▉       | 15/51 [00:00<00:00, 74.86it/s, loss=2.0800, trans=0.0180, rot=0.2776, grad=47.95, nan=0]Epoch 23:  29%|██▉       | 15/51 [00:00<00:00, 74.86it/s, loss=1.4938, trans=0.0126, rot=0.2382, grad=54.03, nan=0]Epoch 23:  29%|██▉       | 15/51 [00:00<00:00, 74.86it/s, loss=2.0868, trans=0.0181, rot=0.2813, grad=36.79, nan=0]Epoch 23:  29%|██▉       | 15/51 [00:00<00:00, 74.86it/s, loss=2.1979, trans=0.0189, rot=0.3086, grad=43.17, nan=0]Epoch 23:  49%|████▉     | 25/51 [00:00<00:00, 82.53it/s, loss=2.1979, trans=0.0189, rot=0.3086, grad=43.17, nan=0]Epoch 23:  49%|████▉     | 25/51 [00:00<00:00, 82.53it/s, loss=2.3545, trans=0.0206, rot=0.2915, grad=70.98, nan=0]Epoch 23:  49%|████▉     | 25/51 [00:00<00:00, 82.53it/s, loss=1.7729, trans=0.0152, rot=0.2524, grad=25.42, nan=0]Epoch 23:  49%|████▉     | 25/51 [00:00<00:00, 82.53it/s, loss=1.3766, trans=0.0113, rot=0.2471, grad=27.22, nan=0]Epoch 23:  49%|████▉     | 25/51 [00:00<00:00, 82.53it/s, loss=1.9663, trans=0.0170, rot=0.2646, grad=45.22, nan=0]Epoch 23:  49%|████▉     | 25/51 [00:00<00:00, 82.53it/s, loss=1.9861, trans=0.0170, rot=0.2829, grad=49.85, nan=0]Epoch 23:  49%|████▉     | 25/51 [00:00<00:00, 82.53it/s, loss=1.9998, trans=0.0177, rot=0.2285, grad=51.74, nan=0]Epoch 23:  49%|████▉     | 25/51 [00:00<00:00, 82.53it/s, loss=1.7874, trans=0.0150, rot=0.2859, grad=36.10, nan=0]Epoch 23:  49%|████▉     | 25/51 [00:00<00:00, 82.53it/s, loss=1.9483, trans=0.0160, rot=0.3441, grad=34.38, nan=0]Epoch 23:  49%|████▉     | 25/51 [00:00<00:00, 82.53it/s, loss=1.6727, trans=0.0136, rot=0.3078, grad=55.62, nan=0]Epoch 23:  49%|████▉     | 25/51 [00:00<00:00, 82.53it/s, loss=1.9541, trans=0.0163, rot=0.3235, grad=28.53, nan=0]Epoch 23:  69%|██████▊   | 35/51 [00:00<00:00, 88.61it/s, loss=1.9541, trans=0.0163, rot=0.3235, grad=28.53, nan=0]Epoch 23:  69%|██████▊   | 35/51 [00:00<00:00, 88.61it/s, loss=2.1960, trans=0.0191, rot=0.2835, grad=52.94, nan=0]Epoch 23:  69%|██████▊   | 35/51 [00:00<00:00, 88.61it/s, loss=1.7321, trans=0.0141, rot=0.3174, grad=67.03, nan=0]Epoch 23:  69%|██████▊   | 35/51 [00:00<00:00, 88.61it/s, loss=1.8208, trans=0.0157, rot=0.2530, grad=33.13, nan=0]Epoch 23:  69%|██████▊   | 35/51 [00:00<00:00, 88.61it/s, loss=2.0891, trans=0.0184, rot=0.2519, grad=54.09, nan=0]Epoch 23:  69%|██████▊   | 35/51 [00:00<00:00, 88.61it/s, loss=2.4885, trans=0.0219, rot=0.2977, grad=55.19, nan=0]Epoch 23:  69%|██████▊   | 35/51 [00:00<00:00, 88.61it/s, loss=1.9490, trans=0.0166, rot=0.2928, grad=60.56, nan=0]Epoch 23:  69%|██████▊   | 35/51 [00:00<00:00, 88.61it/s, loss=2.2374, trans=0.0200, rot=0.2363, grad=54.91, nan=0]Epoch 23:  69%|██████▊   | 35/51 [00:00<00:00, 88.61it/s, loss=2.2781, trans=0.0200, rot=0.2812, grad=50.98, nan=0]Epoch 23:  69%|██████▊   | 35/51 [00:00<00:00, 88.61it/s, loss=1.6138, trans=0.0136, rot=0.2514, grad=27.33, nan=0]Epoch 23:  69%|██████▊   | 35/51 [00:00<00:00, 88.61it/s, loss=1.8622, trans=0.0160, rot=0.2634, grad=28.62, nan=0]Epoch 23:  69%|██████▊   | 35/51 [00:00<00:00, 88.61it/s, loss=2.2092, trans=0.0196, rot=0.2492, grad=41.51, nan=0]Epoch 23:  90%|█████████ | 46/51 [00:00<00:00, 93.35it/s, loss=2.2092, trans=0.0196, rot=0.2492, grad=41.51, nan=0]Epoch 23:  90%|█████████ | 46/51 [00:00<00:00, 93.35it/s, loss=1.8649, trans=0.0157, rot=0.2922, grad=54.73, nan=0]Epoch 23:  90%|█████████ | 46/51 [00:00<00:00, 93.35it/s, loss=1.8367, trans=0.0153, rot=0.3085, grad=29.73, nan=0]Epoch 23:  90%|█████████ | 46/51 [00:00<00:00, 93.35it/s, loss=2.1159, trans=0.0182, rot=0.2976, grad=56.64, nan=0]Epoch 23:  90%|█████████ | 46/51 [00:00<00:00, 93.35it/s, loss=1.8897, trans=0.0152, rot=0.3737, grad=41.15, nan=0]Epoch 23:  90%|█████████ | 46/51 [00:00<00:00, 93.35it/s, loss=2.0288, trans=0.0179, rot=0.2366, grad=128.96, nan=0]Epoch 23: 100%|██████████| 51/51 [00:00<00:00, 86.22it/s, loss=2.0288, trans=0.0179, rot=0.2366, grad=128.96, nan=0]
Visual features - mean: -0.000988, std: 1.062844
IMU features - mean: -0.000858, std: 0.848160
GT translations (m) - mean: 0.001791, std: 0.030738
GT quaternions - mean: 0.251293, std: 0.432432
Predicted pose window shape: (1, 7)
[[ 0.05217167  0.25051805 -0.187289    0.06901006  0.08523126 -0.12779294
  -0.98571914]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.17482643 -0.04387882  0.12702    -0.06802335  0.05853981  0.11767706
  -0.98898834]]
  Ground truth relative pose:
[[-2.2867939e-04 -5.4861075e-04  7.9611375e-04 -3.1466670e-03
  -3.1053722e-03 -3.2911971e-03  9.9998480e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  91%|█████████ | 20/22 [00:00<00:00, 197.36it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 186.33it/s]

Epoch 23 Summary:
  Train Loss: 2.006654
  Val Loss: 0.254992
  Val Trans Error: 0.0848 m
  Val Rot Error: 6.44 degrees

============================================================
Epoch 24/50
Learning rate: 0.00000588
============================================================
Epoch 24:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 24:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.2795, trans=0.0197, rot=0.3129, grad=36.09, nan=0]Epoch 24:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.6343, trans=0.0133, rot=0.3017, grad=34.80, nan=0]Epoch 24:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.3402, trans=0.0204, rot=0.2957, grad=47.54, nan=0]Epoch 24:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.2540, trans=0.0197, rot=0.2835, grad=59.39, nan=0]Epoch 24:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.6979, trans=0.0145, rot=0.2453, grad=41.12, nan=0]Epoch 24:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.2407, trans=0.0200, rot=0.2408, grad=43.74, nan=0]Epoch 24:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.6576, trans=0.0138, rot=0.2787, grad=31.25, nan=0]Epoch 24:  14%|█▎        | 7/51 [00:00<00:00, 66.40it/s, loss=1.6576, trans=0.0138, rot=0.2787, grad=31.25, nan=0]Epoch 24:  14%|█▎        | 7/51 [00:00<00:00, 66.40it/s, loss=2.0356, trans=0.0178, rot=0.2552, grad=39.07, nan=0]Epoch 24:  14%|█▎        | 7/51 [00:00<00:00, 66.40it/s, loss=1.8481, trans=0.0159, rot=0.2582, grad=52.58, nan=0]Epoch 24:  14%|█▎        | 7/51 [00:00<00:00, 66.40it/s, loss=1.9084, trans=0.0165, rot=0.2602, grad=26.55, nan=0]Epoch 24:  14%|█▎        | 7/51 [00:00<00:00, 66.40it/s, loss=1.6422, trans=0.0138, rot=0.2665, grad=60.27, nan=0]Epoch 24:  14%|█▎        | 7/51 [00:00<00:00, 66.40it/s, loss=2.0291, trans=0.0181, rot=0.2146, grad=51.66, nan=0]Epoch 24:  14%|█▎        | 7/51 [00:00<00:00, 66.40it/s, loss=1.9905, trans=0.0171, rot=0.2840, grad=52.36, nan=0]Epoch 24:  14%|█▎        | 7/51 [00:00<00:00, 66.40it/s, loss=2.1784, trans=0.0192, rot=0.2593, grad=59.11, nan=0]Epoch 24:  14%|█▎        | 7/51 [00:00<00:00, 66.40it/s, loss=1.7928, trans=0.0152, rot=0.2720, grad=35.24, nan=0]Epoch 24:  14%|█▎        | 7/51 [00:00<00:00, 66.40it/s, loss=2.1558, trans=0.0184, rot=0.3157, grad=42.49, nan=0]Epoch 24:  14%|█▎        | 7/51 [00:00<00:00, 66.40it/s, loss=2.1521, trans=0.0188, rot=0.2752, grad=33.73, nan=0]Epoch 24:  33%|███▎      | 17/51 [00:00<00:00, 80.51it/s, loss=2.1521, trans=0.0188, rot=0.2752, grad=33.73, nan=0]Epoch 24:  33%|███▎      | 17/51 [00:00<00:00, 80.51it/s, loss=1.8884, trans=0.0156, rot=0.3266, grad=52.41, nan=0]Epoch 24:  33%|███▎      | 17/51 [00:00<00:00, 80.51it/s, loss=2.1898, trans=0.0186, rot=0.3259, grad=60.50, nan=0]Epoch 24:  33%|███▎      | 17/51 [00:00<00:00, 80.51it/s, loss=1.4078, trans=0.0110, rot=0.3085, grad=29.07, nan=0]Epoch 24:  33%|███▎      | 17/51 [00:00<00:00, 80.51it/s, loss=1.8984, trans=0.0165, rot=0.2435, grad=58.25, nan=0]Epoch 24:  33%|███▎      | 17/51 [00:00<00:00, 80.51it/s, loss=1.9510, trans=0.0164, rot=0.3120, grad=33.90, nan=0]Epoch 24:  33%|███▎      | 17/51 [00:00<00:00, 80.51it/s, loss=1.8383, trans=0.0159, rot=0.2512, grad=40.71, nan=0]Epoch 24:  33%|███▎      | 17/51 [00:00<00:00, 80.51it/s, loss=1.5558, trans=0.0128, rot=0.2715, grad=47.37, nan=0]Epoch 24:  33%|███▎      | 17/51 [00:00<00:00, 80.51it/s, loss=2.1631, trans=0.0187, rot=0.2900, grad=35.12, nan=0]Epoch 24:  33%|███▎      | 17/51 [00:00<00:00, 80.51it/s, loss=1.6986, trans=0.0145, rot=0.2526, grad=37.23, nan=0]Epoch 24:  51%|█████     | 26/51 [00:00<00:00, 83.26it/s, loss=1.6986, trans=0.0145, rot=0.2526, grad=37.23, nan=0]Epoch 24:  51%|█████     | 26/51 [00:00<00:00, 83.26it/s, loss=1.6842, trans=0.0145, rot=0.2389, grad=37.35, nan=0]Epoch 24:  51%|█████     | 26/51 [00:00<00:00, 83.26it/s, loss=1.3894, trans=0.0113, rot=0.2639, grad=45.60, nan=0]Epoch 24:  51%|█████     | 26/51 [00:00<00:00, 83.26it/s, loss=2.0464, trans=0.0177, rot=0.2729, grad=66.34, nan=0]Epoch 24:  51%|█████     | 26/51 [00:00<00:00, 83.26it/s, loss=1.9886, trans=0.0169, rot=0.2998, grad=47.70, nan=0]Epoch 24:  51%|█████     | 26/51 [00:00<00:00, 83.26it/s, loss=1.9647, trans=0.0167, rot=0.2909, grad=27.93, nan=0]Epoch 24:  51%|█████     | 26/51 [00:00<00:00, 83.26it/s, loss=1.6234, trans=0.0132, rot=0.3026, grad=65.23, nan=0]Epoch 24:  51%|█████     | 26/51 [00:00<00:00, 83.26it/s, loss=1.5881, trans=0.0131, rot=0.2772, grad=28.06, nan=0]Epoch 24:  51%|█████     | 26/51 [00:00<00:00, 83.26it/s, loss=2.2330, trans=0.0195, rot=0.2792, grad=47.35, nan=0]Epoch 24:  51%|█████     | 26/51 [00:00<00:00, 83.26it/s, loss=1.8720, trans=0.0163, rot=0.2419, grad=64.14, nan=0]Epoch 24:  51%|█████     | 26/51 [00:00<00:00, 83.26it/s, loss=1.8572, trans=0.0159, rot=0.2692, grad=45.26, nan=0]Epoch 24:  71%|███████   | 36/51 [00:00<00:00, 87.09it/s, loss=1.8572, trans=0.0159, rot=0.2692, grad=45.26, nan=0]Epoch 24:  71%|███████   | 36/51 [00:00<00:00, 87.09it/s, loss=1.3570, trans=0.0107, rot=0.2864, grad=28.66, nan=0]Epoch 24:  71%|███████   | 36/51 [00:00<00:00, 87.09it/s, loss=1.4258, trans=0.0122, rot=0.2087, grad=28.42, nan=0]Epoch 24:  71%|███████   | 36/51 [00:00<00:00, 87.09it/s, loss=1.9939, trans=0.0172, rot=0.2768, grad=38.13, nan=0]Epoch 24:  71%|███████   | 36/51 [00:00<00:00, 87.09it/s, loss=1.8051, trans=0.0153, rot=0.2743, grad=58.80, nan=0]Epoch 24:  71%|███████   | 36/51 [00:00<00:00, 87.09it/s, loss=1.7178, trans=0.0146, rot=0.2533, grad=49.31, nan=0]Epoch 24:  71%|███████   | 36/51 [00:00<00:00, 87.09it/s, loss=1.8134, trans=0.0161, rot=0.2016, grad=50.61, nan=0]Epoch 24:  71%|███████   | 36/51 [00:00<00:00, 87.09it/s, loss=1.5411, trans=0.0127, rot=0.2730, grad=35.34, nan=0]Epoch 24:  71%|███████   | 36/51 [00:00<00:00, 87.09it/s, loss=1.7365, trans=0.0148, rot=0.2543, grad=40.95, nan=0]Epoch 24:  71%|███████   | 36/51 [00:00<00:00, 87.09it/s, loss=2.1999, trans=0.0194, rot=0.2579, grad=35.73, nan=0]Epoch 24:  71%|███████   | 36/51 [00:00<00:00, 87.09it/s, loss=1.7947, trans=0.0151, rot=0.2823, grad=46.49, nan=0]Epoch 24:  90%|█████████ | 46/51 [00:00<00:00, 89.81it/s, loss=1.7947, trans=0.0151, rot=0.2823, grad=46.49, nan=0]Epoch 24:  90%|█████████ | 46/51 [00:00<00:00, 89.81it/s, loss=1.5336, trans=0.0126, rot=0.2692, grad=39.11, nan=0]Epoch 24:  90%|█████████ | 46/51 [00:00<00:00, 89.81it/s, loss=1.7042, trans=0.0142, rot=0.2794, grad=33.36, nan=0]Epoch 24:  90%|█████████ | 46/51 [00:00<00:00, 89.81it/s, loss=1.7616, trans=0.0150, rot=0.2572, grad=26.50, nan=0]Epoch 24:  90%|█████████ | 46/51 [00:00<00:00, 89.81it/s, loss=1.8317, trans=0.0153, rot=0.3017, grad=36.01, nan=0]Epoch 24:  90%|█████████ | 46/51 [00:00<00:00, 89.81it/s, loss=0.9870, trans=0.0075, rot=0.2371, grad=68.56, nan=0]Epoch 24: 100%|██████████| 51/51 [00:00<00:00, 85.55it/s, loss=0.9870, trans=0.0075, rot=0.2371, grad=68.56, nan=0]
Visual features - mean: -0.004265, std: 0.989332
IMU features - mean: 0.001210, std: 0.961120
GT translations (m) - mean: -0.000654, std: 0.039307
GT quaternions - mean: 0.248572, std: 0.434003
Predicted pose window shape: (1, 7)
[[-0.2289949  -0.18843932 -0.21120119  0.06837204 -0.13005842 -0.05106243
  -0.98782724]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.1517091  -0.06203699  0.15816437 -0.08910792 -0.07747284  0.0540015
  -0.99153495]]
  Ground truth relative pose:
[[ 0.00944258 -0.00357281  0.00875478  0.06987781  0.0510223   0.03593336
   0.99560165]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  73%|███████▎  | 16/22 [00:00<00:00, 159.78it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 167.22it/s]

Epoch 24 Summary:
  Train Loss: 1.840758
  Val Loss: 0.200602
  Val Trans Error: 0.0699 m
  Val Rot Error: 6.20 degrees
  ✓ New best model saved

============================================================
Epoch 25/50
Learning rate: 0.00000588
============================================================
Epoch 25:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 25:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.5875, trans=0.0132, rot=0.2639, grad=23.04, nan=0]Epoch 25:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.5113, trans=0.0123, rot=0.2785, grad=57.48, nan=0]Epoch 25:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.4127, trans=0.0116, rot=0.2480, grad=20.78, nan=0]Epoch 25:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.9902, trans=0.0163, rot=0.3562, grad=35.91, nan=0]Epoch 25:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.7524, trans=0.0146, rot=0.2933, grad=24.74, nan=0]Epoch 25:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.0148, trans=0.0174, rot=0.2701, grad=50.88, nan=0]Epoch 25:  12%|█▏        | 6/51 [00:00<00:00, 58.67it/s, loss=2.0148, trans=0.0174, rot=0.2701, grad=50.88, nan=0]Epoch 25:  12%|█▏        | 6/51 [00:00<00:00, 58.67it/s, loss=1.7061, trans=0.0146, rot=0.2473, grad=34.45, nan=0]Epoch 25:  12%|█▏        | 6/51 [00:00<00:00, 58.67it/s, loss=1.8123, trans=0.0158, rot=0.2335, grad=35.51, nan=0]Epoch 25:  12%|█▏        | 6/51 [00:00<00:00, 58.67it/s, loss=1.9063, trans=0.0163, rot=0.2770, grad=29.93, nan=0]Epoch 25:  12%|█▏        | 6/51 [00:00<00:00, 58.67it/s, loss=1.8098, trans=0.0154, rot=0.2740, grad=48.47, nan=0]Epoch 25:  12%|█▏        | 6/51 [00:00<00:00, 58.67it/s, loss=2.0388, trans=0.0175, rot=0.2866, grad=38.96, nan=0]Epoch 25:  12%|█▏        | 6/51 [00:00<00:00, 58.67it/s, loss=1.8809, trans=0.0166, rot=0.2225, grad=50.22, nan=0]Epoch 25:  12%|█▏        | 6/51 [00:00<00:00, 58.67it/s, loss=2.2551, trans=0.0199, rot=0.2657, grad=39.90, nan=0]Epoch 25:  12%|█▏        | 6/51 [00:00<00:00, 58.67it/s, loss=1.7303, trans=0.0142, rot=0.3128, grad=37.54, nan=0]Epoch 25:  12%|█▏        | 6/51 [00:00<00:00, 58.67it/s, loss=1.6975, trans=0.0143, rot=0.2670, grad=30.02, nan=0]Epoch 25:  12%|█▏        | 6/51 [00:00<00:00, 58.67it/s, loss=1.8229, trans=0.0153, rot=0.2938, grad=35.28, nan=0]Epoch 25:  31%|███▏      | 16/51 [00:00<00:00, 78.34it/s, loss=1.8229, trans=0.0153, rot=0.2938, grad=35.28, nan=0]Epoch 25:  31%|███▏      | 16/51 [00:00<00:00, 78.34it/s, loss=1.7920, trans=0.0153, rot=0.2652, grad=46.39, nan=0]Epoch 25:  31%|███▏      | 16/51 [00:00<00:00, 78.34it/s, loss=1.9632, trans=0.0166, rot=0.3007, grad=39.88, nan=0]Epoch 25:  31%|███▏      | 16/51 [00:00<00:00, 78.34it/s, loss=1.8659, trans=0.0160, rot=0.2660, grad=49.85, nan=0]Epoch 25:  31%|███▏      | 16/51 [00:00<00:00, 78.34it/s, loss=1.8194, trans=0.0153, rot=0.2846, grad=45.86, nan=0]Epoch 25:  31%|███▏      | 16/51 [00:00<00:00, 78.34it/s, loss=1.7483, trans=0.0149, rot=0.2582, grad=37.96, nan=0]Epoch 25:  31%|███▏      | 16/51 [00:00<00:00, 78.34it/s, loss=2.0526, trans=0.0180, rot=0.2573, grad=53.62, nan=0]Epoch 25:  31%|███▏      | 16/51 [00:00<00:00, 78.34it/s, loss=1.5582, trans=0.0132, rot=0.2428, grad=29.37, nan=0]Epoch 25:  31%|███▏      | 16/51 [00:00<00:00, 78.34it/s, loss=1.7604, trans=0.0146, rot=0.2982, grad=29.05, nan=0]Epoch 25:  31%|███▏      | 16/51 [00:00<00:00, 78.34it/s, loss=1.9575, trans=0.0168, rot=0.2767, grad=33.66, nan=0]Epoch 25:  31%|███▏      | 16/51 [00:00<00:00, 78.34it/s, loss=1.8110, trans=0.0158, rot=0.2260, grad=35.76, nan=0]Epoch 25:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=1.8110, trans=0.0158, rot=0.2260, grad=35.76, nan=0]Epoch 25:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=2.0131, trans=0.0171, rot=0.3006, grad=49.43, nan=0]Epoch 25:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=1.7900, trans=0.0156, rot=0.2296, grad=34.11, nan=0]Epoch 25:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=1.7984, trans=0.0151, rot=0.2903, grad=40.76, nan=0]Epoch 25:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=1.9651, trans=0.0171, rot=0.2558, grad=51.42, nan=0]Epoch 25:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=1.5773, trans=0.0132, rot=0.2616, grad=36.21, nan=0]Epoch 25:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=2.3649, trans=0.0205, rot=0.3191, grad=40.28, nan=0]Epoch 25:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=2.2380, trans=0.0196, rot=0.2737, grad=44.50, nan=0]Epoch 25:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=1.7270, trans=0.0142, rot=0.3022, grad=31.85, nan=0]Epoch 25:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=1.5386, trans=0.0129, rot=0.2486, grad=32.76, nan=0]Epoch 25:  69%|██████▊   | 35/51 [00:00<00:00, 88.16it/s, loss=1.5386, trans=0.0129, rot=0.2486, grad=32.76, nan=0]Epoch 25:  69%|██████▊   | 35/51 [00:00<00:00, 88.16it/s, loss=1.8035, trans=0.0150, rot=0.2987, grad=33.84, nan=0]Epoch 25:  69%|██████▊   | 35/51 [00:00<00:00, 88.16it/s, loss=2.2253, trans=0.0198, rot=0.2466, grad=66.26, nan=0]Epoch 25:  69%|██████▊   | 35/51 [00:00<00:00, 88.16it/s, loss=1.6980, trans=0.0145, rot=0.2458, grad=53.36, nan=0]Epoch 25:  69%|██████▊   | 35/51 [00:00<00:00, 88.16it/s, loss=1.8315, trans=0.0156, rot=0.2682, grad=52.65, nan=0]Epoch 25:  69%|██████▊   | 35/51 [00:00<00:00, 88.16it/s, loss=1.7927, trans=0.0152, rot=0.2765, grad=40.57, nan=0]Epoch 25:  69%|██████▊   | 35/51 [00:00<00:00, 88.16it/s, loss=2.3143, trans=0.0199, rot=0.3199, grad=39.51, nan=0]Epoch 25:  69%|██████▊   | 35/51 [00:00<00:00, 88.16it/s, loss=2.0004, trans=0.0173, rot=0.2727, grad=41.62, nan=0]Epoch 25:  69%|██████▊   | 35/51 [00:00<00:00, 88.16it/s, loss=1.6821, trans=0.0141, rot=0.2750, grad=39.53, nan=0]Epoch 25:  69%|██████▊   | 35/51 [00:00<00:00, 88.16it/s, loss=1.5437, trans=0.0129, rot=0.2541, grad=27.34, nan=0]Epoch 25:  86%|████████▋ | 44/51 [00:00<00:00, 87.10it/s, loss=1.5437, trans=0.0129, rot=0.2541, grad=27.34, nan=0]Epoch 25:  86%|████████▋ | 44/51 [00:00<00:00, 87.10it/s, loss=1.4220, trans=0.0119, rot=0.2367, grad=26.65, nan=0]Epoch 25:  86%|████████▋ | 44/51 [00:00<00:00, 87.10it/s, loss=1.8494, trans=0.0157, rot=0.2806, grad=57.24, nan=0]Epoch 25:  86%|████████▋ | 44/51 [00:00<00:00, 87.10it/s, loss=1.5262, trans=0.0126, rot=0.2640, grad=26.28, nan=0]Epoch 25:  86%|████████▋ | 44/51 [00:00<00:00, 87.10it/s, loss=1.7200, trans=0.0149, rot=0.2277, grad=23.70, nan=0]Epoch 25:  86%|████████▋ | 44/51 [00:00<00:00, 87.10it/s, loss=1.9741, trans=0.0170, rot=0.2776, grad=44.38, nan=0]Epoch 25:  86%|████████▋ | 44/51 [00:00<00:00, 87.10it/s, loss=1.2240, trans=0.0099, rot=0.2343, grad=24.26, nan=0]Epoch 25:  86%|████████▋ | 44/51 [00:00<00:00, 87.10it/s, loss=2.5519, trans=0.0233, rot=0.2188, grad=85.25, nan=0]Epoch 25: 100%|██████████| 51/51 [00:00<00:00, 84.69it/s, loss=2.5519, trans=0.0233, rot=0.2188, grad=85.25, nan=0]
Visual features - mean: -0.003718, std: 0.975076
IMU features - mean: -0.008397, std: 0.944269
GT translations (m) - mean: -0.001846, std: 0.032502
GT quaternions - mean: 0.252050, std: 0.431992
Predicted pose window shape: (1, 7)
[[-0.17130005  0.14213091 -0.05359345  0.01977679 -0.02808998 -0.00327795
  -0.9994044 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.2565195   0.34417817  0.08609333  0.00280567 -0.03935203 -0.04186342
  -0.9983441 ]]
  Ground truth relative pose:
[[-0.00519484 -0.00763639 -0.00245875 -0.01670765  0.00602026 -0.00501581
   0.99982977]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 186.72it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 181.85it/s]

Epoch 25 Summary:
  Train Loss: 1.831940
  Val Loss: 0.209366
  Val Trans Error: 0.0755 m
  Val Rot Error: 6.05 degrees

============================================================
Epoch 26/50
Learning rate: 0.00000588
============================================================
Epoch 26:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 26:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.8703, trans=0.0163, rot=0.2389, grad=30.90, nan=0]Epoch 26:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.8865, trans=0.0160, rot=0.2886, grad=37.70, nan=0]Epoch 26:   0%|          | 0/51 [00:00<?, ?it/s, loss=2.1064, trans=0.0190, rot=0.2096, grad=34.74, nan=0]Epoch 26:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.9682, trans=0.0169, rot=0.2738, grad=33.11, nan=0]Epoch 26:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.8848, trans=0.0162, rot=0.2666, grad=30.86, nan=0]Epoch 26:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.6040, trans=0.0139, rot=0.2188, grad=25.10, nan=0]Epoch 26:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.3720, trans=0.0114, rot=0.2313, grad=34.57, nan=0]Epoch 26:  14%|█▎        | 7/51 [00:00<00:00, 63.12it/s, loss=1.3720, trans=0.0114, rot=0.2313, grad=34.57, nan=0]Epoch 26:  14%|█▎        | 7/51 [00:00<00:00, 63.12it/s, loss=1.6480, trans=0.0135, rot=0.2967, grad=53.29, nan=0]Epoch 26:  14%|█▎        | 7/51 [00:00<00:00, 63.12it/s, loss=1.8865, trans=0.0161, rot=0.2777, grad=29.65, nan=0]Epoch 26:  14%|█▎        | 7/51 [00:00<00:00, 63.12it/s, loss=1.8785, trans=0.0157, rot=0.3100, grad=41.42, nan=0]Epoch 26:  14%|█▎        | 7/51 [00:00<00:00, 63.12it/s, loss=1.7161, trans=0.0145, rot=0.2639, grad=36.31, nan=0]Epoch 26:  14%|█▎        | 7/51 [00:00<00:00, 63.12it/s, loss=2.5499, trans=0.0228, rot=0.2713, grad=54.97, nan=0]Epoch 26:  14%|█▎        | 7/51 [00:00<00:00, 63.12it/s, loss=1.3989, trans=0.0116, rot=0.2376, grad=31.30, nan=0]Epoch 26:  14%|█▎        | 7/51 [00:00<00:00, 63.12it/s, loss=1.9667, trans=0.0173, rot=0.2373, grad=46.88, nan=0]Epoch 26:  14%|█▎        | 7/51 [00:00<00:00, 63.12it/s, loss=1.5573, trans=0.0125, rot=0.3094, grad=43.25, nan=0]Epoch 26:  14%|█▎        | 7/51 [00:00<00:00, 63.12it/s, loss=1.6285, trans=0.0137, rot=0.2541, grad=36.89, nan=0]Epoch 26:  14%|█▎        | 7/51 [00:00<00:00, 63.12it/s, loss=1.5042, trans=0.0124, rot=0.2659, grad=26.17, nan=0]Epoch 26:  33%|███▎      | 17/51 [00:00<00:00, 79.94it/s, loss=1.5042, trans=0.0124, rot=0.2659, grad=26.17, nan=0]Epoch 26:  33%|███▎      | 17/51 [00:00<00:00, 79.94it/s, loss=1.4304, trans=0.0116, rot=0.2687, grad=25.39, nan=0]Epoch 26:  33%|███▎      | 17/51 [00:00<00:00, 79.94it/s, loss=1.8554, trans=0.0160, rot=0.2510, grad=46.70, nan=0]Epoch 26:  33%|███▎      | 17/51 [00:00<00:00, 79.94it/s, loss=1.7968, trans=0.0150, rot=0.2947, grad=34.44, nan=0]Epoch 26:  33%|███▎      | 17/51 [00:00<00:00, 79.94it/s, loss=1.5745, trans=0.0132, rot=0.2572, grad=42.23, nan=0]Epoch 26:  33%|███▎      | 17/51 [00:00<00:00, 79.94it/s, loss=1.5382, trans=0.0126, rot=0.2814, grad=40.52, nan=0]Epoch 26:  33%|███▎      | 17/51 [00:00<00:00, 79.94it/s, loss=1.7402, trans=0.0146, rot=0.2812, grad=58.51, nan=0]Epoch 26:  33%|███▎      | 17/51 [00:00<00:00, 79.94it/s, loss=1.7276, trans=0.0148, rot=0.2486, grad=36.47, nan=0]Epoch 26:  33%|███▎      | 17/51 [00:00<00:00, 79.94it/s, loss=1.6305, trans=0.0135, rot=0.2765, grad=30.38, nan=0]Epoch 26:  33%|███▎      | 17/51 [00:00<00:00, 79.94it/s, loss=1.7832, trans=0.0154, rot=0.2454, grad=52.80, nan=0]Epoch 26:  33%|███▎      | 17/51 [00:00<00:00, 79.94it/s, loss=1.6031, trans=0.0132, rot=0.2820, grad=62.83, nan=0]Epoch 26:  53%|█████▎    | 27/51 [00:00<00:00, 84.75it/s, loss=1.6031, trans=0.0132, rot=0.2820, grad=62.83, nan=0]Epoch 26:  53%|█████▎    | 27/51 [00:00<00:00, 84.75it/s, loss=1.6643, trans=0.0139, rot=0.2768, grad=30.36, nan=0]Epoch 26:  53%|█████▎    | 27/51 [00:00<00:00, 84.75it/s, loss=2.0493, trans=0.0176, rot=0.2899, grad=40.51, nan=0]Epoch 26:  53%|█████▎    | 27/51 [00:00<00:00, 84.75it/s, loss=1.7194, trans=0.0147, rot=0.2523, grad=66.20, nan=0]Epoch 26:  53%|█████▎    | 27/51 [00:00<00:00, 84.75it/s, loss=2.1220, trans=0.0185, rot=0.2742, grad=52.33, nan=0]Epoch 26:  53%|█████▎    | 27/51 [00:00<00:00, 84.75it/s, loss=1.8055, trans=0.0154, rot=0.2662, grad=35.65, nan=0]Epoch 26:  53%|█████▎    | 27/51 [00:00<00:00, 84.75it/s, loss=1.6066, trans=0.0134, rot=0.2650, grad=37.17, nan=0]Epoch 26:  53%|█████▎    | 27/51 [00:00<00:00, 84.75it/s, loss=1.3010, trans=0.0108, rot=0.2180, grad=35.09, nan=0]Epoch 26:  53%|█████▎    | 27/51 [00:00<00:00, 84.75it/s, loss=1.7339, trans=0.0147, rot=0.2654, grad=33.97, nan=0]Epoch 26:  53%|█████▎    | 27/51 [00:00<00:00, 84.75it/s, loss=1.4592, trans=0.0115, rot=0.3054, grad=57.67, nan=0]Epoch 26:  53%|█████▎    | 27/51 [00:00<00:00, 84.75it/s, loss=1.9266, trans=0.0165, rot=0.2786, grad=53.26, nan=0]Epoch 26:  73%|███████▎  | 37/51 [00:00<00:00, 88.72it/s, loss=1.9266, trans=0.0165, rot=0.2786, grad=53.26, nan=0]Epoch 26:  73%|███████▎  | 37/51 [00:00<00:00, 88.72it/s, loss=1.8150, trans=0.0151, rot=0.3056, grad=51.18, nan=0]Epoch 26:  73%|███████▎  | 37/51 [00:00<00:00, 88.72it/s, loss=1.7031, trans=0.0141, rot=0.2936, grad=29.35, nan=0]Epoch 26:  73%|███████▎  | 37/51 [00:00<00:00, 88.72it/s, loss=1.6789, trans=0.0138, rot=0.3002, grad=47.39, nan=0]Epoch 26:  73%|███████▎  | 37/51 [00:00<00:00, 88.72it/s, loss=1.5236, trans=0.0127, rot=0.2527, grad=29.40, nan=0]Epoch 26:  73%|███████▎  | 37/51 [00:00<00:00, 88.72it/s, loss=1.9502, trans=0.0166, rot=0.2922, grad=36.22, nan=0]Epoch 26:  73%|███████▎  | 37/51 [00:00<00:00, 88.72it/s, loss=1.6388, trans=0.0137, rot=0.2671, grad=28.01, nan=0]Epoch 26:  73%|███████▎  | 37/51 [00:00<00:00, 88.72it/s, loss=1.6467, trans=0.0139, rot=0.2555, grad=25.50, nan=0]Epoch 26:  73%|███████▎  | 37/51 [00:00<00:00, 88.72it/s, loss=1.6202, trans=0.0132, rot=0.2971, grad=23.71, nan=0]Epoch 26:  73%|███████▎  | 37/51 [00:00<00:00, 88.72it/s, loss=2.0041, trans=0.0170, rot=0.3020, grad=36.40, nan=0]Epoch 26:  73%|███████▎  | 37/51 [00:00<00:00, 88.72it/s, loss=1.8877, trans=0.0165, rot=0.2361, grad=36.11, nan=0]Epoch 26:  92%|█████████▏| 47/51 [00:00<00:00, 90.69it/s, loss=1.8877, trans=0.0165, rot=0.2361, grad=36.11, nan=0]Epoch 26:  92%|█████████▏| 47/51 [00:00<00:00, 90.69it/s, loss=1.8382, trans=0.0155, rot=0.2882, grad=36.50, nan=0]Epoch 26:  92%|█████████▏| 47/51 [00:00<00:00, 90.69it/s, loss=2.0123, trans=0.0177, rot=0.2462, grad=62.08, nan=0]Epoch 26:  92%|█████████▏| 47/51 [00:00<00:00, 90.69it/s, loss=1.2999, trans=0.0101, rot=0.2915, grad=36.17, nan=0]Epoch 26:  92%|█████████▏| 47/51 [00:00<00:00, 90.69it/s, loss=2.9638, trans=0.0274, rot=0.2250, grad=97.56, nan=0]Epoch 26: 100%|██████████| 51/51 [00:00<00:00, 85.74it/s, loss=2.9638, trans=0.0274, rot=0.2250, grad=97.56, nan=0]
Visual features - mean: 0.000055, std: 1.064862
IMU features - mean: 0.006970, std: 0.849981
GT translations (m) - mean: 0.000003, std: 0.041800
GT quaternions - mean: 0.249958, std: 0.433206
Predicted pose window shape: (1, 7)
[[ 0.28804395 -0.06299229 -0.0398172   0.06521145 -0.10278197 -0.02779037
  -0.9921749 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.56395787 -0.03451217 -0.0100678   0.00574201  0.12803544 -0.00517263
  -0.99173945]]
  Ground truth relative pose:
[[ 1.1867289e-03  5.0060153e-03  9.5448270e-04  1.8012410e-02
   4.2142081e-03 -3.7660520e-03  9.9982178e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  91%|█████████ | 20/22 [00:00<00:00, 194.81it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 179.89it/s]

Epoch 26 Summary:
  Train Loss: 1.766219
  Val Loss: 0.177509
  Val Trans Error: 0.0667 m
  Val Rot Error: 5.69 degrees
  ✓ New best model saved

============================================================
Epoch 27/50
Learning rate: 0.00000588
============================================================
Epoch 27:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 27:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.8081, trans=0.0157, rot=0.2429, grad=32.01, nan=0]Epoch 27:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.4733, trans=0.0121, rot=0.2638, grad=34.49, nan=0]Epoch 27:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.6247, trans=0.0135, rot=0.2773, grad=29.12, nan=0]Epoch 27:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.6745, trans=0.0139, rot=0.2887, grad=55.74, nan=0]Epoch 27:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.8353, trans=0.0159, rot=0.2441, grad=75.87, nan=0]Epoch 27:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.8092, trans=0.0160, rot=0.2052, grad=42.02, nan=0]Epoch 27:  12%|█▏        | 6/51 [00:00<00:00, 58.81it/s, loss=1.8092, trans=0.0160, rot=0.2052, grad=42.02, nan=0]Epoch 27:  12%|█▏        | 6/51 [00:00<00:00, 58.81it/s, loss=1.4416, trans=0.0118, rot=0.2614, grad=36.32, nan=0]Epoch 27:  12%|█▏        | 6/51 [00:00<00:00, 58.81it/s, loss=1.8197, trans=0.0157, rot=0.2514, grad=44.83, nan=0]Epoch 27:  12%|█▏        | 6/51 [00:00<00:00, 58.81it/s, loss=1.6639, trans=0.0138, rot=0.2791, grad=29.70, nan=0]Epoch 27:  12%|█▏        | 6/51 [00:00<00:00, 58.81it/s, loss=1.8525, trans=0.0163, rot=0.2241, grad=40.85, nan=0]Epoch 27:  12%|█▏        | 6/51 [00:00<00:00, 58.81it/s, loss=1.4759, trans=0.0127, rot=0.2030, grad=27.08, nan=0]Epoch 27:  12%|█▏        | 6/51 [00:00<00:00, 58.81it/s, loss=1.5574, trans=0.0132, rot=0.2385, grad=29.54, nan=0]Epoch 27:  12%|█▏        | 6/51 [00:00<00:00, 58.81it/s, loss=1.7704, trans=0.0155, rot=0.2222, grad=35.05, nan=0]Epoch 27:  12%|█▏        | 6/51 [00:00<00:00, 58.81it/s, loss=1.7969, trans=0.0151, rot=0.2894, grad=35.53, nan=0]Epoch 27:  12%|█▏        | 6/51 [00:00<00:00, 58.81it/s, loss=1.4682, trans=0.0118, rot=0.2905, grad=34.16, nan=0]Epoch 27:  12%|█▏        | 6/51 [00:00<00:00, 58.81it/s, loss=1.9731, trans=0.0169, rot=0.2859, grad=32.43, nan=0]Epoch 27:  31%|███▏      | 16/51 [00:00<00:00, 77.84it/s, loss=1.9731, trans=0.0169, rot=0.2859, grad=32.43, nan=0]Epoch 27:  31%|███▏      | 16/51 [00:00<00:00, 77.84it/s, loss=1.8297, trans=0.0158, rot=0.2497, grad=41.26, nan=0]Epoch 27:  31%|███▏      | 16/51 [00:00<00:00, 77.84it/s, loss=1.6591, trans=0.0140, rot=0.2558, grad=49.35, nan=0]Epoch 27:  31%|███▏      | 16/51 [00:00<00:00, 77.84it/s, loss=1.7702, trans=0.0146, rot=0.3085, grad=35.18, nan=0]Epoch 27:  31%|███▏      | 16/51 [00:00<00:00, 77.84it/s, loss=1.7994, trans=0.0147, rot=0.3285, grad=26.95, nan=0]Epoch 27:  31%|███▏      | 16/51 [00:00<00:00, 77.84it/s, loss=1.4553, trans=0.0120, rot=0.2511, grad=25.04, nan=0]Epoch 27:  31%|███▏      | 16/51 [00:00<00:00, 77.84it/s, loss=1.4119, trans=0.0120, rot=0.2141, grad=27.08, nan=0]Epoch 27:  31%|███▏      | 16/51 [00:00<00:00, 77.84it/s, loss=1.4301, trans=0.0116, rot=0.2658, grad=20.22, nan=0]Epoch 27:  31%|███▏      | 16/51 [00:00<00:00, 77.84it/s, loss=1.2273, trans=0.0100, rot=0.2260, grad=23.85, nan=0]Epoch 27:  31%|███▏      | 16/51 [00:00<00:00, 77.84it/s, loss=1.8296, trans=0.0154, rot=0.2901, grad=54.11, nan=0]Epoch 27:  31%|███▏      | 16/51 [00:00<00:00, 77.84it/s, loss=1.8510, trans=0.0157, rot=0.2851, grad=45.28, nan=0]Epoch 27:  51%|█████     | 26/51 [00:00<00:00, 86.02it/s, loss=1.8510, trans=0.0157, rot=0.2851, grad=45.28, nan=0]Epoch 27:  51%|█████     | 26/51 [00:00<00:00, 86.02it/s, loss=1.7294, trans=0.0144, rot=0.2860, grad=42.98, nan=0]Epoch 27:  51%|█████     | 26/51 [00:00<00:00, 86.02it/s, loss=1.3668, trans=0.0114, rot=0.2316, grad=46.71, nan=0]Epoch 27:  51%|█████     | 26/51 [00:00<00:00, 86.02it/s, loss=1.4836, trans=0.0122, rot=0.2681, grad=24.55, nan=0]Epoch 27:  51%|█████     | 26/51 [00:00<00:00, 86.02it/s, loss=1.5506, trans=0.0128, rot=0.2656, grad=40.47, nan=0]Epoch 27:  51%|█████     | 26/51 [00:00<00:00, 86.02it/s, loss=1.5203, trans=0.0124, rot=0.2754, grad=29.80, nan=0]Epoch 27:  51%|█████     | 26/51 [00:00<00:00, 86.02it/s, loss=1.6360, trans=0.0138, rot=0.2536, grad=36.49, nan=0]Epoch 27:  51%|█████     | 26/51 [00:00<00:00, 86.02it/s, loss=1.4720, trans=0.0125, rot=0.2247, grad=42.43, nan=0]Epoch 27:  51%|█████     | 26/51 [00:00<00:00, 86.02it/s, loss=1.3458, trans=0.0110, rot=0.2431, grad=30.84, nan=0]Epoch 27:  51%|█████     | 26/51 [00:00<00:00, 86.02it/s, loss=1.5539, trans=0.0130, rot=0.2558, grad=26.83, nan=0]Epoch 27:  69%|██████▊   | 35/51 [00:00<00:00, 83.13it/s, loss=1.5539, trans=0.0130, rot=0.2558, grad=26.83, nan=0]Epoch 27:  69%|██████▊   | 35/51 [00:00<00:00, 83.13it/s, loss=1.7088, trans=0.0146, rot=0.2533, grad=31.88, nan=0]Epoch 27:  69%|██████▊   | 35/51 [00:00<00:00, 83.13it/s, loss=1.6326, trans=0.0133, rot=0.3008, grad=25.15, nan=0]Epoch 27:  69%|██████▊   | 35/51 [00:00<00:00, 83.13it/s, loss=1.9521, trans=0.0169, rot=0.2620, grad=42.04, nan=0]Epoch 27:  69%|██████▊   | 35/51 [00:00<00:00, 83.13it/s, loss=1.6358, trans=0.0141, rot=0.2297, grad=30.26, nan=0]Epoch 27:  69%|██████▊   | 35/51 [00:00<00:00, 83.13it/s, loss=1.8386, trans=0.0158, rot=0.2593, grad=56.84, nan=0]Epoch 27:  69%|██████▊   | 35/51 [00:00<00:00, 83.13it/s, loss=1.8778, trans=0.0163, rot=0.2473, grad=40.18, nan=0]Epoch 27:  69%|██████▊   | 35/51 [00:00<00:00, 83.13it/s, loss=1.7166, trans=0.0140, rot=0.3161, grad=54.11, nan=0]Epoch 27:  69%|██████▊   | 35/51 [00:00<00:00, 83.13it/s, loss=1.5191, trans=0.0128, rot=0.2419, grad=25.59, nan=0]Epoch 27:  69%|██████▊   | 35/51 [00:00<00:00, 83.13it/s, loss=1.6905, trans=0.0143, rot=0.2585, grad=34.33, nan=0]Epoch 27:  69%|██████▊   | 35/51 [00:00<00:00, 83.13it/s, loss=1.6208, trans=0.0135, rot=0.2739, grad=38.83, nan=0]Epoch 27:  88%|████████▊ | 45/51 [00:00<00:00, 88.26it/s, loss=1.6208, trans=0.0135, rot=0.2739, grad=38.83, nan=0]Epoch 27:  88%|████████▊ | 45/51 [00:00<00:00, 88.26it/s, loss=1.6551, trans=0.0141, rot=0.2492, grad=38.02, nan=0]Epoch 27:  88%|████████▊ | 45/51 [00:00<00:00, 88.26it/s, loss=1.8575, trans=0.0166, rot=0.2022, grad=50.32, nan=0]Epoch 27:  88%|████████▊ | 45/51 [00:00<00:00, 88.26it/s, loss=1.3349, trans=0.0103, rot=0.3080, grad=55.25, nan=0]Epoch 27:  88%|████████▊ | 45/51 [00:00<00:00, 88.26it/s, loss=2.0861, trans=0.0181, rot=0.2766, grad=44.28, nan=0]Epoch 27:  88%|████████▊ | 45/51 [00:00<00:00, 88.26it/s, loss=1.8353, trans=0.0155, rot=0.2815, grad=56.92, nan=0]Epoch 27:  88%|████████▊ | 45/51 [00:00<00:00, 88.26it/s, loss=1.4997, trans=0.0118, rot=0.3178, grad=84.39, nan=0]Epoch 27: 100%|██████████| 51/51 [00:00<00:00, 84.54it/s, loss=1.4997, trans=0.0118, rot=0.3178, grad=84.39, nan=0]
Visual features - mean: -0.000833, std: 1.009181
IMU features - mean: 0.001225, std: 0.894437
GT translations (m) - mean: -0.000464, std: 0.034420
GT quaternions - mean: 0.250326, std: 0.432994
Predicted pose window shape: (1, 7)
[[ 0.13668834  0.22069481  0.17067134  0.07540398  0.08023181 -0.00607029
  -0.9939015 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.13409884  0.15084106  0.40553144 -0.05836705  0.09954724 -0.04071553
  -0.9924847 ]]
  Ground truth relative pose:
[[ 0.01655765  0.00749739 -0.02177024 -0.05337134  0.00159633  0.00248224
   0.9985704 ]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 188.50it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 167.89it/s]

Epoch 27 Summary:
  Train Loss: 1.655455
  Val Loss: 0.176597
  Val Trans Error: 0.0675 m
  Val Rot Error: 5.54 degrees
  ✓ New best model saved

============================================================
Epoch 28/50
Learning rate: 0.00000588
============================================================
Epoch 28:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 28:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.8761, trans=0.0163, rot=0.2439, grad=63.58, nan=0]Epoch 28:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.5795, trans=0.0129, rot=0.2936, grad=36.94, nan=0]Epoch 28:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.4120, trans=0.0115, rot=0.2639, grad=36.55, nan=0]Epoch 28:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.2618, trans=0.0102, rot=0.2371, grad=24.79, nan=0]Epoch 28:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.6704, trans=0.0139, rot=0.2836, grad=56.92, nan=0]Epoch 28:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.8544, trans=0.0157, rot=0.2810, grad=32.93, nan=0]Epoch 28:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.2004, trans=0.0093, rot=0.2690, grad=21.09, nan=0]Epoch 28:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=1.2004, trans=0.0093, rot=0.2690, grad=21.09, nan=0]Epoch 28:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=1.8777, trans=0.0158, rot=0.3010, grad=41.06, nan=0]Epoch 28:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=1.9396, trans=0.0168, rot=0.2607, grad=30.68, nan=0]Epoch 28:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=2.0652, trans=0.0176, rot=0.3006, grad=47.43, nan=0]Epoch 28:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=1.5729, trans=0.0131, rot=0.2648, grad=49.99, nan=0]Epoch 28:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=1.4261, trans=0.0120, rot=0.2289, grad=34.60, nan=0]Epoch 28:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=1.7249, trans=0.0145, rot=0.2757, grad=30.91, nan=0]Epoch 28:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=1.4221, trans=0.0118, rot=0.2423, grad=30.46, nan=0]Epoch 28:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=1.5618, trans=0.0129, rot=0.2724, grad=24.31, nan=0]Epoch 28:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=1.8538, trans=0.0156, rot=0.2982, grad=69.79, nan=0]Epoch 28:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=1.4364, trans=0.0117, rot=0.2690, grad=39.57, nan=0]Epoch 28:  33%|███▎      | 17/51 [00:00<00:00, 82.07it/s, loss=1.4364, trans=0.0117, rot=0.2690, grad=39.57, nan=0]Epoch 28:  33%|███▎      | 17/51 [00:00<00:00, 82.07it/s, loss=1.4998, trans=0.0122, rot=0.2773, grad=25.94, nan=0]Epoch 28:  33%|███▎      | 17/51 [00:00<00:00, 82.07it/s, loss=1.6299, trans=0.0135, rot=0.2766, grad=56.43, nan=0]Epoch 28:  33%|███▎      | 17/51 [00:00<00:00, 82.07it/s, loss=1.3865, trans=0.0113, rot=0.2605, grad=39.86, nan=0]Epoch 28:  33%|███▎      | 17/51 [00:00<00:00, 82.07it/s, loss=1.6164, trans=0.0132, rot=0.2981, grad=26.01, nan=0]Epoch 28:  33%|███▎      | 17/51 [00:00<00:00, 82.07it/s, loss=1.5255, trans=0.0130, rot=0.2215, grad=39.74, nan=0]Epoch 28:  33%|███▎      | 17/51 [00:00<00:00, 82.07it/s, loss=1.4784, trans=0.0123, rot=0.2528, grad=24.96, nan=0]Epoch 28:  33%|███▎      | 17/51 [00:00<00:00, 82.07it/s, loss=1.2959, trans=0.0104, rot=0.2605, grad=26.48, nan=0]Epoch 28:  33%|███▎      | 17/51 [00:00<00:00, 82.07it/s, loss=1.8258, trans=0.0160, rot=0.2300, grad=37.54, nan=0]Epoch 28:  33%|███▎      | 17/51 [00:00<00:00, 82.07it/s, loss=1.8575, trans=0.0158, rot=0.2804, grad=32.76, nan=0]Epoch 28:  33%|███▎      | 17/51 [00:00<00:00, 82.07it/s, loss=1.4203, trans=0.0114, rot=0.2778, grad=35.24, nan=0]Epoch 28:  33%|███▎      | 17/51 [00:00<00:00, 82.07it/s, loss=1.2057, trans=0.0096, rot=0.2419, grad=33.28, nan=0]Epoch 28:  55%|█████▍    | 28/51 [00:00<00:00, 91.92it/s, loss=1.2057, trans=0.0096, rot=0.2419, grad=33.28, nan=0]Epoch 28:  55%|█████▍    | 28/51 [00:00<00:00, 91.92it/s, loss=1.7305, trans=0.0147, rot=0.2649, grad=42.12, nan=0]Epoch 28:  55%|█████▍    | 28/51 [00:00<00:00, 91.92it/s, loss=1.2221, trans=0.0097, rot=0.2485, grad=17.90, nan=0]Epoch 28:  55%|█████▍    | 28/51 [00:00<00:00, 91.92it/s, loss=1.5537, trans=0.0131, rot=0.2453, grad=28.08, nan=0]Epoch 28:  55%|█████▍    | 28/51 [00:00<00:00, 91.92it/s, loss=1.6544, trans=0.0138, rot=0.2749, grad=29.07, nan=0]Epoch 28:  55%|█████▍    | 28/51 [00:00<00:00, 91.92it/s, loss=1.4213, trans=0.0118, rot=0.2451, grad=38.91, nan=0]Epoch 28:  55%|█████▍    | 28/51 [00:00<00:00, 91.92it/s, loss=1.5313, trans=0.0127, rot=0.2657, grad=34.22, nan=0]Epoch 28:  55%|█████▍    | 28/51 [00:00<00:00, 91.92it/s, loss=1.3913, trans=0.0111, rot=0.2791, grad=34.98, nan=0]Epoch 28:  55%|█████▍    | 28/51 [00:00<00:00, 91.92it/s, loss=1.5576, trans=0.0131, rot=0.2525, grad=19.21, nan=0]Epoch 28:  55%|█████▍    | 28/51 [00:00<00:00, 91.92it/s, loss=1.6238, trans=0.0135, rot=0.2757, grad=22.33, nan=0]Epoch 28:  55%|█████▍    | 28/51 [00:00<00:00, 91.92it/s, loss=1.9132, trans=0.0164, rot=0.2708, grad=45.70, nan=0]Epoch 28:  75%|███████▍  | 38/51 [00:00<00:00, 93.35it/s, loss=1.9132, trans=0.0164, rot=0.2708, grad=45.70, nan=0]Epoch 28:  75%|███████▍  | 38/51 [00:00<00:00, 93.35it/s, loss=1.2787, trans=0.0102, rot=0.2547, grad=28.87, nan=0]Epoch 28:  75%|███████▍  | 38/51 [00:00<00:00, 93.35it/s, loss=1.5630, trans=0.0131, rot=0.2492, grad=42.27, nan=0]Epoch 28:  75%|███████▍  | 38/51 [00:00<00:00, 93.35it/s, loss=1.6011, trans=0.0140, rot=0.1975, grad=22.15, nan=0]Epoch 28:  75%|███████▍  | 38/51 [00:00<00:00, 93.35it/s, loss=1.7772, trans=0.0150, rot=0.2812, grad=43.45, nan=0]Epoch 28:  75%|███████▍  | 38/51 [00:00<00:00, 93.35it/s, loss=1.6622, trans=0.0142, rot=0.2429, grad=35.07, nan=0]Epoch 28:  75%|███████▍  | 38/51 [00:00<00:00, 93.35it/s, loss=1.5616, trans=0.0133, rot=0.2332, grad=29.71, nan=0]Epoch 28:  75%|███████▍  | 38/51 [00:00<00:00, 93.35it/s, loss=1.4061, trans=0.0113, rot=0.2777, grad=25.11, nan=0]Epoch 28:  75%|███████▍  | 38/51 [00:00<00:00, 93.35it/s, loss=1.9136, trans=0.0167, rot=0.2467, grad=67.15, nan=0]Epoch 28:  75%|███████▍  | 38/51 [00:00<00:00, 93.35it/s, loss=1.4821, trans=0.0119, rot=0.2880, grad=22.76, nan=0]Epoch 28:  75%|███████▍  | 38/51 [00:00<00:00, 93.35it/s, loss=1.4900, trans=0.0127, rot=0.2216, grad=31.10, nan=0]Epoch 28:  75%|███████▍  | 38/51 [00:00<00:00, 93.35it/s, loss=1.9190, trans=0.0169, rot=0.2264, grad=38.78, nan=0]Epoch 28:  96%|█████████▌| 49/51 [00:00<00:00, 97.18it/s, loss=1.9190, trans=0.0169, rot=0.2264, grad=38.78, nan=0]Epoch 28:  96%|█████████▌| 49/51 [00:00<00:00, 97.18it/s, loss=1.5551, trans=0.0127, rot=0.2802, grad=22.05, nan=0]Epoch 28:  96%|█████████▌| 49/51 [00:00<00:00, 97.18it/s, loss=2.0910, trans=0.0171, rot=0.3786, grad=81.71, nan=0]Epoch 28: 100%|██████████| 51/51 [00:00<00:00, 91.24it/s, loss=2.0910, trans=0.0171, rot=0.3786, grad=81.71, nan=0]
Visual features - mean: 0.002255, std: 1.015100
IMU features - mean: -0.003325, std: 0.934567
GT translations (m) - mean: -0.001891, std: 0.031408
GT quaternions - mean: 0.250148, std: 0.433096
Predicted pose window shape: (1, 7)
[[-0.04381448 -0.01611121  0.17651492 -0.07290922 -0.07866725  0.01804034
  -0.9940675 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.18617629 -0.03638865 -0.17438391  0.07398012 -0.00314038 -0.01295936
  -0.99717057]]
  Ground truth relative pose:
[[-0.0116254   0.01895507 -0.05717812 -0.08787763  0.08219672 -0.02578972
   0.9923992 ]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  82%|████████▏ | 18/22 [00:00<00:00, 179.78it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 178.07it/s]

Epoch 28 Summary:
  Train Loss: 1.595622
  Val Loss: 0.192769
  Val Trans Error: 0.0708 m
  Val Rot Error: 5.44 degrees

============================================================
Epoch 29/50
Learning rate: 0.00000588
============================================================
Epoch 29:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 29:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.3814, trans=0.0110, rot=0.2786, grad=33.83, nan=0]Epoch 29:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.4068, trans=0.0117, rot=0.2325, grad=49.41, nan=0]Epoch 29:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.4880, trans=0.0124, rot=0.2434, grad=18.29, nan=0]Epoch 29:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.3915, trans=0.0117, rot=0.2250, grad=19.85, nan=0]Epoch 29:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.6679, trans=0.0141, rot=0.2555, grad=28.69, nan=0]Epoch 29:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.3738, trans=0.0113, rot=0.2483, grad=46.85, nan=0]Epoch 29:  12%|█▏        | 6/51 [00:00<00:00, 55.50it/s, loss=1.3738, trans=0.0113, rot=0.2483, grad=46.85, nan=0]Epoch 29:  12%|█▏        | 6/51 [00:00<00:00, 55.50it/s, loss=1.6949, trans=0.0142, rot=0.2713, grad=39.55, nan=0]Epoch 29:  12%|█▏        | 6/51 [00:00<00:00, 55.50it/s, loss=1.4433, trans=0.0118, rot=0.2675, grad=46.13, nan=0]Epoch 29:  12%|█▏        | 6/51 [00:00<00:00, 55.50it/s, loss=1.5039, trans=0.0119, rot=0.3115, grad=30.76, nan=0]Epoch 29:  12%|█▏        | 6/51 [00:00<00:00, 55.50it/s, loss=1.6523, trans=0.0142, rot=0.2295, grad=27.64, nan=0]Epoch 29:  12%|█▏        | 6/51 [00:00<00:00, 55.50it/s, loss=1.4305, trans=0.0123, rot=0.1978, grad=43.51, nan=0]Epoch 29:  12%|█▏        | 6/51 [00:00<00:00, 55.50it/s, loss=1.3588, trans=0.0107, rot=0.2933, grad=42.02, nan=0]Epoch 29:  12%|█▏        | 6/51 [00:00<00:00, 55.50it/s, loss=1.5527, trans=0.0127, rot=0.2813, grad=29.61, nan=0]Epoch 29:  12%|█▏        | 6/51 [00:00<00:00, 55.50it/s, loss=1.6150, trans=0.0135, rot=0.2658, grad=36.65, nan=0]Epoch 29:  12%|█▏        | 6/51 [00:00<00:00, 55.50it/s, loss=1.8949, trans=0.0163, rot=0.2662, grad=67.09, nan=0]Epoch 29:  12%|█▏        | 6/51 [00:00<00:00, 55.50it/s, loss=1.3402, trans=0.0107, rot=0.2735, grad=44.52, nan=0]Epoch 29:  31%|███▏      | 16/51 [00:00<00:00, 76.20it/s, loss=1.3402, trans=0.0107, rot=0.2735, grad=44.52, nan=0]Epoch 29:  31%|███▏      | 16/51 [00:00<00:00, 76.20it/s, loss=1.6267, trans=0.0140, rot=0.2258, grad=53.71, nan=0]Epoch 29:  31%|███▏      | 16/51 [00:00<00:00, 76.20it/s, loss=1.8790, trans=0.0155, rot=0.3257, grad=45.33, nan=0]Epoch 29:  31%|███▏      | 16/51 [00:00<00:00, 76.20it/s, loss=1.7246, trans=0.0143, rot=0.2948, grad=53.72, nan=0]Epoch 29:  31%|███▏      | 16/51 [00:00<00:00, 76.20it/s, loss=1.5475, trans=0.0133, rot=0.2158, grad=37.11, nan=0]Epoch 29:  31%|███▏      | 16/51 [00:00<00:00, 76.20it/s, loss=1.7601, trans=0.0149, rot=0.2691, grad=53.99, nan=0]Epoch 29:  31%|███▏      | 16/51 [00:00<00:00, 76.20it/s, loss=1.5860, trans=0.0130, rot=0.2848, grad=50.76, nan=0]Epoch 29:  31%|███▏      | 16/51 [00:00<00:00, 76.20it/s, loss=1.5635, trans=0.0131, rot=0.2559, grad=36.26, nan=0]Epoch 29:  31%|███▏      | 16/51 [00:00<00:00, 76.20it/s, loss=1.5273, trans=0.0126, rot=0.2682, grad=36.64, nan=0]Epoch 29:  47%|████▋     | 24/51 [00:00<00:00, 77.37it/s, loss=1.5273, trans=0.0126, rot=0.2682, grad=36.64, nan=0]Epoch 29:  47%|████▋     | 24/51 [00:00<00:00, 77.37it/s, loss=1.4398, trans=0.0119, rot=0.2546, grad=54.71, nan=0]Epoch 29:  47%|████▋     | 24/51 [00:00<00:00, 77.37it/s, loss=1.3776, trans=0.0111, rot=0.2713, grad=43.57, nan=0]Epoch 29:  47%|████▋     | 24/51 [00:00<00:00, 77.37it/s, loss=1.3714, trans=0.0111, rot=0.2587, grad=35.10, nan=0]Epoch 29:  47%|████▋     | 24/51 [00:00<00:00, 77.37it/s, loss=1.5199, trans=0.0130, rot=0.2232, grad=67.26, nan=0]Epoch 29:  47%|████▋     | 24/51 [00:00<00:00, 77.37it/s, loss=1.5560, trans=0.0134, rot=0.2182, grad=28.37, nan=0]Epoch 29:  47%|████▋     | 24/51 [00:00<00:00, 77.37it/s, loss=1.8653, trans=0.0158, rot=0.2827, grad=39.71, nan=0]Epoch 29:  47%|████▋     | 24/51 [00:00<00:00, 77.37it/s, loss=1.9463, trans=0.0170, rot=0.2466, grad=44.61, nan=0]Epoch 29:  47%|████▋     | 24/51 [00:00<00:00, 77.37it/s, loss=1.7118, trans=0.0148, rot=0.2317, grad=43.03, nan=0]Epoch 29:  47%|████▋     | 24/51 [00:00<00:00, 77.37it/s, loss=1.5227, trans=0.0122, rot=0.3022, grad=33.76, nan=0]Epoch 29:  47%|████▋     | 24/51 [00:00<00:00, 77.37it/s, loss=1.5641, trans=0.0130, rot=0.2613, grad=41.44, nan=0]Epoch 29:  67%|██████▋   | 34/51 [00:00<00:00, 82.38it/s, loss=1.5641, trans=0.0130, rot=0.2613, grad=41.44, nan=0]Epoch 29:  67%|██████▋   | 34/51 [00:00<00:00, 82.38it/s, loss=1.9169, trans=0.0165, rot=0.2644, grad=44.30, nan=0]Epoch 29:  67%|██████▋   | 34/51 [00:00<00:00, 82.38it/s, loss=1.2293, trans=0.0100, rot=0.2319, grad=26.66, nan=0]Epoch 29:  67%|██████▋   | 34/51 [00:00<00:00, 82.38it/s, loss=1.6966, trans=0.0145, rot=0.2468, grad=37.75, nan=0]Epoch 29:  67%|██████▋   | 34/51 [00:00<00:00, 82.38it/s, loss=1.5206, trans=0.0130, rot=0.2246, grad=51.86, nan=0]Epoch 29:  67%|██████▋   | 34/51 [00:00<00:00, 82.38it/s, loss=1.6723, trans=0.0141, rot=0.2663, grad=33.90, nan=0]Epoch 29:  67%|██████▋   | 34/51 [00:00<00:00, 82.38it/s, loss=1.3158, trans=0.0105, rot=0.2673, grad=34.53, nan=0]Epoch 29:  67%|██████▋   | 34/51 [00:00<00:00, 82.38it/s, loss=1.5066, trans=0.0126, rot=0.2425, grad=28.09, nan=0]Epoch 29:  67%|██████▋   | 34/51 [00:00<00:00, 82.38it/s, loss=1.7519, trans=0.0149, rot=0.2667, grad=43.97, nan=0]Epoch 29:  67%|██████▋   | 34/51 [00:00<00:00, 82.38it/s, loss=1.3412, trans=0.0111, rot=0.2341, grad=35.95, nan=0]Epoch 29:  67%|██████▋   | 34/51 [00:00<00:00, 82.38it/s, loss=1.4965, trans=0.0127, rot=0.2226, grad=24.10, nan=0]Epoch 29:  86%|████████▋ | 44/51 [00:00<00:00, 86.82it/s, loss=1.4965, trans=0.0127, rot=0.2226, grad=24.10, nan=0]Epoch 29:  86%|████████▋ | 44/51 [00:00<00:00, 86.82it/s, loss=1.6699, trans=0.0144, rot=0.2300, grad=40.24, nan=0]Epoch 29:  86%|████████▋ | 44/51 [00:00<00:00, 86.82it/s, loss=1.3429, trans=0.0114, rot=0.2075, grad=31.46, nan=0]Epoch 29:  86%|████████▋ | 44/51 [00:00<00:00, 86.82it/s, loss=1.8966, trans=0.0164, rot=0.2574, grad=82.79, nan=0]Epoch 29:  86%|████████▋ | 44/51 [00:00<00:00, 86.82it/s, loss=1.6072, trans=0.0137, rot=0.2333, grad=32.59, nan=0]Epoch 29:  86%|████████▋ | 44/51 [00:00<00:00, 86.82it/s, loss=1.7166, trans=0.0142, rot=0.2939, grad=25.84, nan=0]Epoch 29:  86%|████████▋ | 44/51 [00:00<00:00, 86.82it/s, loss=1.6383, trans=0.0137, rot=0.2665, grad=25.17, nan=0]Epoch 29:  86%|████████▋ | 44/51 [00:00<00:00, 86.82it/s, loss=1.7459, trans=0.0145, rot=0.2912, grad=80.10, nan=0]Epoch 29: 100%|██████████| 51/51 [00:00<00:00, 82.89it/s, loss=1.7459, trans=0.0145, rot=0.2912, grad=80.10, nan=0]
Visual features - mean: -0.002628, std: 1.043219
IMU features - mean: 0.001516, std: 1.069962
GT translations (m) - mean: -0.001023, std: 0.042018
GT quaternions - mean: 0.248662, std: 0.433952
Predicted pose window shape: (1, 7)
[[-0.06687334 -0.091078    0.3575094  -0.00673418 -0.08718706  0.00106853
  -0.9961686 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.23415713 -0.3259671  -0.06844606 -0.00659302  0.04091021  0.04310112
  -0.99821097]]
  Ground truth relative pose:
[[-0.0030986  -0.01892452 -0.00746529 -0.0282916  -0.0078706  -0.01506797
   0.9994552 ]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 185.47it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 180.29it/s]

Epoch 29 Summary:
  Train Loss: 1.575492
  Val Loss: 0.161543
  Val Trans Error: 0.0636 m
  Val Rot Error: 5.09 degrees
  ✓ New best model saved

============================================================
Epoch 30/50
Learning rate: 0.00000588
============================================================
Epoch 30:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 30:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.3857, trans=0.0116, rot=0.2279, grad=26.65, nan=0]Epoch 30:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.3944, trans=0.0114, rot=0.2537, grad=21.93, nan=0]Epoch 30:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.5663, trans=0.0126, rot=0.3043, grad=22.35, nan=0]Epoch 30:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.7048, trans=0.0147, rot=0.2384, grad=31.75, nan=0]Epoch 30:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.2465, trans=0.0102, rot=0.2238, grad=27.25, nan=0]Epoch 30:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.5102, trans=0.0125, rot=0.2573, grad=33.02, nan=0]Epoch 30:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1482, trans=0.0092, rot=0.2240, grad=31.82, nan=0]Epoch 30:  14%|█▎        | 7/51 [00:00<00:00, 69.10it/s, loss=1.1482, trans=0.0092, rot=0.2240, grad=31.82, nan=0]Epoch 30:  14%|█▎        | 7/51 [00:00<00:00, 69.10it/s, loss=1.3122, trans=0.0112, rot=0.1894, grad=34.94, nan=0]Epoch 30:  14%|█▎        | 7/51 [00:00<00:00, 69.10it/s, loss=1.6472, trans=0.0137, rot=0.2764, grad=25.69, nan=0]Epoch 30:  14%|█▎        | 7/51 [00:00<00:00, 69.10it/s, loss=1.5657, trans=0.0130, rot=0.2617, grad=23.77, nan=0]Epoch 30:  14%|█▎        | 7/51 [00:00<00:00, 69.10it/s, loss=1.4971, trans=0.0123, rot=0.2631, grad=31.32, nan=0]Epoch 30:  14%|█▎        | 7/51 [00:00<00:00, 69.10it/s, loss=1.6974, trans=0.0144, rot=0.2606, grad=68.33, nan=0]Epoch 30:  14%|█▎        | 7/51 [00:00<00:00, 69.10it/s, loss=1.1148, trans=0.0085, rot=0.2693, grad=19.41, nan=0]Epoch 30:  14%|█▎        | 7/51 [00:00<00:00, 69.10it/s, loss=1.2133, trans=0.0096, rot=0.2513, grad=25.40, nan=0]Epoch 30:  14%|█▎        | 7/51 [00:00<00:00, 69.10it/s, loss=1.3718, trans=0.0111, rot=0.2579, grad=28.49, nan=0]Epoch 30:  14%|█▎        | 7/51 [00:00<00:00, 69.10it/s, loss=1.4441, trans=0.0120, rot=0.2471, grad=24.92, nan=0]Epoch 30:  14%|█▎        | 7/51 [00:00<00:00, 69.10it/s, loss=1.3913, trans=0.0117, rot=0.2200, grad=27.10, nan=0]Epoch 30:  33%|███▎      | 17/51 [00:00<00:00, 85.26it/s, loss=1.3913, trans=0.0117, rot=0.2200, grad=27.10, nan=0]Epoch 30:  33%|███▎      | 17/51 [00:00<00:00, 85.26it/s, loss=1.4912, trans=0.0120, rot=0.2883, grad=26.30, nan=0]Epoch 30:  33%|███▎      | 17/51 [00:00<00:00, 85.26it/s, loss=1.2849, trans=0.0102, rot=0.2671, grad=18.81, nan=0]Epoch 30:  33%|███▎      | 17/51 [00:00<00:00, 85.26it/s, loss=1.4464, trans=0.0121, rot=0.2409, grad=20.43, nan=0]Epoch 30:  33%|███▎      | 17/51 [00:00<00:00, 85.26it/s, loss=1.5263, trans=0.0122, rot=0.3022, grad=22.70, nan=0]Epoch 30:  33%|███▎      | 17/51 [00:00<00:00, 85.26it/s, loss=1.5345, trans=0.0127, rot=0.2668, grad=34.59, nan=0]Epoch 30:  33%|███▎      | 17/51 [00:00<00:00, 85.26it/s, loss=1.0128, trans=0.0078, rot=0.2366, grad=29.23, nan=0]Epoch 30:  33%|███▎      | 17/51 [00:00<00:00, 85.26it/s, loss=1.5341, trans=0.0129, rot=0.2490, grad=40.35, nan=0]Epoch 30:  33%|███▎      | 17/51 [00:00<00:00, 85.26it/s, loss=1.3313, trans=0.0108, rot=0.2540, grad=21.75, nan=0]Epoch 30:  33%|███▎      | 17/51 [00:00<00:00, 85.26it/s, loss=1.6813, trans=0.0140, rot=0.2859, grad=24.81, nan=0]Epoch 30:  33%|███▎      | 17/51 [00:00<00:00, 85.26it/s, loss=1.8061, trans=0.0156, rot=0.2489, grad=35.09, nan=0]Epoch 30:  33%|███▎      | 17/51 [00:00<00:00, 85.26it/s, loss=1.5655, trans=0.0135, rot=0.2193, grad=40.66, nan=0]Epoch 30:  55%|█████▍    | 28/51 [00:00<00:00, 94.47it/s, loss=1.5655, trans=0.0135, rot=0.2193, grad=40.66, nan=0]Epoch 30:  55%|█████▍    | 28/51 [00:00<00:00, 94.47it/s, loss=1.6231, trans=0.0139, rot=0.2290, grad=33.56, nan=0]Epoch 30:  55%|█████▍    | 28/51 [00:00<00:00, 94.47it/s, loss=1.5360, trans=0.0126, rot=0.2786, grad=33.75, nan=0]Epoch 30:  55%|█████▍    | 28/51 [00:00<00:00, 94.47it/s, loss=1.3605, trans=0.0111, rot=0.2552, grad=28.45, nan=0]Epoch 30:  55%|█████▍    | 28/51 [00:00<00:00, 94.47it/s, loss=1.3897, trans=0.0114, rot=0.2543, grad=33.11, nan=0]Epoch 30:  55%|█████▍    | 28/51 [00:00<00:00, 94.47it/s, loss=1.6526, trans=0.0140, rot=0.2491, grad=28.13, nan=0]Epoch 30:  55%|█████▍    | 28/51 [00:00<00:00, 94.47it/s, loss=1.4508, trans=0.0121, rot=0.2405, grad=25.06, nan=0]Epoch 30:  55%|█████▍    | 28/51 [00:00<00:00, 94.47it/s, loss=1.5254, trans=0.0132, rot=0.2042, grad=37.98, nan=0]Epoch 30:  55%|█████▍    | 28/51 [00:00<00:00, 94.47it/s, loss=1.7937, trans=0.0152, rot=0.2739, grad=35.18, nan=0]Epoch 30:  55%|█████▍    | 28/51 [00:00<00:00, 94.47it/s, loss=1.5307, trans=0.0122, rot=0.3085, grad=26.62, nan=0]Epoch 30:  55%|█████▍    | 28/51 [00:00<00:00, 94.47it/s, loss=1.3856, trans=0.0112, rot=0.2641, grad=22.98, nan=0]Epoch 30:  55%|█████▍    | 28/51 [00:00<00:00, 94.47it/s, loss=1.1777, trans=0.0097, rot=0.2068, grad=37.93, nan=0]Epoch 30:  76%|███████▋  | 39/51 [00:00<00:00, 99.36it/s, loss=1.1777, trans=0.0097, rot=0.2068, grad=37.93, nan=0]Epoch 30:  76%|███████▋  | 39/51 [00:00<00:00, 99.36it/s, loss=1.2479, trans=0.0102, rot=0.2308, grad=29.61, nan=0]Epoch 30:  76%|███████▋  | 39/51 [00:00<00:00, 99.36it/s, loss=1.5616, trans=0.0131, rot=0.2468, grad=32.43, nan=0]Epoch 30:  76%|███████▋  | 39/51 [00:00<00:00, 99.36it/s, loss=1.6452, trans=0.0141, rot=0.2376, grad=32.22, nan=0]Epoch 30:  76%|███████▋  | 39/51 [00:00<00:00, 99.36it/s, loss=1.6157, trans=0.0135, rot=0.2616, grad=39.53, nan=0]Epoch 30:  76%|███████▋  | 39/51 [00:00<00:00, 99.36it/s, loss=1.2178, trans=0.0097, rot=0.2438, grad=19.17, nan=0]Epoch 30:  76%|███████▋  | 39/51 [00:00<00:00, 99.36it/s, loss=1.5771, trans=0.0132, rot=0.2545, grad=22.27, nan=0]Epoch 30:  76%|███████▋  | 39/51 [00:00<00:00, 99.36it/s, loss=1.3585, trans=0.0108, rot=0.2785, grad=38.70, nan=0]Epoch 30:  76%|███████▋  | 39/51 [00:00<00:00, 99.36it/s, loss=1.3154, trans=0.0109, rot=0.2253, grad=32.18, nan=0]Epoch 30:  76%|███████▋  | 39/51 [00:00<00:00, 99.36it/s, loss=1.3168, trans=0.0107, rot=0.2476, grad=35.50, nan=0]Epoch 30:  76%|███████▋  | 39/51 [00:00<00:00, 99.36it/s, loss=1.3412, trans=0.0111, rot=0.2286, grad=33.90, nan=0]Epoch 30:  76%|███████▋  | 39/51 [00:00<00:00, 99.36it/s, loss=1.3330, trans=0.0106, rot=0.2707, grad=30.28, nan=0]Epoch 30:  98%|█████████▊| 50/51 [00:00<00:00, 101.55it/s, loss=1.3330, trans=0.0106, rot=0.2707, grad=30.28, nan=0]Epoch 30:  98%|█████████▊| 50/51 [00:00<00:00, 101.55it/s, loss=1.0514, trans=0.0078, rot=0.2686, grad=61.07, nan=0]Epoch 30: 100%|██████████| 51/51 [00:00<00:00, 94.80it/s, loss=1.0514, trans=0.0078, rot=0.2686, grad=61.07, nan=0] 
Visual features - mean: 0.002378, std: 0.967580
IMU features - mean: 0.004222, std: 0.962468
GT translations (m) - mean: -0.000211, std: 0.042399
GT quaternions - mean: 0.249093, std: 0.433705
Predicted pose window shape: (1, 7)
[[ 0.0774211   0.07906003 -0.12392747 -0.08877276  0.16652368 -0.01134648
  -0.9819677 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.20641056  0.16582452 -0.10325058 -0.10218655  0.127476    0.08752304
  -0.98267365]]
  Ground truth relative pose:
[[-1.0535880e-03 -6.9459341e-04 -3.5813544e-03 -8.9749701e-05
  -8.6775434e-04  3.4226035e-03  9.9999380e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  82%|████████▏ | 18/22 [00:00<00:00, 174.05it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 165.74it/s]

Epoch 30 Summary:
  Train Loss: 1.439857
  Val Loss: 0.140241
  Val Trans Error: 0.0571 m
  Val Rot Error: 4.95 degrees
  ✓ New best model saved

============================================================
Epoch 31/50
Learning rate: 0.00000588
============================================================
Epoch 31:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 31:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.4688, trans=0.0126, rot=0.2096, grad=20.87, nan=0]Epoch 31:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0571, trans=0.0082, rot=0.2348, grad=30.73, nan=0]Epoch 31:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.3302, trans=0.0109, rot=0.2402, grad=41.31, nan=0]Epoch 31:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1156, trans=0.0089, rot=0.2287, grad=26.59, nan=0]Epoch 31:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0769, trans=0.0085, rot=0.2247, grad=25.82, nan=0]Epoch 31:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.6427, trans=0.0138, rot=0.2669, grad=46.75, nan=0]Epoch 31:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.2652, trans=0.0101, rot=0.2569, grad=33.64, nan=0]Epoch 31:  14%|█▎        | 7/51 [00:00<00:00, 68.60it/s, loss=1.2652, trans=0.0101, rot=0.2569, grad=33.64, nan=0]Epoch 31:  14%|█▎        | 7/51 [00:00<00:00, 68.60it/s, loss=1.8430, trans=0.0158, rot=0.2620, grad=39.20, nan=0]Epoch 31:  14%|█▎        | 7/51 [00:00<00:00, 68.60it/s, loss=1.4925, trans=0.0124, rot=0.2475, grad=33.78, nan=0]Epoch 31:  14%|█▎        | 7/51 [00:00<00:00, 68.60it/s, loss=1.2881, trans=0.0108, rot=0.2039, grad=22.20, nan=0]Epoch 31:  14%|█▎        | 7/51 [00:00<00:00, 68.60it/s, loss=1.6207, trans=0.0136, rot=0.2578, grad=49.47, nan=0]Epoch 31:  14%|█▎        | 7/51 [00:00<00:00, 68.60it/s, loss=1.6782, trans=0.0139, rot=0.2922, grad=38.77, nan=0]Epoch 31:  14%|█▎        | 7/51 [00:00<00:00, 68.60it/s, loss=1.5092, trans=0.0129, rot=0.2206, grad=32.04, nan=0]Epoch 31:  14%|█▎        | 7/51 [00:00<00:00, 68.60it/s, loss=1.3302, trans=0.0109, rot=0.2359, grad=34.47, nan=0]Epoch 31:  14%|█▎        | 7/51 [00:00<00:00, 68.60it/s, loss=1.1234, trans=0.0089, rot=0.2354, grad=26.02, nan=0]Epoch 31:  14%|█▎        | 7/51 [00:00<00:00, 68.60it/s, loss=1.2997, trans=0.0106, rot=0.2376, grad=25.22, nan=0]Epoch 31:  14%|█▎        | 7/51 [00:00<00:00, 68.60it/s, loss=1.3029, trans=0.0105, rot=0.2549, grad=25.17, nan=0]Epoch 31:  33%|███▎      | 17/51 [00:00<00:00, 85.46it/s, loss=1.3029, trans=0.0105, rot=0.2549, grad=25.17, nan=0]Epoch 31:  33%|███▎      | 17/51 [00:00<00:00, 85.46it/s, loss=1.5196, trans=0.0130, rot=0.2172, grad=20.64, nan=0]Epoch 31:  33%|███▎      | 17/51 [00:00<00:00, 85.46it/s, loss=1.3763, trans=0.0111, rot=0.2651, grad=20.41, nan=0]Epoch 31:  33%|███▎      | 17/51 [00:00<00:00, 85.46it/s, loss=1.4944, trans=0.0126, rot=0.2353, grad=36.88, nan=0]Epoch 31:  33%|███▎      | 17/51 [00:00<00:00, 85.46it/s, loss=1.2773, trans=0.0102, rot=0.2547, grad=25.54, nan=0]Epoch 31:  33%|███▎      | 17/51 [00:00<00:00, 85.46it/s, loss=1.2534, trans=0.0099, rot=0.2640, grad=35.90, nan=0]Epoch 31:  33%|███▎      | 17/51 [00:00<00:00, 85.46it/s, loss=1.3963, trans=0.0113, rot=0.2663, grad=45.53, nan=0]Epoch 31:  33%|███▎      | 17/51 [00:00<00:00, 85.46it/s, loss=1.4497, trans=0.0118, rot=0.2655, grad=41.62, nan=0]Epoch 31:  33%|███▎      | 17/51 [00:00<00:00, 85.46it/s, loss=1.4339, trans=0.0114, rot=0.2964, grad=25.37, nan=0]Epoch 31:  33%|███▎      | 17/51 [00:00<00:00, 85.46it/s, loss=1.4183, trans=0.0120, rot=0.2229, grad=25.57, nan=0]Epoch 31:  33%|███▎      | 17/51 [00:00<00:00, 85.46it/s, loss=1.3041, trans=0.0108, rot=0.2275, grad=47.12, nan=0]Epoch 31:  53%|█████▎    | 27/51 [00:00<00:00, 90.04it/s, loss=1.3041, trans=0.0108, rot=0.2275, grad=47.12, nan=0]Epoch 31:  53%|█████▎    | 27/51 [00:00<00:00, 90.04it/s, loss=1.2735, trans=0.0102, rot=0.2504, grad=36.08, nan=0]Epoch 31:  53%|█████▎    | 27/51 [00:00<00:00, 90.04it/s, loss=1.7114, trans=0.0147, rot=0.2457, grad=28.58, nan=0]Epoch 31:  53%|█████▎    | 27/51 [00:00<00:00, 90.04it/s, loss=1.2584, trans=0.0104, rot=0.2162, grad=25.24, nan=0]Epoch 31:  53%|█████▎    | 27/51 [00:00<00:00, 90.04it/s, loss=1.4832, trans=0.0118, rot=0.3004, grad=24.21, nan=0]Epoch 31:  53%|█████▎    | 27/51 [00:00<00:00, 90.04it/s, loss=1.3548, trans=0.0108, rot=0.2780, grad=18.19, nan=0]Epoch 31:  53%|█████▎    | 27/51 [00:00<00:00, 90.04it/s, loss=1.5769, trans=0.0134, rot=0.2369, grad=39.43, nan=0]Epoch 31:  53%|█████▎    | 27/51 [00:00<00:00, 90.04it/s, loss=1.3798, trans=0.0115, rot=0.2265, grad=18.13, nan=0]Epoch 31:  53%|█████▎    | 27/51 [00:00<00:00, 90.04it/s, loss=1.1091, trans=0.0087, rot=0.2352, grad=28.15, nan=0]Epoch 31:  53%|█████▎    | 27/51 [00:00<00:00, 90.04it/s, loss=1.4784, trans=0.0121, rot=0.2687, grad=29.22, nan=0]Epoch 31:  53%|█████▎    | 27/51 [00:00<00:00, 90.04it/s, loss=1.4143, trans=0.0121, rot=0.2070, grad=20.92, nan=0]Epoch 31:  73%|███████▎  | 37/51 [00:00<00:00, 91.96it/s, loss=1.4143, trans=0.0121, rot=0.2070, grad=20.92, nan=0]Epoch 31:  73%|███████▎  | 37/51 [00:00<00:00, 91.96it/s, loss=1.5615, trans=0.0130, rot=0.2652, grad=37.15, nan=0]Epoch 31:  73%|███████▎  | 37/51 [00:00<00:00, 91.96it/s, loss=1.4191, trans=0.0118, rot=0.2426, grad=24.83, nan=0]Epoch 31:  73%|███████▎  | 37/51 [00:00<00:00, 91.96it/s, loss=1.3656, trans=0.0112, rot=0.2427, grad=28.58, nan=0]Epoch 31:  73%|███████▎  | 37/51 [00:00<00:00, 91.96it/s, loss=1.3783, trans=0.0113, rot=0.2480, grad=39.54, nan=0]Epoch 31:  73%|███████▎  | 37/51 [00:00<00:00, 91.96it/s, loss=1.5080, trans=0.0131, rot=0.1944, grad=20.48, nan=0]Epoch 31:  73%|███████▎  | 37/51 [00:00<00:00, 91.96it/s, loss=1.1014, trans=0.0089, rot=0.2112, grad=25.08, nan=0]Epoch 31:  73%|███████▎  | 37/51 [00:00<00:00, 91.96it/s, loss=1.2772, trans=0.0100, rot=0.2785, grad=26.72, nan=0]Epoch 31:  73%|███████▎  | 37/51 [00:00<00:00, 91.96it/s, loss=1.5685, trans=0.0132, rot=0.2450, grad=43.90, nan=0]Epoch 31:  73%|███████▎  | 37/51 [00:00<00:00, 91.96it/s, loss=1.4501, trans=0.0124, rot=0.2125, grad=31.55, nan=0]Epoch 31:  73%|███████▎  | 37/51 [00:00<00:00, 91.96it/s, loss=1.2526, trans=0.0098, rot=0.2702, grad=30.66, nan=0]Epoch 31:  92%|█████████▏| 47/51 [00:00<00:00, 92.94it/s, loss=1.2526, trans=0.0098, rot=0.2702, grad=30.66, nan=0]Epoch 31:  92%|█████████▏| 47/51 [00:00<00:00, 92.94it/s, loss=1.3452, trans=0.0110, rot=0.2428, grad=24.27, nan=0]Epoch 31:  92%|█████████▏| 47/51 [00:00<00:00, 92.94it/s, loss=1.2874, trans=0.0101, rot=0.2763, grad=28.44, nan=0]Epoch 31:  92%|█████████▏| 47/51 [00:00<00:00, 92.94it/s, loss=1.3894, trans=0.0113, rot=0.2621, grad=48.26, nan=0]Epoch 31:  92%|█████████▏| 47/51 [00:00<00:00, 92.94it/s, loss=2.0847, trans=0.0191, rot=0.1796, grad=110.69, nan=0]Epoch 31: 100%|██████████| 51/51 [00:00<00:00, 88.94it/s, loss=2.0847, trans=0.0191, rot=0.1796, grad=110.69, nan=0]
Visual features - mean: -0.000909, std: 0.953336
IMU features - mean: -0.003152, std: 1.003103
GT translations (m) - mean: -0.001418, std: 0.026747
GT quaternions - mean: 0.250287, std: 0.433016
Predicted pose window shape: (1, 7)
[[ 0.03397189 -0.20313233 -0.06303746  0.00906653  0.0553413   0.01008753
  -0.99837536]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.08724052 -0.15439019  0.04136259  0.02336159  0.04258601 -0.06742438
  -0.9965413 ]]
  Ground truth relative pose:
[[-0.00387659  0.00146076 -0.00265262  0.0021036   0.00185392 -0.00225367
   0.99999356]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 189.73it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 180.70it/s]

Epoch 31 Summary:
  Train Loss: 1.399932
  Val Loss: 0.141095
  Val Trans Error: 0.0593 m
  Val Rot Error: 4.83 degrees

============================================================
Epoch 32/50
Learning rate: 0.00000588
============================================================
Epoch 32:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 32:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.3645, trans=0.0116, rot=0.2051, grad=24.39, nan=0]Epoch 32:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.5195, trans=0.0126, rot=0.2570, grad=25.13, nan=0]Epoch 32:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.3728, trans=0.0112, rot=0.2487, grad=23.57, nan=0]Epoch 32:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.6113, trans=0.0136, rot=0.2496, grad=49.16, nan=0]Epoch 32:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.6125, trans=0.0134, rot=0.2705, grad=37.36, nan=0]Epoch 32:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1047, trans=0.0086, rot=0.2450, grad=19.45, nan=0]Epoch 32:  12%|█▏        | 6/51 [00:00<00:00, 58.30it/s, loss=1.1047, trans=0.0086, rot=0.2450, grad=19.45, nan=0]Epoch 32:  12%|█▏        | 6/51 [00:00<00:00, 58.30it/s, loss=1.2610, trans=0.0103, rot=0.2272, grad=23.58, nan=0]Epoch 32:  12%|█▏        | 6/51 [00:00<00:00, 58.30it/s, loss=1.4862, trans=0.0121, rot=0.2809, grad=27.53, nan=0]Epoch 32:  12%|█▏        | 6/51 [00:00<00:00, 58.30it/s, loss=1.2532, trans=0.0105, rot=0.2046, grad=31.53, nan=0]Epoch 32:  12%|█▏        | 6/51 [00:00<00:00, 58.30it/s, loss=1.5240, trans=0.0128, rot=0.2423, grad=42.34, nan=0]Epoch 32:  12%|█▏        | 6/51 [00:00<00:00, 58.30it/s, loss=1.1255, trans=0.0086, rot=0.2675, grad=14.90, nan=0]Epoch 32:  12%|█▏        | 6/51 [00:00<00:00, 58.30it/s, loss=1.4783, trans=0.0124, rot=0.2428, grad=26.59, nan=0]Epoch 32:  12%|█▏        | 6/51 [00:00<00:00, 58.30it/s, loss=1.3986, trans=0.0114, rot=0.2587, grad=20.46, nan=0]Epoch 32:  12%|█▏        | 6/51 [00:00<00:00, 58.30it/s, loss=1.2837, trans=0.0103, rot=0.2585, grad=31.42, nan=0]Epoch 32:  12%|█▏        | 6/51 [00:00<00:00, 58.30it/s, loss=1.2943, trans=0.0106, rot=0.2347, grad=37.61, nan=0]Epoch 32:  12%|█▏        | 6/51 [00:00<00:00, 58.30it/s, loss=1.5865, trans=0.0135, rot=0.2406, grad=37.39, nan=0]Epoch 32:  31%|███▏      | 16/51 [00:00<00:00, 80.44it/s, loss=1.5865, trans=0.0135, rot=0.2406, grad=37.39, nan=0]Epoch 32:  31%|███▏      | 16/51 [00:00<00:00, 80.44it/s, loss=1.3376, trans=0.0107, rot=0.2680, grad=28.33, nan=0]Epoch 32:  31%|███▏      | 16/51 [00:00<00:00, 80.44it/s, loss=1.4876, trans=0.0124, rot=0.2429, grad=21.93, nan=0]Epoch 32:  31%|███▏      | 16/51 [00:00<00:00, 80.44it/s, loss=1.2978, trans=0.0099, rot=0.3047, grad=25.18, nan=0]Epoch 32:  31%|███▏      | 16/51 [00:00<00:00, 80.44it/s, loss=1.0313, trans=0.0081, rot=0.2200, grad=23.54, nan=0]Epoch 32:  31%|███▏      | 16/51 [00:00<00:00, 80.44it/s, loss=1.1825, trans=0.0097, rot=0.2131, grad=20.74, nan=0]Epoch 32:  31%|███▏      | 16/51 [00:00<00:00, 80.44it/s, loss=1.2995, trans=0.0103, rot=0.2714, grad=23.47, nan=0]Epoch 32:  31%|███▏      | 16/51 [00:00<00:00, 80.44it/s, loss=1.1735, trans=0.0095, rot=0.2248, grad=20.35, nan=0]Epoch 32:  31%|███▏      | 16/51 [00:00<00:00, 80.44it/s, loss=1.7203, trans=0.0144, rot=0.2781, grad=26.97, nan=0]Epoch 32:  31%|███▏      | 16/51 [00:00<00:00, 80.44it/s, loss=1.3872, trans=0.0114, rot=0.2484, grad=22.54, nan=0]Epoch 32:  31%|███▏      | 16/51 [00:00<00:00, 80.44it/s, loss=1.5817, trans=0.0135, rot=0.2289, grad=24.64, nan=0]Epoch 32:  51%|█████     | 26/51 [00:00<00:00, 88.57it/s, loss=1.5817, trans=0.0135, rot=0.2289, grad=24.64, nan=0]Epoch 32:  51%|█████     | 26/51 [00:00<00:00, 88.57it/s, loss=1.3236, trans=0.0107, rot=0.2546, grad=28.94, nan=0]Epoch 32:  51%|█████     | 26/51 [00:00<00:00, 88.57it/s, loss=1.1150, trans=0.0087, rot=0.2452, grad=19.40, nan=0]Epoch 32:  51%|█████     | 26/51 [00:00<00:00, 88.57it/s, loss=1.5044, trans=0.0125, rot=0.2551, grad=23.29, nan=0]Epoch 32:  51%|█████     | 26/51 [00:00<00:00, 88.57it/s, loss=1.2881, trans=0.0101, rot=0.2749, grad=20.60, nan=0]Epoch 32:  51%|█████     | 26/51 [00:00<00:00, 88.57it/s, loss=1.2321, trans=0.0095, rot=0.2840, grad=24.72, nan=0]Epoch 32:  51%|█████     | 26/51 [00:00<00:00, 88.57it/s, loss=1.3907, trans=0.0117, rot=0.2238, grad=24.30, nan=0]Epoch 32:  51%|█████     | 26/51 [00:00<00:00, 88.57it/s, loss=1.4881, trans=0.0124, rot=0.2496, grad=26.16, nan=0]Epoch 32:  51%|█████     | 26/51 [00:00<00:00, 88.57it/s, loss=1.2049, trans=0.0099, rot=0.2151, grad=40.80, nan=0]Epoch 32:  51%|█████     | 26/51 [00:00<00:00, 88.57it/s, loss=1.7274, trans=0.0148, rot=0.2507, grad=48.24, nan=0]Epoch 32:  51%|█████     | 26/51 [00:00<00:00, 88.57it/s, loss=1.4817, trans=0.0126, rot=0.2257, grad=47.38, nan=0]Epoch 32:  71%|███████   | 36/51 [00:00<00:00, 90.44it/s, loss=1.4817, trans=0.0126, rot=0.2257, grad=47.38, nan=0]Epoch 32:  71%|███████   | 36/51 [00:00<00:00, 90.44it/s, loss=1.2531, trans=0.0100, rot=0.2556, grad=31.85, nan=0]Epoch 32:  71%|███████   | 36/51 [00:00<00:00, 90.44it/s, loss=1.1247, trans=0.0088, rot=0.2451, grad=21.19, nan=0]Epoch 32:  71%|███████   | 36/51 [00:00<00:00, 90.44it/s, loss=1.1252, trans=0.0087, rot=0.2504, grad=33.64, nan=0]Epoch 32:  71%|███████   | 36/51 [00:00<00:00, 90.44it/s, loss=1.0287, trans=0.0081, rot=0.2224, grad=15.04, nan=0]Epoch 32:  71%|███████   | 36/51 [00:00<00:00, 90.44it/s, loss=1.9331, trans=0.0165, rot=0.2876, grad=39.55, nan=0]Epoch 32:  71%|███████   | 36/51 [00:00<00:00, 90.44it/s, loss=1.1613, trans=0.0088, rot=0.2860, grad=27.35, nan=0]Epoch 32:  71%|███████   | 36/51 [00:00<00:00, 90.44it/s, loss=1.3270, trans=0.0104, rot=0.2882, grad=30.08, nan=0]Epoch 32:  71%|███████   | 36/51 [00:00<00:00, 90.44it/s, loss=1.4606, trans=0.0123, rot=0.2332, grad=33.48, nan=0]Epoch 32:  71%|███████   | 36/51 [00:00<00:00, 90.44it/s, loss=1.4079, trans=0.0115, rot=0.2580, grad=42.52, nan=0]Epoch 32:  71%|███████   | 36/51 [00:00<00:00, 90.44it/s, loss=1.6261, trans=0.0139, rot=0.2410, grad=45.64, nan=0]Epoch 32:  90%|█████████ | 46/51 [00:00<00:00, 92.22it/s, loss=1.6261, trans=0.0139, rot=0.2410, grad=45.64, nan=0]Epoch 32:  90%|█████████ | 46/51 [00:00<00:00, 92.22it/s, loss=1.3910, trans=0.0120, rot=0.1919, grad=35.32, nan=0]Epoch 32:  90%|█████████ | 46/51 [00:00<00:00, 92.22it/s, loss=1.0797, trans=0.0088, rot=0.1981, grad=16.94, nan=0]Epoch 32:  90%|█████████ | 46/51 [00:00<00:00, 92.22it/s, loss=1.2587, trans=0.0104, rot=0.2139, grad=35.93, nan=0]Epoch 32:  90%|█████████ | 46/51 [00:00<00:00, 92.22it/s, loss=1.1319, trans=0.0092, rot=0.2119, grad=29.06, nan=0]Epoch 32:  90%|█████████ | 46/51 [00:00<00:00, 92.22it/s, loss=1.0534, trans=0.0084, rot=0.2096, grad=42.03, nan=0]Epoch 32: 100%|██████████| 51/51 [00:00<00:00, 87.50it/s, loss=1.0534, trans=0.0084, rot=0.2096, grad=42.03, nan=0]
Visual features - mean: -0.000534, std: 1.068871
IMU features - mean: -0.001632, std: 0.917211
GT translations (m) - mean: 0.001043, std: 0.034901
GT quaternions - mean: 0.251146, std: 0.432518
Predicted pose window shape: (1, 7)
[[-0.29773173 -0.10615817  0.01007457 -0.0136641  -0.01910843  0.08434756
  -0.9961595 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.05102731 -0.10399315 -0.03429622  0.05212719 -0.02358765  0.01888151
  -0.99818325]]
  Ground truth relative pose:
[[-0.00615555 -0.00256731 -0.00523435 -0.00565619  0.00438987 -0.00702804
   0.9999497 ]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  82%|████████▏ | 18/22 [00:00<00:00, 179.26it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 177.07it/s]

Epoch 32 Summary:
  Train Loss: 1.350861
  Val Loss: 0.147328
  Val Trans Error: 0.0638 m
  Val Rot Error: 4.65 degrees

============================================================
Epoch 33/50
Learning rate: 0.00000588
============================================================
Epoch 33:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 33:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1299, trans=0.0088, rot=0.2498, grad=32.96, nan=0]Epoch 33:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.6262, trans=0.0139, rot=0.2384, grad=38.86, nan=0]Epoch 33:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0939, trans=0.0087, rot=0.2197, grad=24.88, nan=0]Epoch 33:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.3972, trans=0.0116, rot=0.2401, grad=25.36, nan=0]Epoch 33:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1895, trans=0.0095, rot=0.2443, grad=19.13, nan=0]Epoch 33:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.6935, trans=0.0141, rot=0.2879, grad=50.72, nan=0]Epoch 33:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.2521, trans=0.0101, rot=0.2385, grad=32.10, nan=0]Epoch 33:  14%|█▎        | 7/51 [00:00<00:00, 64.44it/s, loss=1.2521, trans=0.0101, rot=0.2385, grad=32.10, nan=0]Epoch 33:  14%|█▎        | 7/51 [00:00<00:00, 64.44it/s, loss=1.7837, trans=0.0156, rot=0.2232, grad=20.81, nan=0]Epoch 33:  14%|█▎        | 7/51 [00:00<00:00, 64.44it/s, loss=1.0354, trans=0.0082, rot=0.2121, grad=28.83, nan=0]Epoch 33:  14%|█▎        | 7/51 [00:00<00:00, 64.44it/s, loss=1.1991, trans=0.0095, rot=0.2520, grad=21.71, nan=0]Epoch 33:  14%|█▎        | 7/51 [00:00<00:00, 64.44it/s, loss=1.3019, trans=0.0104, rot=0.2602, grad=26.07, nan=0]Epoch 33:  14%|█▎        | 7/51 [00:00<00:00, 64.44it/s, loss=1.4203, trans=0.0115, rot=0.2748, grad=35.40, nan=0]Epoch 33:  14%|█▎        | 7/51 [00:00<00:00, 64.44it/s, loss=1.1611, trans=0.0093, rot=0.2350, grad=25.57, nan=0]Epoch 33:  14%|█▎        | 7/51 [00:00<00:00, 64.44it/s, loss=1.1372, trans=0.0089, rot=0.2503, grad=20.52, nan=0]Epoch 33:  14%|█▎        | 7/51 [00:00<00:00, 64.44it/s, loss=1.3237, trans=0.0106, rot=0.2614, grad=42.54, nan=0]Epoch 33:  14%|█▎        | 7/51 [00:00<00:00, 64.44it/s, loss=1.5584, trans=0.0127, rot=0.2860, grad=26.42, nan=0]Epoch 33:  14%|█▎        | 7/51 [00:00<00:00, 64.44it/s, loss=1.3062, trans=0.0107, rot=0.2337, grad=38.93, nan=0]Epoch 33:  33%|███▎      | 17/51 [00:00<00:00, 81.25it/s, loss=1.3062, trans=0.0107, rot=0.2337, grad=38.93, nan=0]Epoch 33:  33%|███▎      | 17/51 [00:00<00:00, 81.25it/s, loss=1.6108, trans=0.0136, rot=0.2459, grad=35.42, nan=0]Epoch 33:  33%|███▎      | 17/51 [00:00<00:00, 81.25it/s, loss=1.3103, trans=0.0104, rot=0.2710, grad=30.08, nan=0]Epoch 33:  33%|███▎      | 17/51 [00:00<00:00, 81.25it/s, loss=1.5076, trans=0.0123, rot=0.2728, grad=30.51, nan=0]Epoch 33:  33%|███▎      | 17/51 [00:00<00:00, 81.25it/s, loss=1.5179, trans=0.0127, rot=0.2485, grad=27.36, nan=0]Epoch 33:  33%|███▎      | 17/51 [00:00<00:00, 81.25it/s, loss=1.1601, trans=0.0093, rot=0.2310, grad=23.01, nan=0]Epoch 33:  33%|███▎      | 17/51 [00:00<00:00, 81.25it/s, loss=1.2970, trans=0.0103, rot=0.2621, grad=25.94, nan=0]Epoch 33:  33%|███▎      | 17/51 [00:00<00:00, 81.25it/s, loss=1.2191, trans=0.0101, rot=0.2072, grad=29.12, nan=0]Epoch 33:  33%|███▎      | 17/51 [00:00<00:00, 81.25it/s, loss=1.5325, trans=0.0131, rot=0.2256, grad=32.52, nan=0]Epoch 33:  33%|███▎      | 17/51 [00:00<00:00, 81.25it/s, loss=1.5741, trans=0.0130, rot=0.2757, grad=42.14, nan=0]Epoch 33:  51%|█████     | 26/51 [00:00<00:00, 82.88it/s, loss=1.5741, trans=0.0130, rot=0.2757, grad=42.14, nan=0]Epoch 33:  51%|█████     | 26/51 [00:00<00:00, 82.88it/s, loss=1.1234, trans=0.0085, rot=0.2704, grad=17.61, nan=0]Epoch 33:  51%|█████     | 26/51 [00:00<00:00, 82.88it/s, loss=1.3213, trans=0.0111, rot=0.2116, grad=28.16, nan=0]Epoch 33:  51%|█████     | 26/51 [00:00<00:00, 82.88it/s, loss=1.0703, trans=0.0085, rot=0.2219, grad=35.30, nan=0]Epoch 33:  51%|█████     | 26/51 [00:00<00:00, 82.88it/s, loss=1.5236, trans=0.0130, rot=0.2213, grad=33.15, nan=0]Epoch 33:  51%|█████     | 26/51 [00:00<00:00, 82.88it/s, loss=1.2461, trans=0.0102, rot=0.2300, grad=41.78, nan=0]Epoch 33:  51%|█████     | 26/51 [00:00<00:00, 82.88it/s, loss=1.1818, trans=0.0092, rot=0.2580, grad=21.20, nan=0]Epoch 33:  51%|█████     | 26/51 [00:00<00:00, 82.88it/s, loss=1.1762, trans=0.0091, rot=0.2688, grad=23.96, nan=0]Epoch 33:  51%|█████     | 26/51 [00:00<00:00, 82.88it/s, loss=1.3007, trans=0.0109, rot=0.2138, grad=26.87, nan=0]Epoch 33:  51%|█████     | 26/51 [00:00<00:00, 82.88it/s, loss=1.0791, trans=0.0089, rot=0.1851, grad=20.28, nan=0]Epoch 33:  51%|█████     | 26/51 [00:00<00:00, 82.88it/s, loss=1.1322, trans=0.0089, rot=0.2403, grad=19.21, nan=0]Epoch 33:  71%|███████   | 36/51 [00:00<00:00, 87.38it/s, loss=1.1322, trans=0.0089, rot=0.2403, grad=19.21, nan=0]Epoch 33:  71%|███████   | 36/51 [00:00<00:00, 87.38it/s, loss=1.1823, trans=0.0095, rot=0.2321, grad=27.91, nan=0]Epoch 33:  71%|███████   | 36/51 [00:00<00:00, 87.38it/s, loss=1.3835, trans=0.0112, rot=0.2661, grad=21.27, nan=0]Epoch 33:  71%|███████   | 36/51 [00:00<00:00, 87.38it/s, loss=0.9414, trans=0.0070, rot=0.2428, grad=23.46, nan=0]Epoch 33:  71%|███████   | 36/51 [00:00<00:00, 87.38it/s, loss=1.1378, trans=0.0091, rot=0.2256, grad=35.39, nan=0]Epoch 33:  71%|███████   | 36/51 [00:00<00:00, 87.38it/s, loss=1.1497, trans=0.0085, rot=0.2987, grad=15.19, nan=0]Epoch 33:  71%|███████   | 36/51 [00:00<00:00, 87.38it/s, loss=1.1230, trans=0.0087, rot=0.2508, grad=19.45, nan=0]Epoch 33:  71%|███████   | 36/51 [00:00<00:00, 87.38it/s, loss=1.3334, trans=0.0108, rot=0.2570, grad=22.12, nan=0]Epoch 33:  71%|███████   | 36/51 [00:00<00:00, 87.38it/s, loss=1.3653, trans=0.0111, rot=0.2593, grad=27.92, nan=0]Epoch 33:  71%|███████   | 36/51 [00:00<00:00, 87.38it/s, loss=1.3895, trans=0.0113, rot=0.2594, grad=31.29, nan=0]Epoch 33:  71%|███████   | 36/51 [00:00<00:00, 87.38it/s, loss=1.3510, trans=0.0115, rot=0.1995, grad=29.98, nan=0]Epoch 33:  90%|█████████ | 46/51 [00:00<00:00, 88.78it/s, loss=1.3510, trans=0.0115, rot=0.1995, grad=29.98, nan=0]Epoch 33:  90%|█████████ | 46/51 [00:00<00:00, 88.78it/s, loss=1.0643, trans=0.0081, rot=0.2505, grad=19.23, nan=0]Epoch 33:  90%|█████████ | 46/51 [00:00<00:00, 88.78it/s, loss=1.0712, trans=0.0084, rot=0.2345, grad=34.09, nan=0]Epoch 33:  90%|█████████ | 46/51 [00:00<00:00, 88.78it/s, loss=1.1160, trans=0.0089, rot=0.2222, grad=27.23, nan=0]Epoch 33:  90%|█████████ | 46/51 [00:00<00:00, 88.78it/s, loss=1.0328, trans=0.0081, rot=0.2268, grad=21.45, nan=0]Epoch 33:  90%|█████████ | 46/51 [00:00<00:00, 88.78it/s, loss=1.4837, trans=0.0123, rot=0.2536, grad=87.53, nan=0]Epoch 33: 100%|██████████| 51/51 [00:00<00:00, 84.70it/s, loss=1.4837, trans=0.0123, rot=0.2536, grad=87.53, nan=0]
Visual features - mean: 0.004343, std: 0.983101
IMU features - mean: 0.002152, std: 0.872158
GT translations (m) - mean: -0.000295, std: 0.022755
GT quaternions - mean: 0.249107, std: 0.433696
Predicted pose window shape: (1, 7)
[[-0.0016067  -0.14478354 -0.11413214 -0.08285255 -0.02001959 -0.02242253
  -0.9961084 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.3517768   0.07434088 -0.10939624  0.05661535 -0.03090008 -0.02368482
  -0.9976367 ]]
  Ground truth relative pose:
[[-6.3603022e-04 -4.8676273e-05 -5.8628805e-04 -5.8386326e-03
   6.3937306e-03 -1.0876935e-03  9.9996197e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  82%|████████▏ | 18/22 [00:00<00:00, 176.37it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 166.13it/s]

Epoch 33 Summary:
  Train Loss: 1.286634
  Val Loss: 0.141629
  Val Trans Error: 0.0604 m
  Val Rot Error: 4.61 degrees

============================================================
Epoch 34/50
Learning rate: 0.00000588
============================================================
Epoch 34:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 34:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.3575, trans=0.0114, rot=0.2191, grad=25.09, nan=0]Epoch 34:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1779, trans=0.0094, rot=0.2426, grad=17.02, nan=0]Epoch 34:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.3310, trans=0.0111, rot=0.2167, grad=30.92, nan=0]Epoch 34:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9402, trans=0.0070, rot=0.2443, grad=20.19, nan=0]Epoch 34:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.3011, trans=0.0103, rot=0.2732, grad=17.01, nan=0]Epoch 34:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1334, trans=0.0092, rot=0.2145, grad=24.71, nan=0]Epoch 34:  12%|█▏        | 6/51 [00:00<00:00, 58.76it/s, loss=1.1334, trans=0.0092, rot=0.2145, grad=24.71, nan=0]Epoch 34:  12%|█▏        | 6/51 [00:00<00:00, 58.76it/s, loss=1.1674, trans=0.0095, rot=0.2170, grad=21.28, nan=0]Epoch 34:  12%|█▏        | 6/51 [00:00<00:00, 58.76it/s, loss=1.1248, trans=0.0088, rot=0.2425, grad=33.91, nan=0]Epoch 34:  12%|█▏        | 6/51 [00:00<00:00, 58.76it/s, loss=1.1837, trans=0.0096, rot=0.2211, grad=21.87, nan=0]Epoch 34:  12%|█▏        | 6/51 [00:00<00:00, 58.76it/s, loss=1.3921, trans=0.0114, rot=0.2563, grad=30.13, nan=0]Epoch 34:  12%|█▏        | 6/51 [00:00<00:00, 58.76it/s, loss=1.1830, trans=0.0095, rot=0.2288, grad=28.28, nan=0]Epoch 34:  12%|█▏        | 6/51 [00:00<00:00, 58.76it/s, loss=1.1169, trans=0.0090, rot=0.2141, grad=29.96, nan=0]Epoch 34:  12%|█▏        | 6/51 [00:00<00:00, 58.76it/s, loss=1.3531, trans=0.0112, rot=0.2287, grad=24.89, nan=0]Epoch 34:  12%|█▏        | 6/51 [00:00<00:00, 58.76it/s, loss=1.1782, trans=0.0092, rot=0.2631, grad=18.85, nan=0]Epoch 34:  12%|█▏        | 6/51 [00:00<00:00, 58.76it/s, loss=1.2548, trans=0.0098, rot=0.2777, grad=25.49, nan=0]Epoch 34:  12%|█▏        | 6/51 [00:00<00:00, 58.76it/s, loss=1.0372, trans=0.0083, rot=0.2028, grad=28.37, nan=0]Epoch 34:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=1.0372, trans=0.0083, rot=0.2028, grad=28.37, nan=0]Epoch 34:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=1.2211, trans=0.0098, rot=0.2417, grad=25.07, nan=0]Epoch 34:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=1.0070, trans=0.0076, rot=0.2465, grad=15.53, nan=0]Epoch 34:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=1.2339, trans=0.0102, rot=0.2115, grad=17.07, nan=0]Epoch 34:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=1.4407, trans=0.0120, rot=0.2442, grad=34.27, nan=0]Epoch 34:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=1.4222, trans=0.0118, rot=0.2440, grad=37.69, nan=0]Epoch 34:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=1.3160, trans=0.0107, rot=0.2509, grad=24.79, nan=0]Epoch 34:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=1.2168, trans=0.0096, rot=0.2573, grad=27.40, nan=0]Epoch 34:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=1.3851, trans=0.0115, rot=0.2349, grad=26.95, nan=0]Epoch 34:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=1.3662, trans=0.0110, rot=0.2637, grad=17.86, nan=0]Epoch 34:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=0.9562, trans=0.0073, rot=0.2254, grad=23.60, nan=0]Epoch 34:  51%|█████     | 26/51 [00:00<00:00, 87.09it/s, loss=0.9562, trans=0.0073, rot=0.2254, grad=23.60, nan=0]Epoch 34:  51%|█████     | 26/51 [00:00<00:00, 87.09it/s, loss=1.3202, trans=0.0108, rot=0.2368, grad=21.95, nan=0]Epoch 34:  51%|█████     | 26/51 [00:00<00:00, 87.09it/s, loss=1.0172, trans=0.0079, rot=0.2260, grad=23.24, nan=0]Epoch 34:  51%|█████     | 26/51 [00:00<00:00, 87.09it/s, loss=1.2874, trans=0.0106, rot=0.2283, grad=17.46, nan=0]Epoch 34:  51%|█████     | 26/51 [00:00<00:00, 87.09it/s, loss=1.4708, trans=0.0124, rot=0.2324, grad=31.36, nan=0]Epoch 34:  51%|█████     | 26/51 [00:00<00:00, 87.09it/s, loss=1.2639, trans=0.0106, rot=0.2045, grad=33.01, nan=0]Epoch 34:  51%|█████     | 26/51 [00:00<00:00, 87.09it/s, loss=1.2089, trans=0.0100, rot=0.2091, grad=36.06, nan=0]Epoch 34:  51%|█████     | 26/51 [00:00<00:00, 87.09it/s, loss=1.1502, trans=0.0093, rot=0.2189, grad=28.44, nan=0]Epoch 34:  51%|█████     | 26/51 [00:00<00:00, 87.09it/s, loss=1.3192, trans=0.0108, rot=0.2404, grad=25.20, nan=0]Epoch 34:  51%|█████     | 26/51 [00:00<00:00, 87.09it/s, loss=1.3282, trans=0.0109, rot=0.2343, grad=22.08, nan=0]Epoch 34:  51%|█████     | 26/51 [00:00<00:00, 87.09it/s, loss=1.0632, trans=0.0084, rot=0.2214, grad=34.93, nan=0]Epoch 34:  71%|███████   | 36/51 [00:00<00:00, 90.49it/s, loss=1.0632, trans=0.0084, rot=0.2214, grad=34.93, nan=0]Epoch 34:  71%|███████   | 36/51 [00:00<00:00, 90.49it/s, loss=1.3696, trans=0.0113, rot=0.2393, grad=30.60, nan=0]Epoch 34:  71%|███████   | 36/51 [00:00<00:00, 90.49it/s, loss=1.6076, trans=0.0132, rot=0.2859, grad=40.74, nan=0]Epoch 34:  71%|███████   | 36/51 [00:00<00:00, 90.49it/s, loss=1.0197, trans=0.0079, rot=0.2327, grad=21.01, nan=0]Epoch 34:  71%|███████   | 36/51 [00:00<00:00, 90.49it/s, loss=1.2218, trans=0.0098, rot=0.2414, grad=35.19, nan=0]Epoch 34:  71%|███████   | 36/51 [00:00<00:00, 90.49it/s, loss=1.2567, trans=0.0101, rot=0.2471, grad=15.01, nan=0]Epoch 34:  71%|███████   | 36/51 [00:00<00:00, 90.49it/s, loss=1.0030, trans=0.0077, rot=0.2325, grad=13.22, nan=0]Epoch 34:  71%|███████   | 36/51 [00:00<00:00, 90.49it/s, loss=1.1498, trans=0.0092, rot=0.2279, grad=28.47, nan=0]Epoch 34:  71%|███████   | 36/51 [00:00<00:00, 90.49it/s, loss=1.2247, trans=0.0095, rot=0.2748, grad=16.51, nan=0]Epoch 34:  71%|███████   | 36/51 [00:00<00:00, 90.49it/s, loss=1.5006, trans=0.0120, rot=0.3003, grad=20.56, nan=0]Epoch 34:  71%|███████   | 36/51 [00:00<00:00, 90.49it/s, loss=1.2566, trans=0.0103, rot=0.2260, grad=27.01, nan=0]Epoch 34:  90%|█████████ | 46/51 [00:00<00:00, 92.20it/s, loss=1.2566, trans=0.0103, rot=0.2260, grad=27.01, nan=0]Epoch 34:  90%|█████████ | 46/51 [00:00<00:00, 92.20it/s, loss=1.4297, trans=0.0118, rot=0.2476, grad=30.86, nan=0]Epoch 34:  90%|█████████ | 46/51 [00:00<00:00, 92.20it/s, loss=1.3159, trans=0.0107, rot=0.2504, grad=20.51, nan=0]Epoch 34:  90%|█████████ | 46/51 [00:00<00:00, 92.20it/s, loss=1.2550, trans=0.0104, rot=0.2178, grad=37.28, nan=0]Epoch 34:  90%|█████████ | 46/51 [00:00<00:00, 92.20it/s, loss=1.3524, trans=0.0112, rot=0.2350, grad=29.73, nan=0]Epoch 34:  90%|█████████ | 46/51 [00:00<00:00, 92.20it/s, loss=0.6853, trans=0.0046, rot=0.2297, grad=51.19, nan=0]Epoch 34: 100%|██████████| 51/51 [00:00<00:00, 86.21it/s, loss=0.6853, trans=0.0046, rot=0.2297, grad=51.19, nan=0]
Visual features - mean: -0.001008, std: 1.001890
IMU features - mean: 0.009059, std: 0.775313
GT translations (m) - mean: 0.000761, std: 0.018611
GT quaternions - mean: 0.248232, std: 0.434198
Predicted pose window shape: (1, 7)
[[-0.14879262  0.10700773  0.2842087   0.00637609  0.00836652  0.10658319
  -0.99424815]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.1667185  -0.07162561 -0.1768038  -0.07291514 -0.04934266  0.18346831
  -0.9790751 ]]
  Ground truth relative pose:
[[-3.1310508e-03 -1.2029409e-03  3.7408620e-04 -9.9374959e-03
  -6.5919762e-03 -3.1019303e-03  9.9992412e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  91%|█████████ | 20/22 [00:00<00:00, 195.36it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 175.16it/s]

Epoch 34 Summary:
  Train Loss: 1.232844
  Val Loss: 0.130402
  Val Trans Error: 0.0549 m
  Val Rot Error: 4.60 degrees
  ✓ New best model saved

============================================================
Epoch 35/50
Learning rate: 0.00000588
============================================================
Epoch 35:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 35:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1272, trans=0.0093, rot=0.2004, grad=31.88, nan=0]Epoch 35:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1195, trans=0.0091, rot=0.2049, grad=26.30, nan=0]Epoch 35:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1787, trans=0.0092, rot=0.2586, grad=18.05, nan=0]Epoch 35:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.2296, trans=0.0097, rot=0.2603, grad=18.76, nan=0]Epoch 35:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0570, trans=0.0080, rot=0.2560, grad=27.24, nan=0]Epoch 35:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1057, trans=0.0089, rot=0.2180, grad=16.31, nan=0]Epoch 35:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9970, trans=0.0080, rot=0.1981, grad=28.53, nan=0]Epoch 35:  14%|█▎        | 7/51 [00:00<00:00, 64.05it/s, loss=0.9970, trans=0.0080, rot=0.1981, grad=28.53, nan=0]Epoch 35:  14%|█▎        | 7/51 [00:00<00:00, 64.05it/s, loss=1.2626, trans=0.0105, rot=0.2123, grad=24.45, nan=0]Epoch 35:  14%|█▎        | 7/51 [00:00<00:00, 64.05it/s, loss=1.3124, trans=0.0105, rot=0.2594, grad=28.17, nan=0]Epoch 35:  14%|█▎        | 7/51 [00:00<00:00, 64.05it/s, loss=1.1751, trans=0.0095, rot=0.2272, grad=32.37, nan=0]Epoch 35:  14%|█▎        | 7/51 [00:00<00:00, 64.05it/s, loss=1.2410, trans=0.0101, rot=0.2353, grad=19.05, nan=0]Epoch 35:  14%|█▎        | 7/51 [00:00<00:00, 64.05it/s, loss=1.0831, trans=0.0091, rot=0.1773, grad=39.36, nan=0]Epoch 35:  14%|█▎        | 7/51 [00:00<00:00, 64.05it/s, loss=1.3588, trans=0.0112, rot=0.2344, grad=42.49, nan=0]Epoch 35:  14%|█▎        | 7/51 [00:00<00:00, 64.05it/s, loss=1.1746, trans=0.0095, rot=0.2290, grad=34.28, nan=0]Epoch 35:  14%|█▎        | 7/51 [00:00<00:00, 64.05it/s, loss=1.3475, trans=0.0112, rot=0.2230, grad=26.64, nan=0]Epoch 35:  14%|█▎        | 7/51 [00:00<00:00, 64.05it/s, loss=1.4505, trans=0.0120, rot=0.2530, grad=52.92, nan=0]Epoch 35:  14%|█▎        | 7/51 [00:00<00:00, 64.05it/s, loss=1.1934, trans=0.0097, rot=0.2277, grad=23.56, nan=0]Epoch 35:  33%|███▎      | 17/51 [00:00<00:00, 84.15it/s, loss=1.1934, trans=0.0097, rot=0.2277, grad=23.56, nan=0]Epoch 35:  33%|███▎      | 17/51 [00:00<00:00, 84.15it/s, loss=1.1094, trans=0.0086, rot=0.2489, grad=25.03, nan=0]Epoch 35:  33%|███▎      | 17/51 [00:00<00:00, 84.15it/s, loss=1.1949, trans=0.0096, rot=0.2343, grad=30.33, nan=0]Epoch 35:  33%|███▎      | 17/51 [00:00<00:00, 84.15it/s, loss=1.1057, trans=0.0092, rot=0.1870, grad=45.62, nan=0]Epoch 35:  33%|███▎      | 17/51 [00:00<00:00, 84.15it/s, loss=1.4175, trans=0.0115, rot=0.2657, grad=22.99, nan=0]Epoch 35:  33%|███▎      | 17/51 [00:00<00:00, 84.15it/s, loss=1.0916, trans=0.0086, rot=0.2341, grad=20.71, nan=0]Epoch 35:  33%|███▎      | 17/51 [00:00<00:00, 84.15it/s, loss=1.4750, trans=0.0125, rot=0.2206, grad=39.63, nan=0]Epoch 35:  33%|███▎      | 17/51 [00:00<00:00, 84.15it/s, loss=1.4988, trans=0.0123, rot=0.2649, grad=22.84, nan=0]Epoch 35:  33%|███▎      | 17/51 [00:00<00:00, 84.15it/s, loss=1.1900, trans=0.0099, rot=0.2010, grad=29.64, nan=0]Epoch 35:  33%|███▎      | 17/51 [00:00<00:00, 84.15it/s, loss=1.1611, trans=0.0091, rot=0.2476, grad=24.39, nan=0]Epoch 35:  51%|█████     | 26/51 [00:00<00:00, 82.10it/s, loss=1.1611, trans=0.0091, rot=0.2476, grad=24.39, nan=0]Epoch 35:  51%|█████     | 26/51 [00:00<00:00, 82.10it/s, loss=1.0205, trans=0.0080, rot=0.2195, grad=33.36, nan=0]Epoch 35:  51%|█████     | 26/51 [00:00<00:00, 82.10it/s, loss=1.3001, trans=0.0109, rot=0.2131, grad=26.14, nan=0]Epoch 35:  51%|█████     | 26/51 [00:00<00:00, 82.10it/s, loss=1.2868, trans=0.0109, rot=0.1991, grad=43.84, nan=0]Epoch 35:  51%|█████     | 26/51 [00:00<00:00, 82.10it/s, loss=1.2964, trans=0.0108, rot=0.2204, grad=31.69, nan=0]Epoch 35:  51%|█████     | 26/51 [00:00<00:00, 82.10it/s, loss=1.3368, trans=0.0111, rot=0.2221, grad=48.98, nan=0]Epoch 35:  51%|█████     | 26/51 [00:00<00:00, 82.10it/s, loss=1.2231, trans=0.0097, rot=0.2550, grad=33.86, nan=0]Epoch 35:  51%|█████     | 26/51 [00:00<00:00, 82.10it/s, loss=1.3379, trans=0.0105, rot=0.2876, grad=25.89, nan=0]Epoch 35:  51%|█████     | 26/51 [00:00<00:00, 82.10it/s, loss=1.2937, trans=0.0106, rot=0.2312, grad=35.44, nan=0]Epoch 35:  51%|█████     | 26/51 [00:00<00:00, 82.10it/s, loss=1.0958, trans=0.0087, rot=0.2275, grad=17.08, nan=0]Epoch 35:  69%|██████▊   | 35/51 [00:00<00:00, 81.59it/s, loss=1.0958, trans=0.0087, rot=0.2275, grad=17.08, nan=0]Epoch 35:  69%|██████▊   | 35/51 [00:00<00:00, 81.59it/s, loss=1.2624, trans=0.0099, rot=0.2690, grad=38.90, nan=0]Epoch 35:  69%|██████▊   | 35/51 [00:00<00:00, 81.59it/s, loss=1.3464, trans=0.0110, rot=0.2511, grad=35.73, nan=0]Epoch 35:  69%|██████▊   | 35/51 [00:00<00:00, 81.59it/s, loss=1.2117, trans=0.0096, rot=0.2567, grad=16.10, nan=0]Epoch 35:  69%|██████▊   | 35/51 [00:00<00:00, 81.59it/s, loss=1.2496, trans=0.0102, rot=0.2332, grad=41.09, nan=0]Epoch 35:  69%|██████▊   | 35/51 [00:00<00:00, 81.59it/s, loss=0.9130, trans=0.0068, rot=0.2295, grad=24.72, nan=0]Epoch 35:  69%|██████▊   | 35/51 [00:00<00:00, 81.59it/s, loss=1.1026, trans=0.0090, rot=0.2071, grad=17.97, nan=0]Epoch 35:  69%|██████▊   | 35/51 [00:00<00:00, 81.59it/s, loss=1.0468, trans=0.0082, rot=0.2287, grad=20.59, nan=0]Epoch 35:  69%|██████▊   | 35/51 [00:00<00:00, 81.59it/s, loss=1.0856, trans=0.0089, rot=0.1984, grad=39.17, nan=0]Epoch 35:  69%|██████▊   | 35/51 [00:00<00:00, 81.59it/s, loss=1.1237, trans=0.0088, rot=0.2442, grad=33.14, nan=0]Epoch 35:  69%|██████▊   | 35/51 [00:00<00:00, 81.59it/s, loss=1.1396, trans=0.0093, rot=0.2138, grad=37.42, nan=0]Epoch 35:  88%|████████▊ | 45/51 [00:00<00:00, 85.00it/s, loss=1.1396, trans=0.0093, rot=0.2138, grad=37.42, nan=0]Epoch 35:  88%|████████▊ | 45/51 [00:00<00:00, 85.00it/s, loss=1.3995, trans=0.0116, rot=0.2440, grad=29.33, nan=0]Epoch 35:  88%|████████▊ | 45/51 [00:00<00:00, 85.00it/s, loss=1.2289, trans=0.0099, rot=0.2433, grad=36.94, nan=0]Epoch 35:  88%|████████▊ | 45/51 [00:00<00:00, 85.00it/s, loss=0.9694, trans=0.0075, rot=0.2231, grad=25.09, nan=0]Epoch 35:  88%|████████▊ | 45/51 [00:00<00:00, 85.00it/s, loss=0.9597, trans=0.0074, rot=0.2180, grad=22.76, nan=0]Epoch 35:  88%|████████▊ | 45/51 [00:00<00:00, 85.00it/s, loss=1.1848, trans=0.0096, rot=0.2234, grad=36.71, nan=0]Epoch 35:  88%|████████▊ | 45/51 [00:00<00:00, 85.00it/s, loss=1.2873, trans=0.0107, rot=0.2189, grad=56.81, nan=0]Epoch 35: 100%|██████████| 51/51 [00:00<00:00, 81.93it/s, loss=1.2873, trans=0.0107, rot=0.2189, grad=56.81, nan=0]
Visual features - mean: -0.000988, std: 0.950151
IMU features - mean: -0.009515, std: 0.975506
GT translations (m) - mean: -0.000364, std: 0.026340
GT quaternions - mean: 0.250957, std: 0.432628
Predicted pose window shape: (1, 7)
[[-0.07703683  0.01403759  0.19981736  0.04220658 -0.00386011 -0.06694002
  -0.99685645]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.00815577  0.26775298 -0.13166478  0.02798822  0.04822869  0.13262954
  -0.98959595]]
  Ground truth relative pose:
[[ 2.3843398e-04 -1.4436251e-04 -3.0912540e-04 -2.2533537e-04
  -6.7627436e-04  1.2231619e-03  9.9999899e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  82%|████████▏ | 18/22 [00:00<00:00, 176.16it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 175.26it/s]

Epoch 35 Summary:
  Train Loss: 1.203136
  Val Loss: 0.135109
  Val Trans Error: 0.0595 m
  Val Rot Error: 4.29 degrees

============================================================
Epoch 36/50
Learning rate: 0.00000588
============================================================
Epoch 36:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 36:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1660, trans=0.0088, rot=0.2812, grad=24.65, nan=0]Epoch 36:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.2052, trans=0.0096, rot=0.2417, grad=34.52, nan=0]Epoch 36:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.2348, trans=0.0100, rot=0.2349, grad=39.78, nan=0]Epoch 36:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.3223, trans=0.0108, rot=0.2454, grad=25.02, nan=0]Epoch 36:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.2259, trans=0.0100, rot=0.2294, grad=34.94, nan=0]Epoch 36:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0982, trans=0.0088, rot=0.2192, grad=37.09, nan=0]Epoch 36:  12%|█▏        | 6/51 [00:00<00:00, 55.82it/s, loss=1.0982, trans=0.0088, rot=0.2192, grad=37.09, nan=0]Epoch 36:  12%|█▏        | 6/51 [00:00<00:00, 55.82it/s, loss=1.0119, trans=0.0075, rot=0.2610, grad=40.80, nan=0]Epoch 36:  12%|█▏        | 6/51 [00:00<00:00, 55.82it/s, loss=1.0164, trans=0.0082, rot=0.2013, grad=17.93, nan=0]Epoch 36:  12%|█▏        | 6/51 [00:00<00:00, 55.82it/s, loss=1.0556, trans=0.0082, rot=0.2360, grad=14.88, nan=0]Epoch 36:  12%|█▏        | 6/51 [00:00<00:00, 55.82it/s, loss=1.2042, trans=0.0095, rot=0.2583, grad=36.86, nan=0]Epoch 36:  12%|█▏        | 6/51 [00:00<00:00, 55.82it/s, loss=1.2263, trans=0.0098, rot=0.2448, grad=14.23, nan=0]Epoch 36:  12%|█▏        | 6/51 [00:00<00:00, 55.82it/s, loss=1.0167, trans=0.0080, rot=0.2140, grad=28.54, nan=0]Epoch 36:  12%|█▏        | 6/51 [00:00<00:00, 55.82it/s, loss=1.2411, trans=0.0101, rot=0.2360, grad=17.09, nan=0]Epoch 36:  12%|█▏        | 6/51 [00:00<00:00, 55.82it/s, loss=1.0326, trans=0.0079, rot=0.2420, grad=22.49, nan=0]Epoch 36:  12%|█▏        | 6/51 [00:00<00:00, 55.82it/s, loss=1.0416, trans=0.0083, rot=0.2150, grad=33.83, nan=0]Epoch 36:  12%|█▏        | 6/51 [00:00<00:00, 55.82it/s, loss=1.2623, trans=0.0104, rot=0.2181, grad=22.89, nan=0]Epoch 36:  31%|███▏      | 16/51 [00:00<00:00, 79.65it/s, loss=1.2623, trans=0.0104, rot=0.2181, grad=22.89, nan=0]Epoch 36:  31%|███▏      | 16/51 [00:00<00:00, 79.65it/s, loss=0.9975, trans=0.0075, rot=0.2431, grad=25.77, nan=0]Epoch 36:  31%|███▏      | 16/51 [00:00<00:00, 79.65it/s, loss=1.0777, trans=0.0084, rot=0.2405, grad=18.76, nan=0]Epoch 36:  31%|███▏      | 16/51 [00:00<00:00, 79.65it/s, loss=0.9969, trans=0.0074, rot=0.2596, grad=27.22, nan=0]Epoch 36:  31%|███▏      | 16/51 [00:00<00:00, 79.65it/s, loss=1.0659, trans=0.0083, rot=0.2397, grad=29.12, nan=0]Epoch 36:  31%|███▏      | 16/51 [00:00<00:00, 79.65it/s, loss=1.1317, trans=0.0091, rot=0.2212, grad=21.47, nan=0]Epoch 36:  31%|███▏      | 16/51 [00:00<00:00, 79.65it/s, loss=1.3686, trans=0.0115, rot=0.2164, grad=27.01, nan=0]Epoch 36:  31%|███▏      | 16/51 [00:00<00:00, 79.65it/s, loss=1.3081, trans=0.0106, rot=0.2487, grad=25.53, nan=0]Epoch 36:  31%|███▏      | 16/51 [00:00<00:00, 79.65it/s, loss=1.1496, trans=0.0093, rot=0.2160, grad=29.16, nan=0]Epoch 36:  31%|███▏      | 16/51 [00:00<00:00, 79.65it/s, loss=1.3984, trans=0.0108, rot=0.3168, grad=30.33, nan=0]Epoch 36:  31%|███▏      | 16/51 [00:00<00:00, 79.65it/s, loss=1.0755, trans=0.0081, rot=0.2661, grad=19.47, nan=0]Epoch 36:  51%|█████     | 26/51 [00:00<00:00, 87.40it/s, loss=1.0755, trans=0.0081, rot=0.2661, grad=19.47, nan=0]Epoch 36:  51%|█████     | 26/51 [00:00<00:00, 87.40it/s, loss=0.9557, trans=0.0077, rot=0.1898, grad=29.90, nan=0]Epoch 36:  51%|█████     | 26/51 [00:00<00:00, 87.40it/s, loss=1.1995, trans=0.0097, rot=0.2328, grad=26.01, nan=0]Epoch 36:  51%|█████     | 26/51 [00:00<00:00, 87.40it/s, loss=1.0070, trans=0.0076, rot=0.2439, grad=23.48, nan=0]Epoch 36:  51%|█████     | 26/51 [00:00<00:00, 87.40it/s, loss=0.9613, trans=0.0072, rot=0.2384, grad=15.60, nan=0]Epoch 36:  51%|█████     | 26/51 [00:00<00:00, 87.40it/s, loss=1.3072, trans=0.0105, rot=0.2527, grad=17.05, nan=0]Epoch 36:  51%|█████     | 26/51 [00:00<00:00, 87.40it/s, loss=1.2493, trans=0.0101, rot=0.2350, grad=22.09, nan=0]Epoch 36:  51%|█████     | 26/51 [00:00<00:00, 87.40it/s, loss=1.3358, trans=0.0108, rot=0.2546, grad=34.41, nan=0]Epoch 36:  51%|█████     | 26/51 [00:00<00:00, 87.40it/s, loss=1.2897, trans=0.0103, rot=0.2633, grad=22.43, nan=0]Epoch 36:  51%|█████     | 26/51 [00:00<00:00, 87.40it/s, loss=1.3209, trans=0.0106, rot=0.2620, grad=16.68, nan=0]Epoch 36:  51%|█████     | 26/51 [00:00<00:00, 87.40it/s, loss=1.2235, trans=0.0096, rot=0.2621, grad=14.66, nan=0]Epoch 36:  51%|█████     | 26/51 [00:00<00:00, 87.40it/s, loss=1.4250, trans=0.0119, rot=0.2346, grad=28.22, nan=0]Epoch 36:  73%|███████▎  | 37/51 [00:00<00:00, 94.81it/s, loss=1.4250, trans=0.0119, rot=0.2346, grad=28.22, nan=0]Epoch 36:  73%|███████▎  | 37/51 [00:00<00:00, 94.81it/s, loss=1.2241, trans=0.0098, rot=0.2480, grad=21.09, nan=0]Epoch 36:  73%|███████▎  | 37/51 [00:00<00:00, 94.81it/s, loss=1.0540, trans=0.0080, rot=0.2578, grad=26.09, nan=0]Epoch 36:  73%|███████▎  | 37/51 [00:00<00:00, 94.81it/s, loss=1.4285, trans=0.0116, rot=0.2699, grad=35.45, nan=0]Epoch 36:  73%|███████▎  | 37/51 [00:00<00:00, 94.81it/s, loss=1.5811, trans=0.0135, rot=0.2352, grad=34.19, nan=0]Epoch 36:  73%|███████▎  | 37/51 [00:00<00:00, 94.81it/s, loss=1.0811, trans=0.0082, rot=0.2578, grad=36.60, nan=0]Epoch 36:  73%|███████▎  | 37/51 [00:00<00:00, 94.81it/s, loss=0.9470, trans=0.0073, rot=0.2128, grad=13.85, nan=0]Epoch 36:  73%|███████▎  | 37/51 [00:00<00:00, 94.81it/s, loss=0.9229, trans=0.0068, rot=0.2405, grad=13.91, nan=0]Epoch 36:  73%|███████▎  | 37/51 [00:00<00:00, 94.81it/s, loss=1.2888, trans=0.0107, rot=0.2170, grad=35.90, nan=0]Epoch 36:  73%|███████▎  | 37/51 [00:00<00:00, 94.81it/s, loss=1.3822, trans=0.0114, rot=0.2451, grad=30.66, nan=0]Epoch 36:  73%|███████▎  | 37/51 [00:00<00:00, 94.81it/s, loss=1.7157, trans=0.0147, rot=0.2480, grad=25.68, nan=0]Epoch 36:  92%|█████████▏| 47/51 [00:00<00:00, 96.45it/s, loss=1.7157, trans=0.0147, rot=0.2480, grad=25.68, nan=0]Epoch 36:  92%|█████████▏| 47/51 [00:00<00:00, 96.45it/s, loss=1.2192, trans=0.0099, rot=0.2278, grad=25.02, nan=0]Epoch 36:  92%|█████████▏| 47/51 [00:00<00:00, 96.45it/s, loss=1.1435, trans=0.0091, rot=0.2372, grad=16.84, nan=0]Epoch 36:  92%|█████████▏| 47/51 [00:00<00:00, 96.45it/s, loss=1.1694, trans=0.0094, rot=0.2250, grad=38.20, nan=0]Epoch 36:  92%|█████████▏| 47/51 [00:00<00:00, 96.45it/s, loss=0.8337, trans=0.0059, rot=0.2441, grad=31.70, nan=0]Epoch 36: 100%|██████████| 51/51 [00:00<00:00, 89.20it/s, loss=0.8337, trans=0.0059, rot=0.2441, grad=31.70, nan=0]
Visual features - mean: 0.003712, std: 1.056614
IMU features - mean: -0.003722, std: 1.213832
GT translations (m) - mean: 0.002374, std: 0.024892
GT quaternions - mean: 0.250264, std: 0.433029
Predicted pose window shape: (1, 7)
[[ 0.16509978 -0.11383867  0.19400108 -0.04731508  0.23064095 -0.14214173
  -0.9614373 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.05074505 -0.04012724  0.00885241  0.03898567  0.00411478 -0.03519472
  -0.9986113 ]]
  Ground truth relative pose:
[[-5.6440663e-04  1.9468088e-03 -4.7541503e-03  3.6191787e-03
   1.3073711e-02  2.0660844e-02  9.9969453e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  95%|█████████▌| 21/22 [00:00<00:00, 203.56it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 189.45it/s]

Epoch 36 Summary:
  Train Loss: 1.180338
  Val Loss: 0.119578
  Val Trans Error: 0.0536 m
  Val Rot Error: 4.26 degrees
  ✓ New best model saved

============================================================
Epoch 37/50
Learning rate: 0.00000588
============================================================
Epoch 37:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 37:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1969, trans=0.0091, rot=0.2890, grad=36.37, nan=0]Epoch 37:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0738, trans=0.0085, rot=0.2271, grad=22.58, nan=0]Epoch 37:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.2254, trans=0.0100, rot=0.2232, grad=54.46, nan=0]Epoch 37:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.2689, trans=0.0106, rot=0.2117, grad=22.76, nan=0]Epoch 37:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.2242, trans=0.0098, rot=0.2467, grad=46.90, nan=0]Epoch 37:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.4591, trans=0.0118, rot=0.2766, grad=40.12, nan=0]Epoch 37:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.2215, trans=0.0098, rot=0.2381, grad=22.17, nan=0]Epoch 37:  14%|█▎        | 7/51 [00:00<00:00, 67.20it/s, loss=1.2215, trans=0.0098, rot=0.2381, grad=22.17, nan=0]Epoch 37:  14%|█▎        | 7/51 [00:00<00:00, 67.20it/s, loss=1.1847, trans=0.0092, rot=0.2601, grad=18.63, nan=0]Epoch 37:  14%|█▎        | 7/51 [00:00<00:00, 67.20it/s, loss=1.2080, trans=0.0094, rot=0.2701, grad=17.63, nan=0]Epoch 37:  14%|█▎        | 7/51 [00:00<00:00, 67.20it/s, loss=1.4584, trans=0.0118, rot=0.2766, grad=20.93, nan=0]Epoch 37:  14%|█▎        | 7/51 [00:00<00:00, 67.20it/s, loss=1.2515, trans=0.0103, rot=0.2258, grad=25.17, nan=0]Epoch 37:  14%|█▎        | 7/51 [00:00<00:00, 67.20it/s, loss=1.1291, trans=0.0086, rot=0.2725, grad=36.58, nan=0]Epoch 37:  14%|█▎        | 7/51 [00:00<00:00, 67.20it/s, loss=1.2501, trans=0.0103, rot=0.2211, grad=24.37, nan=0]Epoch 37:  14%|█▎        | 7/51 [00:00<00:00, 67.20it/s, loss=1.0097, trans=0.0079, rot=0.2193, grad=18.51, nan=0]Epoch 37:  14%|█▎        | 7/51 [00:00<00:00, 67.20it/s, loss=1.1218, trans=0.0086, rot=0.2627, grad=15.17, nan=0]Epoch 37:  14%|█▎        | 7/51 [00:00<00:00, 67.20it/s, loss=1.0788, trans=0.0081, rot=0.2663, grad=14.23, nan=0]Epoch 37:  14%|█▎        | 7/51 [00:00<00:00, 67.20it/s, loss=1.1367, trans=0.0090, rot=0.2342, grad=22.40, nan=0]Epoch 37:  14%|█▎        | 7/51 [00:00<00:00, 67.20it/s, loss=1.0835, trans=0.0084, rot=0.2420, grad=18.26, nan=0]Epoch 37:  35%|███▌      | 18/51 [00:00<00:00, 87.12it/s, loss=1.0835, trans=0.0084, rot=0.2420, grad=18.26, nan=0]Epoch 37:  35%|███▌      | 18/51 [00:00<00:00, 87.12it/s, loss=1.1087, trans=0.0089, rot=0.2236, grad=20.79, nan=0]Epoch 37:  35%|███▌      | 18/51 [00:00<00:00, 87.12it/s, loss=1.2255, trans=0.0099, rot=0.2359, grad=23.92, nan=0]Epoch 37:  35%|███▌      | 18/51 [00:00<00:00, 87.12it/s, loss=1.1975, trans=0.0096, rot=0.2335, grad=37.89, nan=0]Epoch 37:  35%|███▌      | 18/51 [00:00<00:00, 87.12it/s, loss=1.4828, trans=0.0122, rot=0.2612, grad=21.28, nan=0]Epoch 37:  35%|███▌      | 18/51 [00:00<00:00, 87.12it/s, loss=1.0881, trans=0.0085, rot=0.2384, grad=20.74, nan=0]Epoch 37:  35%|███▌      | 18/51 [00:00<00:00, 87.12it/s, loss=1.1562, trans=0.0093, rot=0.2228, grad=23.88, nan=0]Epoch 37:  35%|███▌      | 18/51 [00:00<00:00, 87.12it/s, loss=1.0264, trans=0.0083, rot=0.1988, grad=13.11, nan=0]Epoch 37:  35%|███▌      | 18/51 [00:00<00:00, 87.12it/s, loss=1.2543, trans=0.0099, rot=0.2629, grad=32.41, nan=0]Epoch 37:  35%|███▌      | 18/51 [00:00<00:00, 87.12it/s, loss=1.0006, trans=0.0076, rot=0.2406, grad=26.65, nan=0]Epoch 37:  35%|███▌      | 18/51 [00:00<00:00, 87.12it/s, loss=1.2030, trans=0.0097, rot=0.2315, grad=31.63, nan=0]Epoch 37:  35%|███▌      | 18/51 [00:00<00:00, 87.12it/s, loss=1.1165, trans=0.0091, rot=0.2093, grad=37.72, nan=0]Epoch 37:  57%|█████▋    | 29/51 [00:00<00:00, 94.30it/s, loss=1.1165, trans=0.0091, rot=0.2093, grad=37.72, nan=0]Epoch 37:  57%|█████▋    | 29/51 [00:00<00:00, 94.30it/s, loss=0.9163, trans=0.0071, rot=0.2023, grad=28.98, nan=0]Epoch 37:  57%|█████▋    | 29/51 [00:00<00:00, 94.30it/s, loss=0.9801, trans=0.0073, rot=0.2550, grad=18.77, nan=0]Epoch 37:  57%|█████▋    | 29/51 [00:00<00:00, 94.30it/s, loss=1.1456, trans=0.0090, rot=0.2424, grad=26.76, nan=0]Epoch 37:  57%|█████▋    | 29/51 [00:00<00:00, 94.30it/s, loss=1.2141, trans=0.0099, rot=0.2210, grad=30.21, nan=0]Epoch 37:  57%|█████▋    | 29/51 [00:00<00:00, 94.30it/s, loss=0.9968, trans=0.0075, rot=0.2480, grad=16.56, nan=0]Epoch 37:  57%|█████▋    | 29/51 [00:00<00:00, 94.30it/s, loss=0.9791, trans=0.0072, rot=0.2581, grad=24.06, nan=0]Epoch 37:  57%|█████▋    | 29/51 [00:00<00:00, 94.30it/s, loss=1.1865, trans=0.0093, rot=0.2577, grad=21.91, nan=0]Epoch 37:  57%|█████▋    | 29/51 [00:00<00:00, 94.30it/s, loss=1.1004, trans=0.0092, rot=0.1831, grad=22.37, nan=0]Epoch 37:  57%|█████▋    | 29/51 [00:00<00:00, 94.30it/s, loss=1.2530, trans=0.0104, rot=0.2155, grad=30.72, nan=0]Epoch 37:  57%|█████▋    | 29/51 [00:00<00:00, 94.30it/s, loss=1.0091, trans=0.0073, rot=0.2807, grad=20.85, nan=0]Epoch 37:  76%|███████▋  | 39/51 [00:00<00:00, 96.28it/s, loss=1.0091, trans=0.0073, rot=0.2807, grad=20.85, nan=0]Epoch 37:  76%|███████▋  | 39/51 [00:00<00:00, 96.28it/s, loss=1.0170, trans=0.0079, rot=0.2272, grad=18.71, nan=0]Epoch 37:  76%|███████▋  | 39/51 [00:00<00:00, 96.28it/s, loss=0.9710, trans=0.0077, rot=0.1985, grad=27.37, nan=0]Epoch 37:  76%|███████▋  | 39/51 [00:00<00:00, 96.28it/s, loss=1.1558, trans=0.0092, rot=0.2400, grad=36.19, nan=0]Epoch 37:  76%|███████▋  | 39/51 [00:00<00:00, 96.28it/s, loss=1.1162, trans=0.0090, rot=0.2189, grad=41.74, nan=0]Epoch 37:  76%|███████▋  | 39/51 [00:00<00:00, 96.28it/s, loss=1.0458, trans=0.0083, rot=0.2167, grad=14.02, nan=0]Epoch 37:  76%|███████▋  | 39/51 [00:00<00:00, 96.28it/s, loss=1.2734, trans=0.0104, rot=0.2333, grad=33.66, nan=0]Epoch 37:  76%|███████▋  | 39/51 [00:00<00:00, 96.28it/s, loss=1.0099, trans=0.0073, rot=0.2796, grad=23.10, nan=0]Epoch 37:  76%|███████▋  | 39/51 [00:00<00:00, 96.28it/s, loss=0.9405, trans=0.0076, rot=0.1799, grad=14.74, nan=0]Epoch 37:  76%|███████▋  | 39/51 [00:00<00:00, 96.28it/s, loss=1.1999, trans=0.0098, rot=0.2177, grad=33.64, nan=0]Epoch 37:  76%|███████▋  | 39/51 [00:00<00:00, 96.28it/s, loss=1.1273, trans=0.0091, rot=0.2149, grad=30.08, nan=0]Epoch 37:  76%|███████▋  | 39/51 [00:00<00:00, 96.28it/s, loss=0.8648, trans=0.0066, rot=0.2072, grad=35.71, nan=0]Epoch 37:  98%|█████████▊| 50/51 [00:00<00:00, 99.74it/s, loss=0.8648, trans=0.0066, rot=0.2072, grad=35.71, nan=0]Epoch 37:  98%|█████████▊| 50/51 [00:00<00:00, 99.74it/s, loss=0.9911, trans=0.0079, rot=0.2020, grad=50.60, nan=0]Epoch 37: 100%|██████████| 51/51 [00:00<00:00, 92.53it/s, loss=0.9911, trans=0.0079, rot=0.2020, grad=50.60, nan=0]
Visual features - mean: -0.002457, std: 1.063337
IMU features - mean: 0.004769, std: 0.855966
GT translations (m) - mean: -0.001721, std: 0.045151
GT quaternions - mean: 0.251607, std: 0.432250
Predicted pose window shape: (1, 7)
[[-0.13983822 -0.08117658 -0.01653959  0.06876901 -0.0992426  -0.00796812
  -0.99265206]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.05540958  0.11633433  0.03335784  0.01009242 -0.03026877 -0.0993881
  -0.99453706]]
  Ground truth relative pose:
[[ 3.2648130e-04 -6.8947929e-04 -7.3957804e-04  7.4338919e-04
   7.4006324e-03 -9.5078060e-03  9.9992716e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 188.41it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 181.27it/s]

Epoch 37 Summary:
  Train Loss: 1.135985
  Val Loss: 0.111099
  Val Trans Error: 0.0494 m
  Val Rot Error: 4.12 degrees
  ✓ New best model saved

============================================================
Epoch 38/50
Learning rate: 0.00000588
============================================================
Epoch 38:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 38:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1021, trans=0.0084, rot=0.2649, grad=17.29, nan=0]Epoch 38:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0854, trans=0.0087, rot=0.2160, grad=30.03, nan=0]Epoch 38:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.3982, trans=0.0116, rot=0.2417, grad=26.54, nan=0]Epoch 38:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1959, trans=0.0098, rot=0.2134, grad=20.35, nan=0]Epoch 38:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0424, trans=0.0078, rot=0.2637, grad=18.95, nan=0]Epoch 38:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.4188, trans=0.0113, rot=0.2860, grad=22.11, nan=0]Epoch 38:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0134, trans=0.0082, rot=0.1942, grad=14.72, nan=0]Epoch 38:  14%|█▎        | 7/51 [00:00<00:00, 64.03it/s, loss=1.0134, trans=0.0082, rot=0.1942, grad=14.72, nan=0]Epoch 38:  14%|█▎        | 7/51 [00:00<00:00, 64.03it/s, loss=1.3132, trans=0.0108, rot=0.2377, grad=23.91, nan=0]Epoch 38:  14%|█▎        | 7/51 [00:00<00:00, 64.03it/s, loss=0.9258, trans=0.0065, rot=0.2760, grad=27.04, nan=0]Epoch 38:  14%|█▎        | 7/51 [00:00<00:00, 64.03it/s, loss=1.0402, trans=0.0085, rot=0.1902, grad=33.81, nan=0]Epoch 38:  14%|█▎        | 7/51 [00:00<00:00, 64.03it/s, loss=1.0668, trans=0.0084, rot=0.2244, grad=22.77, nan=0]Epoch 38:  14%|█▎        | 7/51 [00:00<00:00, 64.03it/s, loss=0.8380, trans=0.0059, rot=0.2457, grad=21.48, nan=0]Epoch 38:  14%|█▎        | 7/51 [00:00<00:00, 64.03it/s, loss=1.4022, trans=0.0114, rot=0.2582, grad=24.61, nan=0]Epoch 38:  14%|█▎        | 7/51 [00:00<00:00, 64.03it/s, loss=1.0131, trans=0.0074, rot=0.2766, grad=22.06, nan=0]Epoch 38:  14%|█▎        | 7/51 [00:00<00:00, 64.03it/s, loss=0.9651, trans=0.0076, rot=0.2092, grad=19.34, nan=0]Epoch 38:  14%|█▎        | 7/51 [00:00<00:00, 64.03it/s, loss=1.2428, trans=0.0100, rot=0.2458, grad=19.67, nan=0]Epoch 38:  14%|█▎        | 7/51 [00:00<00:00, 64.03it/s, loss=0.9510, trans=0.0071, rot=0.2410, grad=31.87, nan=0]Epoch 38:  33%|███▎      | 17/51 [00:00<00:00, 83.85it/s, loss=0.9510, trans=0.0071, rot=0.2410, grad=31.87, nan=0]Epoch 38:  33%|███▎      | 17/51 [00:00<00:00, 83.85it/s, loss=1.0322, trans=0.0082, rot=0.2169, grad=24.28, nan=0]Epoch 38:  33%|███▎      | 17/51 [00:00<00:00, 83.85it/s, loss=1.0423, trans=0.0079, rot=0.2563, grad=20.27, nan=0]Epoch 38:  33%|███▎      | 17/51 [00:00<00:00, 83.85it/s, loss=1.1060, trans=0.0087, rot=0.2313, grad=22.88, nan=0]Epoch 38:  33%|███▎      | 17/51 [00:00<00:00, 83.85it/s, loss=1.0969, trans=0.0086, rot=0.2336, grad=31.97, nan=0]Epoch 38:  33%|███▎      | 17/51 [00:00<00:00, 83.85it/s, loss=1.0935, trans=0.0088, rot=0.2159, grad=21.21, nan=0]Epoch 38:  33%|███▎      | 17/51 [00:00<00:00, 83.85it/s, loss=1.0437, trans=0.0087, rot=0.1777, grad=21.02, nan=0]Epoch 38:  33%|███▎      | 17/51 [00:00<00:00, 83.85it/s, loss=1.0218, trans=0.0076, rot=0.2596, grad=16.97, nan=0]Epoch 38:  33%|███▎      | 17/51 [00:00<00:00, 83.85it/s, loss=1.0817, trans=0.0082, rot=0.2576, grad=31.33, nan=0]Epoch 38:  33%|███▎      | 17/51 [00:00<00:00, 83.85it/s, loss=0.8604, trans=0.0067, rot=0.1946, grad=21.94, nan=0]Epoch 38:  33%|███▎      | 17/51 [00:00<00:00, 83.85it/s, loss=0.8925, trans=0.0065, rot=0.2465, grad=11.52, nan=0]Epoch 38:  33%|███▎      | 17/51 [00:00<00:00, 83.85it/s, loss=1.2292, trans=0.0096, rot=0.2693, grad=18.82, nan=0]Epoch 38:  55%|█████▍    | 28/51 [00:00<00:00, 92.42it/s, loss=1.2292, trans=0.0096, rot=0.2693, grad=18.82, nan=0]Epoch 38:  55%|█████▍    | 28/51 [00:00<00:00, 92.42it/s, loss=1.1555, trans=0.0091, rot=0.2448, grad=18.63, nan=0]Epoch 38:  55%|█████▍    | 28/51 [00:00<00:00, 92.42it/s, loss=1.1142, trans=0.0088, rot=0.2329, grad=22.75, nan=0]Epoch 38:  55%|█████▍    | 28/51 [00:00<00:00, 92.42it/s, loss=1.1966, trans=0.0095, rot=0.2439, grad=37.08, nan=0]Epoch 38:  55%|█████▍    | 28/51 [00:00<00:00, 92.42it/s, loss=0.8336, trans=0.0063, rot=0.2047, grad=16.89, nan=0]Epoch 38:  55%|█████▍    | 28/51 [00:00<00:00, 92.42it/s, loss=1.0362, trans=0.0081, rot=0.2289, grad=22.46, nan=0]Epoch 38:  55%|█████▍    | 28/51 [00:00<00:00, 92.42it/s, loss=0.9051, trans=0.0072, rot=0.1900, grad=23.92, nan=0]Epoch 38:  55%|█████▍    | 28/51 [00:00<00:00, 92.42it/s, loss=0.9419, trans=0.0069, rot=0.2525, grad=11.43, nan=0]Epoch 38:  55%|█████▍    | 28/51 [00:00<00:00, 92.42it/s, loss=1.0850, trans=0.0089, rot=0.1902, grad=30.25, nan=0]Epoch 38:  55%|█████▍    | 28/51 [00:00<00:00, 92.42it/s, loss=1.1327, trans=0.0090, rot=0.2317, grad=27.12, nan=0]Epoch 38:  55%|█████▍    | 28/51 [00:00<00:00, 92.42it/s, loss=1.3101, trans=0.0100, rot=0.3113, grad=21.06, nan=0]Epoch 38:  55%|█████▍    | 28/51 [00:00<00:00, 92.42it/s, loss=1.0981, trans=0.0090, rot=0.1937, grad=25.49, nan=0]Epoch 38:  76%|███████▋  | 39/51 [00:00<00:00, 95.87it/s, loss=1.0981, trans=0.0090, rot=0.1937, grad=25.49, nan=0]Epoch 38:  76%|███████▋  | 39/51 [00:00<00:00, 95.87it/s, loss=1.0523, trans=0.0081, rot=0.2433, grad=16.16, nan=0]Epoch 38:  76%|███████▋  | 39/51 [00:00<00:00, 95.87it/s, loss=1.0598, trans=0.0087, rot=0.1899, grad=29.20, nan=0]Epoch 38:  76%|███████▋  | 39/51 [00:00<00:00, 95.87it/s, loss=0.8328, trans=0.0064, rot=0.1882, grad=16.45, nan=0]Epoch 38:  76%|███████▋  | 39/51 [00:00<00:00, 95.87it/s, loss=1.2219, trans=0.0097, rot=0.2505, grad=26.93, nan=0]Epoch 38:  76%|███████▋  | 39/51 [00:00<00:00, 95.87it/s, loss=1.1975, trans=0.0096, rot=0.2423, grad=26.55, nan=0]Epoch 38:  76%|███████▋  | 39/51 [00:00<00:00, 95.87it/s, loss=1.0860, trans=0.0089, rot=0.1963, grad=22.19, nan=0]Epoch 38:  76%|███████▋  | 39/51 [00:00<00:00, 95.87it/s, loss=0.9600, trans=0.0076, rot=0.2043, grad=20.15, nan=0]Epoch 38:  76%|███████▋  | 39/51 [00:00<00:00, 95.87it/s, loss=1.2956, trans=0.0105, rot=0.2488, grad=16.01, nan=0]Epoch 38:  76%|███████▋  | 39/51 [00:00<00:00, 95.87it/s, loss=1.2155, trans=0.0095, rot=0.2693, grad=16.51, nan=0]Epoch 38:  76%|███████▋  | 39/51 [00:00<00:00, 95.87it/s, loss=1.1973, trans=0.0095, rot=0.2425, grad=31.38, nan=0]Epoch 38:  76%|███████▋  | 39/51 [00:00<00:00, 95.87it/s, loss=1.3115, trans=0.0105, rot=0.2608, grad=18.57, nan=0]Epoch 38:  98%|█████████▊| 50/51 [00:00<00:00, 99.26it/s, loss=1.3115, trans=0.0105, rot=0.2608, grad=18.57, nan=0]Epoch 38:  98%|█████████▊| 50/51 [00:00<00:00, 99.26it/s, loss=0.8714, trans=0.0074, rot=0.1328, grad=79.03, nan=0]Epoch 38: 100%|██████████| 51/51 [00:00<00:00, 91.78it/s, loss=0.8714, trans=0.0074, rot=0.1328, grad=79.03, nan=0]
Visual features - mean: 0.006708, std: 0.999340
IMU features - mean: 0.003322, std: 1.037009
GT translations (m) - mean: 0.004253, std: 0.039625
GT quaternions - mean: 0.248153, std: 0.434244
Predicted pose window shape: (1, 7)
[[-0.15526378 -0.1817355  -0.05091675  0.0779999  -0.00473178  0.11188312
  -0.9906441 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-1.1228051e-02  3.9264560e-02 -2.5569052e-03 -4.8567881e-04
  -1.1858933e-03 -3.8850583e-02 -9.9924421e-01]]
  Ground truth relative pose:
[[-6.8379343e-03 -5.8493670e-03 -7.6684095e-03  9.6755028e-03
  -1.5811622e-04  1.5955001e-02  9.9982595e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  95%|█████████▌| 21/22 [00:00<00:00, 201.52it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 188.03it/s]

Epoch 38 Summary:
  Train Loss: 1.090693
  Val Loss: 0.112141
  Val Trans Error: 0.0527 m
  Val Rot Error: 3.98 degrees

============================================================
Epoch 39/50
Learning rate: 0.00000588
============================================================
Epoch 39:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 39:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0619, trans=0.0085, rot=0.2167, grad=32.60, nan=0]Epoch 39:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.2602, trans=0.0104, rot=0.2238, grad=37.52, nan=0]Epoch 39:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9667, trans=0.0076, rot=0.2024, grad=24.20, nan=0]Epoch 39:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.2083, trans=0.0097, rot=0.2370, grad=17.76, nan=0]Epoch 39:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1221, trans=0.0089, rot=0.2370, grad=21.84, nan=0]Epoch 39:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1034, trans=0.0089, rot=0.2093, grad=25.69, nan=0]Epoch 39:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9456, trans=0.0073, rot=0.2140, grad=22.64, nan=0]Epoch 39:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0316, trans=0.0084, rot=0.1958, grad=19.32, nan=0]Epoch 39:  16%|█▌        | 8/51 [00:00<00:00, 74.15it/s, loss=1.0316, trans=0.0084, rot=0.1958, grad=19.32, nan=0]Epoch 39:  16%|█▌        | 8/51 [00:00<00:00, 74.15it/s, loss=1.1293, trans=0.0091, rot=0.2176, grad=22.40, nan=0]Epoch 39:  16%|█▌        | 8/51 [00:00<00:00, 74.15it/s, loss=1.1738, trans=0.0095, rot=0.2263, grad=16.31, nan=0]Epoch 39:  16%|█▌        | 8/51 [00:00<00:00, 74.15it/s, loss=1.0403, trans=0.0080, rot=0.2358, grad=23.78, nan=0]Epoch 39:  16%|█▌        | 8/51 [00:00<00:00, 74.15it/s, loss=0.9185, trans=0.0069, rot=0.2236, grad=22.40, nan=0]Epoch 39:  16%|█▌        | 8/51 [00:00<00:00, 74.15it/s, loss=1.1260, trans=0.0093, rot=0.1931, grad=17.97, nan=0]Epoch 39:  16%|█▌        | 8/51 [00:00<00:00, 74.15it/s, loss=1.0629, trans=0.0085, rot=0.2140, grad=24.46, nan=0]Epoch 39:  16%|█▌        | 8/51 [00:00<00:00, 74.15it/s, loss=0.9034, trans=0.0069, rot=0.2107, grad=14.49, nan=0]Epoch 39:  16%|█▌        | 8/51 [00:00<00:00, 74.15it/s, loss=1.0538, trans=0.0085, rot=0.2036, grad=16.54, nan=0]Epoch 39:  16%|█▌        | 8/51 [00:00<00:00, 74.15it/s, loss=0.9331, trans=0.0071, rot=0.2256, grad=22.87, nan=0]Epoch 39:  16%|█▌        | 8/51 [00:00<00:00, 74.15it/s, loss=1.1098, trans=0.0088, rot=0.2284, grad=26.53, nan=0]Epoch 39:  35%|███▌      | 18/51 [00:00<00:00, 88.11it/s, loss=1.1098, trans=0.0088, rot=0.2284, grad=26.53, nan=0]Epoch 39:  35%|███▌      | 18/51 [00:00<00:00, 88.11it/s, loss=1.0651, trans=0.0080, rot=0.2601, grad=27.39, nan=0]Epoch 39:  35%|███▌      | 18/51 [00:00<00:00, 88.11it/s, loss=0.9798, trans=0.0078, rot=0.1982, grad=26.73, nan=0]Epoch 39:  35%|███▌      | 18/51 [00:00<00:00, 88.11it/s, loss=0.8198, trans=0.0059, rot=0.2251, grad=25.92, nan=0]Epoch 39:  35%|███▌      | 18/51 [00:00<00:00, 88.11it/s, loss=1.1385, trans=0.0089, rot=0.2483, grad=24.92, nan=0]Epoch 39:  35%|███▌      | 18/51 [00:00<00:00, 88.11it/s, loss=1.2152, trans=0.0101, rot=0.2087, grad=29.15, nan=0]Epoch 39:  35%|███▌      | 18/51 [00:00<00:00, 88.11it/s, loss=1.1320, trans=0.0091, rot=0.2198, grad=32.11, nan=0]Epoch 39:  35%|███▌      | 18/51 [00:00<00:00, 88.11it/s, loss=1.2427, trans=0.0102, rot=0.2232, grad=50.73, nan=0]Epoch 39:  35%|███▌      | 18/51 [00:00<00:00, 88.11it/s, loss=1.0247, trans=0.0080, rot=0.2216, grad=31.54, nan=0]Epoch 39:  35%|███▌      | 18/51 [00:00<00:00, 88.11it/s, loss=0.9270, trans=0.0070, rot=0.2264, grad=34.38, nan=0]Epoch 39:  35%|███▌      | 18/51 [00:00<00:00, 88.11it/s, loss=1.1037, trans=0.0088, rot=0.2231, grad=26.53, nan=0]Epoch 39:  55%|█████▍    | 28/51 [00:00<00:00, 92.43it/s, loss=1.1037, trans=0.0088, rot=0.2231, grad=26.53, nan=0]Epoch 39:  55%|█████▍    | 28/51 [00:00<00:00, 92.43it/s, loss=1.0367, trans=0.0083, rot=0.2023, grad=24.48, nan=0]Epoch 39:  55%|█████▍    | 28/51 [00:00<00:00, 92.43it/s, loss=1.0157, trans=0.0085, rot=0.1637, grad=16.19, nan=0]Epoch 39:  55%|█████▍    | 28/51 [00:00<00:00, 92.43it/s, loss=0.9444, trans=0.0073, rot=0.2113, grad=27.75, nan=0]Epoch 39:  55%|█████▍    | 28/51 [00:00<00:00, 92.43it/s, loss=0.9800, trans=0.0078, rot=0.1995, grad=23.70, nan=0]Epoch 39:  55%|█████▍    | 28/51 [00:00<00:00, 92.43it/s, loss=1.0449, trans=0.0081, rot=0.2375, grad=16.34, nan=0]Epoch 39:  55%|█████▍    | 28/51 [00:00<00:00, 92.43it/s, loss=0.9397, trans=0.0074, rot=0.1957, grad=28.41, nan=0]Epoch 39:  55%|█████▍    | 28/51 [00:00<00:00, 92.43it/s, loss=1.0510, trans=0.0079, rot=0.2565, grad=18.76, nan=0]Epoch 39:  55%|█████▍    | 28/51 [00:00<00:00, 92.43it/s, loss=1.1574, trans=0.0093, rot=0.2297, grad=35.71, nan=0]Epoch 39:  55%|█████▍    | 28/51 [00:00<00:00, 92.43it/s, loss=1.1679, trans=0.0098, rot=0.1891, grad=33.29, nan=0]Epoch 39:  55%|█████▍    | 28/51 [00:00<00:00, 92.43it/s, loss=1.2199, trans=0.0093, rot=0.2874, grad=34.98, nan=0]Epoch 39:  75%|███████▍  | 38/51 [00:00<00:00, 92.57it/s, loss=1.2199, trans=0.0093, rot=0.2874, grad=34.98, nan=0]Epoch 39:  75%|███████▍  | 38/51 [00:00<00:00, 92.57it/s, loss=0.8906, trans=0.0067, rot=0.2228, grad=18.36, nan=0]Epoch 39:  75%|███████▍  | 38/51 [00:00<00:00, 92.57it/s, loss=1.0186, trans=0.0079, rot=0.2287, grad=25.89, nan=0]Epoch 39:  75%|███████▍  | 38/51 [00:00<00:00, 92.57it/s, loss=0.8130, trans=0.0063, rot=0.1859, grad=20.67, nan=0]Epoch 39:  75%|███████▍  | 38/51 [00:00<00:00, 92.57it/s, loss=1.2829, trans=0.0103, rot=0.2503, grad=35.11, nan=0]Epoch 39:  75%|███████▍  | 38/51 [00:00<00:00, 92.57it/s, loss=0.9166, trans=0.0071, rot=0.2016, grad=14.09, nan=0]Epoch 39:  75%|███████▍  | 38/51 [00:00<00:00, 92.57it/s, loss=1.2015, trans=0.0098, rot=0.2195, grad=30.66, nan=0]Epoch 39:  75%|███████▍  | 38/51 [00:00<00:00, 92.57it/s, loss=0.9328, trans=0.0075, rot=0.1859, grad=30.03, nan=0]Epoch 39:  75%|███████▍  | 38/51 [00:00<00:00, 92.57it/s, loss=1.0317, trans=0.0083, rot=0.2030, grad=26.06, nan=0]Epoch 39:  75%|███████▍  | 38/51 [00:00<00:00, 92.57it/s, loss=1.0350, trans=0.0086, rot=0.1711, grad=15.89, nan=0]Epoch 39:  75%|███████▍  | 38/51 [00:00<00:00, 92.57it/s, loss=1.0177, trans=0.0077, rot=0.2473, grad=23.06, nan=0]Epoch 39:  75%|███████▍  | 38/51 [00:00<00:00, 92.57it/s, loss=1.2448, trans=0.0099, rot=0.2532, grad=32.27, nan=0]Epoch 39:  96%|█████████▌| 49/51 [00:00<00:00, 95.68it/s, loss=1.2448, trans=0.0099, rot=0.2532, grad=32.27, nan=0]Epoch 39:  96%|█████████▌| 49/51 [00:00<00:00, 95.68it/s, loss=1.2301, trans=0.0100, rot=0.2283, grad=20.86, nan=0]Epoch 39:  96%|█████████▌| 49/51 [00:00<00:00, 95.68it/s, loss=0.7931, trans=0.0059, rot=0.2053, grad=52.86, nan=0]Epoch 39: 100%|██████████| 51/51 [00:00<00:00, 91.25it/s, loss=0.7931, trans=0.0059, rot=0.2053, grad=52.86, nan=0]
Visual features - mean: 0.006696, std: 0.917859
IMU features - mean: 0.002634, std: 1.000099
GT translations (m) - mean: -0.000501, std: 0.027044
GT quaternions - mean: 0.248241, std: 0.434193
Predicted pose window shape: (1, 7)
[[ 7.6901518e-02 -1.2155731e-01  1.0240033e-01 -4.2694758e-04
  -1.1351284e-02 -3.7982084e-02 -9.9921381e-01]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.0073695   0.03813047 -0.00807438 -0.02520929  0.02992094 -0.02129768
  -0.9990073 ]]
  Ground truth relative pose:
[[-1.1358689e-04  9.3746581e-05  2.3637163e-05 -1.1634828e-03
  -4.3234232e-04  6.9454320e-05  9.9999923e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  95%|█████████▌| 21/22 [00:00<00:00, 203.98it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 189.67it/s]

Epoch 39 Summary:
  Train Loss: 1.054218
  Val Loss: 0.100910
  Val Trans Error: 0.0464 m
  Val Rot Error: 3.82 degrees
  ✓ New best model saved

============================================================
Epoch 40/50
Learning rate: 0.00000588
============================================================
Epoch 40:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 40:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9040, trans=0.0070, rot=0.2053, grad=31.53, nan=0]Epoch 40:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9690, trans=0.0075, rot=0.2144, grad=26.25, nan=0]Epoch 40:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9583, trans=0.0079, rot=0.1688, grad=20.36, nan=0]Epoch 40:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.7600, trans=0.0057, rot=0.1928, grad=20.62, nan=0]Epoch 40:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1873, trans=0.0099, rot=0.1954, grad=21.61, nan=0]Epoch 40:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9370, trans=0.0075, rot=0.1821, grad=16.24, nan=0]Epoch 40:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9898, trans=0.0079, rot=0.2019, grad=28.92, nan=0]Epoch 40:  14%|█▎        | 7/51 [00:00<00:00, 62.00it/s, loss=0.9898, trans=0.0079, rot=0.2019, grad=28.92, nan=0]Epoch 40:  14%|█▎        | 7/51 [00:00<00:00, 62.00it/s, loss=1.1315, trans=0.0094, rot=0.1891, grad=46.72, nan=0]Epoch 40:  14%|█▎        | 7/51 [00:00<00:00, 62.00it/s, loss=1.1403, trans=0.0090, rot=0.2430, grad=19.58, nan=0]Epoch 40:  14%|█▎        | 7/51 [00:00<00:00, 62.00it/s, loss=0.8595, trans=0.0066, rot=0.2029, grad=39.52, nan=0]Epoch 40:  14%|█▎        | 7/51 [00:00<00:00, 62.00it/s, loss=1.1040, trans=0.0086, rot=0.2447, grad=28.14, nan=0]Epoch 40:  14%|█▎        | 7/51 [00:00<00:00, 62.00it/s, loss=1.1446, trans=0.0092, rot=0.2235, grad=22.48, nan=0]Epoch 40:  14%|█▎        | 7/51 [00:00<00:00, 62.00it/s, loss=0.9889, trans=0.0080, rot=0.1917, grad=15.74, nan=0]Epoch 40:  14%|█▎        | 7/51 [00:00<00:00, 62.00it/s, loss=1.1216, trans=0.0086, rot=0.2572, grad=25.40, nan=0]Epoch 40:  14%|█▎        | 7/51 [00:00<00:00, 62.00it/s, loss=1.2829, trans=0.0102, rot=0.2619, grad=20.96, nan=0]Epoch 40:  14%|█▎        | 7/51 [00:00<00:00, 62.00it/s, loss=1.1439, trans=0.0094, rot=0.2048, grad=25.76, nan=0]Epoch 40:  14%|█▎        | 7/51 [00:00<00:00, 62.00it/s, loss=1.2968, trans=0.0105, rot=0.2517, grad=26.48, nan=0]Epoch 40:  33%|███▎      | 17/51 [00:00<00:00, 79.18it/s, loss=1.2968, trans=0.0105, rot=0.2517, grad=26.48, nan=0]Epoch 40:  33%|███▎      | 17/51 [00:00<00:00, 79.18it/s, loss=1.0356, trans=0.0082, rot=0.2182, grad=18.94, nan=0]Epoch 40:  33%|███▎      | 17/51 [00:00<00:00, 79.18it/s, loss=0.9220, trans=0.0067, rot=0.2475, grad=24.41, nan=0]Epoch 40:  33%|███▎      | 17/51 [00:00<00:00, 79.18it/s, loss=0.9630, trans=0.0074, rot=0.2194, grad=28.33, nan=0]Epoch 40:  33%|███▎      | 17/51 [00:00<00:00, 79.18it/s, loss=1.1563, trans=0.0097, rot=0.1896, grad=29.76, nan=0]Epoch 40:  33%|███▎      | 17/51 [00:00<00:00, 79.18it/s, loss=1.0538, trans=0.0087, rot=0.1840, grad=35.94, nan=0]Epoch 40:  33%|███▎      | 17/51 [00:00<00:00, 79.18it/s, loss=0.7974, trans=0.0056, rot=0.2377, grad=15.58, nan=0]Epoch 40:  33%|███▎      | 17/51 [00:00<00:00, 79.18it/s, loss=0.9820, trans=0.0074, rot=0.2463, grad=45.98, nan=0]Epoch 40:  33%|███▎      | 17/51 [00:00<00:00, 79.18it/s, loss=1.0995, trans=0.0088, rot=0.2168, grad=26.38, nan=0]Epoch 40:  33%|███▎      | 17/51 [00:00<00:00, 79.18it/s, loss=0.8903, trans=0.0069, rot=0.2002, grad=30.94, nan=0]Epoch 40:  33%|███▎      | 17/51 [00:00<00:00, 79.18it/s, loss=1.0152, trans=0.0082, rot=0.1991, grad=32.17, nan=0]Epoch 40:  53%|█████▎    | 27/51 [00:00<00:00, 84.99it/s, loss=1.0152, trans=0.0082, rot=0.1991, grad=32.17, nan=0]Epoch 40:  53%|█████▎    | 27/51 [00:00<00:00, 84.99it/s, loss=0.8601, trans=0.0067, rot=0.1916, grad=12.57, nan=0]Epoch 40:  53%|█████▎    | 27/51 [00:00<00:00, 84.99it/s, loss=0.9453, trans=0.0073, rot=0.2130, grad=27.05, nan=0]Epoch 40:  53%|█████▎    | 27/51 [00:00<00:00, 84.99it/s, loss=0.9955, trans=0.0079, rot=0.2021, grad=23.99, nan=0]Epoch 40:  53%|█████▎    | 27/51 [00:00<00:00, 84.99it/s, loss=1.1858, trans=0.0096, rot=0.2263, grad=27.46, nan=0]Epoch 40:  53%|█████▎    | 27/51 [00:00<00:00, 84.99it/s, loss=0.8992, trans=0.0067, rot=0.2264, grad=25.95, nan=0]Epoch 40:  53%|█████▎    | 27/51 [00:00<00:00, 84.99it/s, loss=1.1168, trans=0.0089, rot=0.2271, grad=18.83, nan=0]Epoch 40:  53%|█████▎    | 27/51 [00:00<00:00, 84.99it/s, loss=0.9915, trans=0.0078, rot=0.2090, grad=16.34, nan=0]Epoch 40:  53%|█████▎    | 27/51 [00:00<00:00, 84.99it/s, loss=1.1934, trans=0.0095, rot=0.2474, grad=23.17, nan=0]Epoch 40:  53%|█████▎    | 27/51 [00:00<00:00, 84.99it/s, loss=0.9804, trans=0.0076, rot=0.2183, grad=32.92, nan=0]Epoch 40:  53%|█████▎    | 27/51 [00:00<00:00, 84.99it/s, loss=1.1400, trans=0.0091, rot=0.2327, grad=22.32, nan=0]Epoch 40:  73%|███████▎  | 37/51 [00:00<00:00, 87.47it/s, loss=1.1400, trans=0.0091, rot=0.2327, grad=22.32, nan=0]Epoch 40:  73%|███████▎  | 37/51 [00:00<00:00, 87.47it/s, loss=1.1704, trans=0.0097, rot=0.2044, grad=16.08, nan=0]Epoch 40:  73%|███████▎  | 37/51 [00:00<00:00, 87.47it/s, loss=1.1386, trans=0.0091, rot=0.2298, grad=18.46, nan=0]Epoch 40:  73%|███████▎  | 37/51 [00:00<00:00, 87.47it/s, loss=1.0916, trans=0.0084, rot=0.2520, grad=33.96, nan=0]Epoch 40:  73%|███████▎  | 37/51 [00:00<00:00, 87.47it/s, loss=0.9659, trans=0.0078, rot=0.1827, grad=43.11, nan=0]Epoch 40:  73%|███████▎  | 37/51 [00:00<00:00, 87.47it/s, loss=1.0514, trans=0.0083, rot=0.2217, grad=16.98, nan=0]Epoch 40:  73%|███████▎  | 37/51 [00:00<00:00, 87.47it/s, loss=1.1567, trans=0.0092, rot=0.2367, grad=27.13, nan=0]Epoch 40:  73%|███████▎  | 37/51 [00:00<00:00, 87.47it/s, loss=1.1998, trans=0.0098, rot=0.2228, grad=28.46, nan=0]Epoch 40:  73%|███████▎  | 37/51 [00:00<00:00, 87.47it/s, loss=0.9424, trans=0.0071, rot=0.2317, grad=21.97, nan=0]Epoch 40:  73%|███████▎  | 37/51 [00:00<00:00, 87.47it/s, loss=1.0001, trans=0.0076, rot=0.2434, grad=30.44, nan=0]Epoch 40:  73%|███████▎  | 37/51 [00:00<00:00, 87.47it/s, loss=0.9344, trans=0.0072, rot=0.2193, grad=23.23, nan=0]Epoch 40:  92%|█████████▏| 47/51 [00:00<00:00, 90.04it/s, loss=0.9344, trans=0.0072, rot=0.2193, grad=23.23, nan=0]Epoch 40:  92%|█████████▏| 47/51 [00:00<00:00, 90.04it/s, loss=0.9897, trans=0.0078, rot=0.2123, grad=20.51, nan=0]Epoch 40:  92%|█████████▏| 47/51 [00:00<00:00, 90.04it/s, loss=0.9823, trans=0.0081, rot=0.1767, grad=15.40, nan=0]Epoch 40:  92%|█████████▏| 47/51 [00:00<00:00, 90.04it/s, loss=0.9852, trans=0.0076, rot=0.2267, grad=20.89, nan=0]Epoch 40:  92%|█████████▏| 47/51 [00:00<00:00, 90.04it/s, loss=0.7355, trans=0.0057, rot=0.1619, grad=38.11, nan=0]Epoch 40: 100%|██████████| 51/51 [00:00<00:00, 85.75it/s, loss=0.7355, trans=0.0057, rot=0.1619, grad=38.11, nan=0]
Visual features - mean: -0.000100, std: 0.961704
IMU features - mean: -0.001008, std: 0.870618
GT translations (m) - mean: -0.000025, std: 0.013826
GT quaternions - mean: 0.250318, std: 0.432998
Predicted pose window shape: (1, 7)
[[ 0.00716421  0.08850297  0.06241944  0.06434673 -0.05593593  0.03919019
  -0.99558765]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.04468337  0.2314041  -0.04403302  0.04604255  0.03430299 -0.0896086
  -0.99432075]]
  Ground truth relative pose:
[[-2.5986601e-04  2.4616718e-03  1.1343253e-03 -2.0531282e-02
  -1.3899207e-03 -5.4805726e-03  9.9977320e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  91%|█████████ | 20/22 [00:00<00:00, 197.10it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 179.18it/s]

Epoch 40 Summary:
  Train Loss: 1.029149
  Val Loss: 0.107818
  Val Trans Error: 0.0517 m
  Val Rot Error: 3.75 degrees

============================================================
Epoch 41/50
Learning rate: 0.00000588
============================================================
Epoch 41:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 41:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9790, trans=0.0080, rot=0.1814, grad=42.44, nan=0]Epoch 41:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.2355, trans=0.0102, rot=0.2159, grad=16.94, nan=0]Epoch 41:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9746, trans=0.0071, rot=0.2688, grad=19.24, nan=0]Epoch 41:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1785, trans=0.0094, rot=0.2425, grad=22.05, nan=0]Epoch 41:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9639, trans=0.0072, rot=0.2394, grad=16.56, nan=0]Epoch 41:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0419, trans=0.0085, rot=0.1967, grad=16.13, nan=0]Epoch 41:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9717, trans=0.0074, rot=0.2314, grad=22.41, nan=0]Epoch 41:  14%|█▎        | 7/51 [00:00<00:00, 69.60it/s, loss=0.9717, trans=0.0074, rot=0.2314, grad=22.41, nan=0]Epoch 41:  14%|█▎        | 7/51 [00:00<00:00, 69.60it/s, loss=1.0199, trans=0.0075, rot=0.2655, grad=17.24, nan=0]Epoch 41:  14%|█▎        | 7/51 [00:00<00:00, 69.60it/s, loss=0.8660, trans=0.0065, rot=0.2115, grad=34.59, nan=0]Epoch 41:  14%|█▎        | 7/51 [00:00<00:00, 69.60it/s, loss=0.8851, trans=0.0067, rot=0.2151, grad=17.63, nan=0]Epoch 41:  14%|█▎        | 7/51 [00:00<00:00, 69.60it/s, loss=0.9990, trans=0.0077, rot=0.2297, grad=22.88, nan=0]Epoch 41:  14%|█▎        | 7/51 [00:00<00:00, 69.60it/s, loss=1.1296, trans=0.0089, rot=0.2373, grad=30.00, nan=0]Epoch 41:  14%|█▎        | 7/51 [00:00<00:00, 69.60it/s, loss=1.0394, trans=0.0080, rot=0.2365, grad=37.36, nan=0]Epoch 41:  14%|█▎        | 7/51 [00:00<00:00, 69.60it/s, loss=0.9910, trans=0.0076, rot=0.2273, grad=16.28, nan=0]Epoch 41:  14%|█▎        | 7/51 [00:00<00:00, 69.60it/s, loss=1.0169, trans=0.0078, rot=0.2383, grad=18.80, nan=0]Epoch 41:  14%|█▎        | 7/51 [00:00<00:00, 69.60it/s, loss=1.1469, trans=0.0091, rot=0.2392, grad=21.97, nan=0]Epoch 41:  14%|█▎        | 7/51 [00:00<00:00, 69.60it/s, loss=0.8506, trans=0.0063, rot=0.2252, grad=13.19, nan=0]Epoch 41:  14%|█▎        | 7/51 [00:00<00:00, 69.60it/s, loss=0.7686, trans=0.0056, rot=0.2107, grad=23.20, nan=0]Epoch 41:  35%|███▌      | 18/51 [00:00<00:00, 88.61it/s, loss=0.7686, trans=0.0056, rot=0.2107, grad=23.20, nan=0]Epoch 41:  35%|███▌      | 18/51 [00:00<00:00, 88.61it/s, loss=0.9296, trans=0.0072, rot=0.2056, grad=30.87, nan=0]Epoch 41:  35%|███▌      | 18/51 [00:00<00:00, 88.61it/s, loss=1.0446, trans=0.0082, rot=0.2246, grad=22.07, nan=0]Epoch 41:  35%|███▌      | 18/51 [00:00<00:00, 88.61it/s, loss=0.9819, trans=0.0077, rot=0.2076, grad=13.71, nan=0]Epoch 41:  35%|███▌      | 18/51 [00:00<00:00, 88.61it/s, loss=0.9605, trans=0.0075, rot=0.2131, grad=16.53, nan=0]Epoch 41:  35%|███▌      | 18/51 [00:00<00:00, 88.61it/s, loss=0.8455, trans=0.0065, rot=0.1978, grad=33.98, nan=0]Epoch 41:  35%|███▌      | 18/51 [00:00<00:00, 88.61it/s, loss=1.0013, trans=0.0078, rot=0.2177, grad=24.20, nan=0]Epoch 41:  35%|███▌      | 18/51 [00:00<00:00, 88.61it/s, loss=0.9996, trans=0.0076, rot=0.2350, grad=32.60, nan=0]Epoch 41:  35%|███▌      | 18/51 [00:00<00:00, 88.61it/s, loss=1.0566, trans=0.0080, rot=0.2555, grad=13.83, nan=0]Epoch 41:  35%|███▌      | 18/51 [00:00<00:00, 88.61it/s, loss=1.0565, trans=0.0084, rot=0.2170, grad=27.61, nan=0]Epoch 41:  35%|███▌      | 18/51 [00:00<00:00, 88.61it/s, loss=1.2181, trans=0.0100, rot=0.2200, grad=21.56, nan=0]Epoch 41:  55%|█████▍    | 28/51 [00:00<00:00, 93.03it/s, loss=1.2181, trans=0.0100, rot=0.2200, grad=21.56, nan=0]Epoch 41:  55%|█████▍    | 28/51 [00:00<00:00, 93.03it/s, loss=1.0011, trans=0.0076, rot=0.2423, grad=16.94, nan=0]Epoch 41:  55%|█████▍    | 28/51 [00:00<00:00, 93.03it/s, loss=0.8848, trans=0.0069, rot=0.1983, grad=19.10, nan=0]Epoch 41:  55%|█████▍    | 28/51 [00:00<00:00, 93.03it/s, loss=0.9037, trans=0.0063, rot=0.2726, grad=29.52, nan=0]Epoch 41:  55%|█████▍    | 28/51 [00:00<00:00, 93.03it/s, loss=0.9948, trans=0.0078, rot=0.2173, grad=17.92, nan=0]Epoch 41:  55%|█████▍    | 28/51 [00:00<00:00, 93.03it/s, loss=1.1407, trans=0.0091, rot=0.2258, grad=17.20, nan=0]Epoch 41:  55%|█████▍    | 28/51 [00:00<00:00, 93.03it/s, loss=0.7758, trans=0.0054, rot=0.2338, grad=21.25, nan=0]Epoch 41:  55%|█████▍    | 28/51 [00:00<00:00, 93.03it/s, loss=0.8388, trans=0.0063, rot=0.2069, grad=26.51, nan=0]Epoch 41:  55%|█████▍    | 28/51 [00:00<00:00, 93.03it/s, loss=0.8158, trans=0.0060, rot=0.2145, grad=29.03, nan=0]Epoch 41:  55%|█████▍    | 28/51 [00:00<00:00, 93.03it/s, loss=0.8937, trans=0.0069, rot=0.2056, grad=21.38, nan=0]Epoch 41:  55%|█████▍    | 28/51 [00:00<00:00, 93.03it/s, loss=1.2311, trans=0.0097, rot=0.2571, grad=26.93, nan=0]Epoch 41:  75%|███████▍  | 38/51 [00:00<00:00, 95.52it/s, loss=1.2311, trans=0.0097, rot=0.2571, grad=26.93, nan=0]Epoch 41:  75%|███████▍  | 38/51 [00:00<00:00, 95.52it/s, loss=0.9897, trans=0.0082, rot=0.1728, grad=25.60, nan=0]Epoch 41:  75%|███████▍  | 38/51 [00:00<00:00, 95.52it/s, loss=0.8438, trans=0.0063, rot=0.2185, grad=11.91, nan=0]Epoch 41:  75%|███████▍  | 38/51 [00:00<00:00, 95.52it/s, loss=0.9491, trans=0.0071, rot=0.2433, grad=25.80, nan=0]Epoch 41:  75%|███████▍  | 38/51 [00:00<00:00, 95.52it/s, loss=0.8482, trans=0.0066, rot=0.1913, grad=12.38, nan=0]Epoch 41:  75%|███████▍  | 38/51 [00:00<00:00, 95.52it/s, loss=0.9383, trans=0.0069, rot=0.2470, grad=14.65, nan=0]Epoch 41:  75%|███████▍  | 38/51 [00:00<00:00, 95.52it/s, loss=0.9061, trans=0.0071, rot=0.1995, grad=18.22, nan=0]Epoch 41:  75%|███████▍  | 38/51 [00:00<00:00, 95.52it/s, loss=0.9459, trans=0.0070, rot=0.2409, grad=15.97, nan=0]Epoch 41:  75%|███████▍  | 38/51 [00:00<00:00, 95.52it/s, loss=1.1822, trans=0.0093, rot=0.2504, grad=15.63, nan=0]Epoch 41:  75%|███████▍  | 38/51 [00:00<00:00, 95.52it/s, loss=1.0331, trans=0.0080, rot=0.2371, grad=32.11, nan=0]Epoch 41:  75%|███████▍  | 38/51 [00:00<00:00, 95.52it/s, loss=1.0602, trans=0.0084, rot=0.2235, grad=35.55, nan=0]Epoch 41:  75%|███████▍  | 38/51 [00:00<00:00, 95.52it/s, loss=0.9962, trans=0.0075, rot=0.2506, grad=41.41, nan=0]Epoch 41:  96%|█████████▌| 49/51 [00:00<00:00, 97.78it/s, loss=0.9962, trans=0.0075, rot=0.2506, grad=41.41, nan=0]Epoch 41:  96%|█████████▌| 49/51 [00:00<00:00, 97.78it/s, loss=1.0466, trans=0.0081, rot=0.2384, grad=33.18, nan=0]Epoch 41:  96%|█████████▌| 49/51 [00:00<00:00, 97.78it/s, loss=1.4949, trans=0.0123, rot=0.2636, grad=63.85, nan=0]Epoch 41: 100%|██████████| 51/51 [00:00<00:00, 92.22it/s, loss=1.4949, trans=0.0123, rot=0.2636, grad=63.85, nan=0]
Visual features - mean: 0.001622, std: 0.979044
IMU features - mean: -0.000862, std: 0.870889
GT translations (m) - mean: -0.000492, std: 0.013549
GT quaternions - mean: 0.250643, std: 0.432810
Predicted pose window shape: (1, 7)
[[ 0.26562735  0.13849044 -0.10939786 -0.06160015  0.10276585 -0.10150556
  -0.98759365]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.08760988  0.15275478 -0.39795715 -0.06251337 -0.14251257  0.20969762
  -0.9653026 ]]
  Ground truth relative pose:
[[ 1.3820680e-03  6.8503618e-04 -3.9969565e-04 -2.7097615e-03
  -1.3092161e-03 -1.1448116e-03  9.9999481e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  95%|█████████▌| 21/22 [00:00<00:00, 203.60it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 187.99it/s]

Epoch 41 Summary:
  Train Loss: 0.997391
  Val Loss: 0.092619
  Val Trans Error: 0.0446 m
  Val Rot Error: 3.65 degrees
  ✓ New best model saved

============================================================
Epoch 42/50
Learning rate: 0.00000588
============================================================
Epoch 42:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 42:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8175, trans=0.0058, rot=0.2422, grad=16.98, nan=0]Epoch 42:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1436, trans=0.0086, rot=0.2866, grad=22.83, nan=0]Epoch 42:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9542, trans=0.0073, rot=0.2272, grad=19.21, nan=0]Epoch 42:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.7379, trans=0.0055, rot=0.1910, grad=26.20, nan=0]Epoch 42:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8347, trans=0.0063, rot=0.2016, grad=14.67, nan=0]Epoch 42:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.7897, trans=0.0061, rot=0.1802, grad=23.01, nan=0]Epoch 42:  12%|█▏        | 6/51 [00:00<00:00, 58.43it/s, loss=0.7897, trans=0.0061, rot=0.1802, grad=23.01, nan=0]Epoch 42:  12%|█▏        | 6/51 [00:00<00:00, 58.43it/s, loss=0.9358, trans=0.0074, rot=0.1928, grad=12.50, nan=0]Epoch 42:  12%|█▏        | 6/51 [00:00<00:00, 58.43it/s, loss=0.9712, trans=0.0075, rot=0.2215, grad=21.47, nan=0]Epoch 42:  12%|█▏        | 6/51 [00:00<00:00, 58.43it/s, loss=0.9729, trans=0.0073, rot=0.2416, grad=24.35, nan=0]Epoch 42:  12%|█▏        | 6/51 [00:00<00:00, 58.43it/s, loss=0.9562, trans=0.0072, rot=0.2315, grad=28.24, nan=0]Epoch 42:  12%|█▏        | 6/51 [00:00<00:00, 58.43it/s, loss=0.9881, trans=0.0077, rot=0.2177, grad=23.60, nan=0]Epoch 42:  12%|█▏        | 6/51 [00:00<00:00, 58.43it/s, loss=0.8953, trans=0.0065, rot=0.2441, grad=14.22, nan=0]Epoch 42:  12%|█▏        | 6/51 [00:00<00:00, 58.43it/s, loss=0.8950, trans=0.0066, rot=0.2315, grad=17.05, nan=0]Epoch 42:  12%|█▏        | 6/51 [00:00<00:00, 58.43it/s, loss=0.9540, trans=0.0071, rot=0.2402, grad=12.74, nan=0]Epoch 42:  12%|█▏        | 6/51 [00:00<00:00, 58.43it/s, loss=0.8914, trans=0.0063, rot=0.2619, grad=23.57, nan=0]Epoch 42:  29%|██▉       | 15/51 [00:00<00:00, 76.44it/s, loss=0.8914, trans=0.0063, rot=0.2619, grad=23.57, nan=0]Epoch 42:  29%|██▉       | 15/51 [00:00<00:00, 76.44it/s, loss=1.0321, trans=0.0082, rot=0.2134, grad=24.11, nan=0]Epoch 42:  29%|██▉       | 15/51 [00:00<00:00, 76.44it/s, loss=1.0790, trans=0.0086, rot=0.2192, grad=19.14, nan=0]Epoch 42:  29%|██▉       | 15/51 [00:00<00:00, 76.44it/s, loss=0.9208, trans=0.0071, rot=0.2094, grad=15.29, nan=0]Epoch 42:  29%|██▉       | 15/51 [00:00<00:00, 76.44it/s, loss=0.8439, trans=0.0067, rot=0.1787, grad=22.66, nan=0]Epoch 42:  29%|██▉       | 15/51 [00:00<00:00, 76.44it/s, loss=1.0996, trans=0.0087, rot=0.2280, grad=20.53, nan=0]Epoch 42:  29%|██▉       | 15/51 [00:00<00:00, 76.44it/s, loss=0.8910, trans=0.0066, rot=0.2286, grad=22.32, nan=0]Epoch 42:  29%|██▉       | 15/51 [00:00<00:00, 76.44it/s, loss=1.2095, trans=0.0097, rot=0.2405, grad=30.28, nan=0]Epoch 42:  29%|██▉       | 15/51 [00:00<00:00, 76.44it/s, loss=1.0329, trans=0.0081, rot=0.2219, grad=19.85, nan=0]Epoch 42:  29%|██▉       | 15/51 [00:00<00:00, 76.44it/s, loss=1.1742, trans=0.0095, rot=0.2239, grad=43.39, nan=0]Epoch 42:  29%|██▉       | 15/51 [00:00<00:00, 76.44it/s, loss=0.9301, trans=0.0071, rot=0.2205, grad=20.57, nan=0]Epoch 42:  49%|████▉     | 25/51 [00:00<00:00, 84.42it/s, loss=0.9301, trans=0.0071, rot=0.2205, grad=20.57, nan=0]Epoch 42:  49%|████▉     | 25/51 [00:00<00:00, 84.42it/s, loss=0.9435, trans=0.0073, rot=0.2174, grad=21.39, nan=0]Epoch 42:  49%|████▉     | 25/51 [00:00<00:00, 84.42it/s, loss=1.1082, trans=0.0087, rot=0.2380, grad=36.30, nan=0]Epoch 42:  49%|████▉     | 25/51 [00:00<00:00, 84.42it/s, loss=1.0780, trans=0.0085, rot=0.2242, grad=24.47, nan=0]Epoch 42:  49%|████▉     | 25/51 [00:00<00:00, 84.42it/s, loss=0.9792, trans=0.0076, rot=0.2229, grad=20.22, nan=0]Epoch 42:  49%|████▉     | 25/51 [00:00<00:00, 84.42it/s, loss=0.9161, trans=0.0068, rot=0.2392, grad=23.80, nan=0]Epoch 42:  49%|████▉     | 25/51 [00:00<00:00, 84.42it/s, loss=0.9364, trans=0.0068, rot=0.2524, grad=14.03, nan=0]Epoch 42:  49%|████▉     | 25/51 [00:00<00:00, 84.42it/s, loss=0.9534, trans=0.0071, rot=0.2410, grad=17.27, nan=0]Epoch 42:  49%|████▉     | 25/51 [00:00<00:00, 84.42it/s, loss=0.9612, trans=0.0073, rot=0.2347, grad=20.61, nan=0]Epoch 42:  49%|████▉     | 25/51 [00:00<00:00, 84.42it/s, loss=0.9330, trans=0.0069, rot=0.2459, grad=13.61, nan=0]Epoch 42:  49%|████▉     | 25/51 [00:00<00:00, 84.42it/s, loss=0.9932, trans=0.0076, rot=0.2292, grad=26.46, nan=0]Epoch 42:  69%|██████▊   | 35/51 [00:00<00:00, 90.29it/s, loss=0.9932, trans=0.0076, rot=0.2292, grad=26.46, nan=0]Epoch 42:  69%|██████▊   | 35/51 [00:00<00:00, 90.29it/s, loss=0.8123, trans=0.0058, rot=0.2295, grad=11.82, nan=0]Epoch 42:  69%|██████▊   | 35/51 [00:00<00:00, 90.29it/s, loss=0.9853, trans=0.0076, rot=0.2268, grad=23.00, nan=0]Epoch 42:  69%|██████▊   | 35/51 [00:00<00:00, 90.29it/s, loss=1.1385, trans=0.0088, rot=0.2548, grad=35.94, nan=0]Epoch 42:  69%|██████▊   | 35/51 [00:00<00:00, 90.29it/s, loss=0.9521, trans=0.0077, rot=0.1850, grad=27.80, nan=0]Epoch 42:  69%|██████▊   | 35/51 [00:00<00:00, 90.29it/s, loss=0.9267, trans=0.0070, rot=0.2218, grad=18.01, nan=0]Epoch 42:  69%|██████▊   | 35/51 [00:00<00:00, 90.29it/s, loss=1.1582, trans=0.0094, rot=0.2163, grad=22.35, nan=0]Epoch 42:  69%|██████▊   | 35/51 [00:00<00:00, 90.29it/s, loss=1.0474, trans=0.0084, rot=0.2111, grad=27.06, nan=0]Epoch 42:  69%|██████▊   | 35/51 [00:00<00:00, 90.29it/s, loss=1.1675, trans=0.0094, rot=0.2254, grad=26.38, nan=0]Epoch 42:  69%|██████▊   | 35/51 [00:00<00:00, 90.29it/s, loss=1.0087, trans=0.0081, rot=0.2030, grad=20.45, nan=0]Epoch 42:  69%|██████▊   | 35/51 [00:00<00:00, 90.29it/s, loss=0.7385, trans=0.0056, rot=0.1835, grad=18.56, nan=0]Epoch 42:  88%|████████▊ | 45/51 [00:00<00:00, 93.27it/s, loss=0.7385, trans=0.0056, rot=0.1835, grad=18.56, nan=0]Epoch 42:  88%|████████▊ | 45/51 [00:00<00:00, 93.27it/s, loss=1.0308, trans=0.0081, rot=0.2187, grad=18.33, nan=0]Epoch 42:  88%|████████▊ | 45/51 [00:00<00:00, 93.27it/s, loss=0.9249, trans=0.0070, rot=0.2289, grad=20.89, nan=0]Epoch 42:  88%|████████▊ | 45/51 [00:00<00:00, 93.27it/s, loss=0.8482, trans=0.0067, rot=0.1773, grad=15.36, nan=0]Epoch 42:  88%|████████▊ | 45/51 [00:00<00:00, 93.27it/s, loss=0.7815, trans=0.0060, rot=0.1854, grad=20.93, nan=0]Epoch 42:  88%|████████▊ | 45/51 [00:00<00:00, 93.27it/s, loss=0.9222, trans=0.0072, rot=0.2061, grad=15.26, nan=0]Epoch 42:  88%|████████▊ | 45/51 [00:00<00:00, 93.27it/s, loss=1.2092, trans=0.0093, rot=0.2767, grad=60.86, nan=0]Epoch 42: 100%|██████████| 51/51 [00:00<00:00, 86.47it/s, loss=1.2092, trans=0.0093, rot=0.2767, grad=60.86, nan=0]
Visual features - mean: -0.000847, std: 0.948196
IMU features - mean: 0.010746, std: 0.805930
GT translations (m) - mean: -0.000573, std: 0.044826
GT quaternions - mean: 0.248854, std: 0.433842
Predicted pose window shape: (1, 7)
[[-0.05498588  0.01945977 -0.10796541  0.01888914 -0.06172349 -0.05714992
  -0.99627674]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.04323784  0.02065596  0.09848326 -0.1142197  -0.0873163   0.06269826
  -0.98762274]]
  Ground truth relative pose:
[[6.0712293e-05 5.0024995e-05 8.0700425e-05 8.1974274e-04 1.3139845e-04
  6.2674291e-05 9.9999964e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 186.40it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 175.81it/s]

Epoch 42 Summary:
  Train Loss: 0.968718
  Val Loss: 0.112124
  Val Trans Error: 0.0554 m
  Val Rot Error: 3.63 degrees

============================================================
Epoch 43/50
Learning rate: 0.00000588
============================================================
Epoch 43:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 43:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.1412, trans=0.0092, rot=0.2201, grad=23.60, nan=0]Epoch 43:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9317, trans=0.0071, rot=0.2207, grad=20.12, nan=0]Epoch 43:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0000, trans=0.0077, rot=0.2260, grad=18.23, nan=0]Epoch 43:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0031, trans=0.0078, rot=0.2257, grad=23.01, nan=0]Epoch 43:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8579, trans=0.0064, rot=0.2224, grad=14.01, nan=0]Epoch 43:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.7972, trans=0.0058, rot=0.2171, grad=20.98, nan=0]Epoch 43:  12%|█▏        | 6/51 [00:00<00:00, 58.96it/s, loss=0.7972, trans=0.0058, rot=0.2171, grad=20.98, nan=0]Epoch 43:  12%|█▏        | 6/51 [00:00<00:00, 58.96it/s, loss=0.7248, trans=0.0054, rot=0.1836, grad=18.62, nan=0]Epoch 43:  12%|█▏        | 6/51 [00:00<00:00, 58.96it/s, loss=1.0044, trans=0.0078, rot=0.2232, grad=26.76, nan=0]Epoch 43:  12%|█▏        | 6/51 [00:00<00:00, 58.96it/s, loss=0.8290, trans=0.0062, rot=0.2067, grad=13.86, nan=0]Epoch 43:  12%|█▏        | 6/51 [00:00<00:00, 58.96it/s, loss=1.0122, trans=0.0079, rot=0.2187, grad=18.21, nan=0]Epoch 43:  12%|█▏        | 6/51 [00:00<00:00, 58.96it/s, loss=1.1250, trans=0.0090, rot=0.2288, grad=47.83, nan=0]Epoch 43:  12%|█▏        | 6/51 [00:00<00:00, 58.96it/s, loss=0.8670, trans=0.0065, rot=0.2159, grad=19.04, nan=0]Epoch 43:  12%|█▏        | 6/51 [00:00<00:00, 58.96it/s, loss=0.9650, trans=0.0074, rot=0.2227, grad=20.80, nan=0]Epoch 43:  12%|█▏        | 6/51 [00:00<00:00, 58.96it/s, loss=0.8760, trans=0.0068, rot=0.1969, grad=11.31, nan=0]Epoch 43:  12%|█▏        | 6/51 [00:00<00:00, 58.96it/s, loss=1.0210, trans=0.0082, rot=0.2052, grad=29.94, nan=0]Epoch 43:  12%|█▏        | 6/51 [00:00<00:00, 58.96it/s, loss=0.8576, trans=0.0065, rot=0.2116, grad=29.65, nan=0]Epoch 43:  31%|███▏      | 16/51 [00:00<00:00, 82.29it/s, loss=0.8576, trans=0.0065, rot=0.2116, grad=29.65, nan=0]Epoch 43:  31%|███▏      | 16/51 [00:00<00:00, 82.29it/s, loss=0.9850, trans=0.0073, rot=0.2516, grad=24.23, nan=0]Epoch 43:  31%|███▏      | 16/51 [00:00<00:00, 82.29it/s, loss=1.0030, trans=0.0079, rot=0.2129, grad=25.36, nan=0]Epoch 43:  31%|███▏      | 16/51 [00:00<00:00, 82.29it/s, loss=0.9143, trans=0.0067, rot=0.2443, grad=24.08, nan=0]Epoch 43:  31%|███▏      | 16/51 [00:00<00:00, 82.29it/s, loss=1.0681, trans=0.0088, rot=0.1925, grad=16.61, nan=0]Epoch 43:  31%|███▏      | 16/51 [00:00<00:00, 82.29it/s, loss=1.0473, trans=0.0084, rot=0.2093, grad=15.07, nan=0]Epoch 43:  31%|███▏      | 16/51 [00:00<00:00, 82.29it/s, loss=0.8544, trans=0.0064, rot=0.2114, grad=11.16, nan=0]Epoch 43:  31%|███▏      | 16/51 [00:00<00:00, 82.29it/s, loss=0.8431, trans=0.0061, rot=0.2325, grad=15.94, nan=0]Epoch 43:  31%|███▏      | 16/51 [00:00<00:00, 82.29it/s, loss=1.0002, trans=0.0080, rot=0.1979, grad=28.96, nan=0]Epoch 43:  31%|███▏      | 16/51 [00:00<00:00, 82.29it/s, loss=1.1871, trans=0.0093, rot=0.2552, grad=20.60, nan=0]Epoch 43:  31%|███▏      | 16/51 [00:00<00:00, 82.29it/s, loss=0.9485, trans=0.0075, rot=0.1966, grad=32.14, nan=0]Epoch 43:  51%|█████     | 26/51 [00:00<00:00, 89.87it/s, loss=0.9485, trans=0.0075, rot=0.1966, grad=32.14, nan=0]Epoch 43:  51%|█████     | 26/51 [00:00<00:00, 89.87it/s, loss=1.1134, trans=0.0087, rot=0.2429, grad=25.94, nan=0]Epoch 43:  51%|█████     | 26/51 [00:00<00:00, 89.87it/s, loss=0.9198, trans=0.0068, rot=0.2437, grad=23.66, nan=0]Epoch 43:  51%|█████     | 26/51 [00:00<00:00, 89.87it/s, loss=1.0609, trans=0.0083, rot=0.2351, grad=33.39, nan=0]Epoch 43:  51%|█████     | 26/51 [00:00<00:00, 89.87it/s, loss=0.7271, trans=0.0052, rot=0.2105, grad=30.91, nan=0]Epoch 43:  51%|█████     | 26/51 [00:00<00:00, 89.87it/s, loss=0.9417, trans=0.0073, rot=0.2111, grad=28.78, nan=0]Epoch 43:  51%|█████     | 26/51 [00:00<00:00, 89.87it/s, loss=0.9283, trans=0.0068, rot=0.2446, grad=21.25, nan=0]Epoch 43:  51%|█████     | 26/51 [00:00<00:00, 89.87it/s, loss=0.7425, trans=0.0054, rot=0.2065, grad=13.37, nan=0]Epoch 43:  51%|█████     | 26/51 [00:00<00:00, 89.87it/s, loss=0.9493, trans=0.0068, rot=0.2710, grad=12.42, nan=0]Epoch 43:  51%|█████     | 26/51 [00:00<00:00, 89.87it/s, loss=0.9788, trans=0.0076, rot=0.2184, grad=15.54, nan=0]Epoch 43:  69%|██████▊   | 35/51 [00:00<00:00, 89.51it/s, loss=0.9788, trans=0.0076, rot=0.2184, grad=15.54, nan=0]Epoch 43:  69%|██████▊   | 35/51 [00:00<00:00, 89.51it/s, loss=0.9343, trans=0.0073, rot=0.2084, grad=26.72, nan=0]Epoch 43:  69%|██████▊   | 35/51 [00:00<00:00, 89.51it/s, loss=0.8165, trans=0.0060, rot=0.2190, grad=22.51, nan=0]Epoch 43:  69%|██████▊   | 35/51 [00:00<00:00, 89.51it/s, loss=0.8584, trans=0.0066, rot=0.1971, grad=14.45, nan=0]Epoch 43:  69%|██████▊   | 35/51 [00:00<00:00, 89.51it/s, loss=0.9156, trans=0.0069, rot=0.2219, grad=22.82, nan=0]Epoch 43:  69%|██████▊   | 35/51 [00:00<00:00, 89.51it/s, loss=0.8867, trans=0.0068, rot=0.2109, grad=12.29, nan=0]Epoch 43:  69%|██████▊   | 35/51 [00:00<00:00, 89.51it/s, loss=0.8953, trans=0.0070, rot=0.1946, grad=19.83, nan=0]Epoch 43:  69%|██████▊   | 35/51 [00:00<00:00, 89.51it/s, loss=1.0037, trans=0.0077, rot=0.2344, grad=31.06, nan=0]Epoch 43:  69%|██████▊   | 35/51 [00:00<00:00, 89.51it/s, loss=0.7215, trans=0.0055, rot=0.1756, grad=13.34, nan=0]Epoch 43:  69%|██████▊   | 35/51 [00:00<00:00, 89.51it/s, loss=0.8915, trans=0.0063, rot=0.2584, grad=13.21, nan=0]Epoch 43:  86%|████████▋ | 44/51 [00:00<00:00, 88.06it/s, loss=0.8915, trans=0.0063, rot=0.2584, grad=13.21, nan=0]Epoch 43:  86%|████████▋ | 44/51 [00:00<00:00, 88.06it/s, loss=0.7527, trans=0.0056, rot=0.1895, grad=10.89, nan=0]Epoch 43:  86%|████████▋ | 44/51 [00:00<00:00, 88.06it/s, loss=0.8191, trans=0.0061, rot=0.2128, grad=17.42, nan=0]Epoch 43:  86%|████████▋ | 44/51 [00:00<00:00, 88.06it/s, loss=0.8892, trans=0.0068, rot=0.2046, grad=13.09, nan=0]Epoch 43:  86%|████████▋ | 44/51 [00:00<00:00, 88.06it/s, loss=0.7467, trans=0.0054, rot=0.2057, grad=12.65, nan=0]Epoch 43:  86%|████████▋ | 44/51 [00:00<00:00, 88.06it/s, loss=0.8369, trans=0.0063, rot=0.2022, grad=19.40, nan=0]Epoch 43:  86%|████████▋ | 44/51 [00:00<00:00, 88.06it/s, loss=0.8982, trans=0.0066, rot=0.2348, grad=26.19, nan=0]Epoch 43:  86%|████████▋ | 44/51 [00:00<00:00, 88.06it/s, loss=0.8082, trans=0.0053, rot=0.2817, grad=51.90, nan=0]Epoch 43: 100%|██████████| 51/51 [00:00<00:00, 85.84it/s, loss=0.8082, trans=0.0053, rot=0.2817, grad=51.90, nan=0]
Visual features - mean: 0.003534, std: 1.072032
IMU features - mean: 0.003194, std: 1.031256
GT translations (m) - mean: -0.000151, std: 0.030259
GT quaternions - mean: 0.251307, std: 0.432424
Predicted pose window shape: (1, 7)
[[ 0.05334017  0.05554207 -0.01240339 -0.07615127  0.04851839  0.07531946
  -0.9930628 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.04857231  0.12217015 -0.12973689 -0.04359885 -0.05969844  0.04794278
  -0.99611086]]
  Ground truth relative pose:
[[-1.4296658e-03  4.9874363e-03 -1.4231249e-04 -1.6602427e-03
  -1.1891127e-05  2.9363483e-04  9.9999857e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 189.63it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 181.72it/s]

Epoch 43 Summary:
  Train Loss: 0.919620
  Val Loss: 0.098373
  Val Trans Error: 0.0489 m
  Val Rot Error: 3.54 degrees

============================================================
Epoch 44/50
Learning rate: 0.00000588
============================================================
Epoch 44:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 44:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.7394, trans=0.0050, rot=0.2390, grad=26.13, nan=0]Epoch 44:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9287, trans=0.0073, rot=0.2020, grad=25.55, nan=0]Epoch 44:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0919, trans=0.0087, rot=0.2250, grad=18.61, nan=0]Epoch 44:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8070, trans=0.0061, rot=0.1962, grad=18.46, nan=0]Epoch 44:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9587, trans=0.0075, rot=0.2051, grad=13.54, nan=0]Epoch 44:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.7729, trans=0.0057, rot=0.2029, grad=12.32, nan=0]Epoch 44:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8119, trans=0.0060, rot=0.2140, grad=12.41, nan=0]Epoch 44:  14%|█▎        | 7/51 [00:00<00:00, 63.41it/s, loss=0.8119, trans=0.0060, rot=0.2140, grad=12.41, nan=0]Epoch 44:  14%|█▎        | 7/51 [00:00<00:00, 63.41it/s, loss=0.8334, trans=0.0062, rot=0.2101, grad=21.60, nan=0]Epoch 44:  14%|█▎        | 7/51 [00:00<00:00, 63.41it/s, loss=0.8267, trans=0.0061, rot=0.2166, grad=27.11, nan=0]Epoch 44:  14%|█▎        | 7/51 [00:00<00:00, 63.41it/s, loss=1.0023, trans=0.0077, rot=0.2313, grad=39.32, nan=0]Epoch 44:  14%|█▎        | 7/51 [00:00<00:00, 63.41it/s, loss=1.0812, trans=0.0091, rot=0.1756, grad=19.07, nan=0]Epoch 44:  14%|█▎        | 7/51 [00:00<00:00, 63.41it/s, loss=0.6840, trans=0.0052, rot=0.1641, grad=18.95, nan=0]Epoch 44:  14%|█▎        | 7/51 [00:00<00:00, 63.41it/s, loss=0.9491, trans=0.0076, rot=0.1872, grad=13.61, nan=0]Epoch 44:  14%|█▎        | 7/51 [00:00<00:00, 63.41it/s, loss=0.9562, trans=0.0070, rot=0.2608, grad=22.24, nan=0]Epoch 44:  14%|█▎        | 7/51 [00:00<00:00, 63.41it/s, loss=1.0315, trans=0.0082, rot=0.2121, grad=25.77, nan=0]Epoch 44:  14%|█▎        | 7/51 [00:00<00:00, 63.41it/s, loss=0.9670, trans=0.0078, rot=0.1899, grad=20.67, nan=0]Epoch 44:  14%|█▎        | 7/51 [00:00<00:00, 63.41it/s, loss=0.8219, trans=0.0060, rot=0.2185, grad=22.55, nan=0]Epoch 44:  33%|███▎      | 17/51 [00:00<00:00, 82.50it/s, loss=0.8219, trans=0.0060, rot=0.2185, grad=22.55, nan=0]Epoch 44:  33%|███▎      | 17/51 [00:00<00:00, 82.50it/s, loss=1.0529, trans=0.0086, rot=0.1898, grad=26.93, nan=0]Epoch 44:  33%|███▎      | 17/51 [00:00<00:00, 82.50it/s, loss=0.8274, trans=0.0063, rot=0.1945, grad=24.23, nan=0]Epoch 44:  33%|███▎      | 17/51 [00:00<00:00, 82.50it/s, loss=0.8145, trans=0.0057, rot=0.2420, grad=16.54, nan=0]Epoch 44:  33%|███▎      | 17/51 [00:00<00:00, 82.50it/s, loss=0.8945, trans=0.0066, rot=0.2366, grad=11.26, nan=0]Epoch 44:  33%|███▎      | 17/51 [00:00<00:00, 82.50it/s, loss=0.8188, trans=0.0061, rot=0.2078, grad=25.16, nan=0]Epoch 44:  33%|███▎      | 17/51 [00:00<00:00, 82.50it/s, loss=0.9969, trans=0.0078, rot=0.2165, grad=15.34, nan=0]Epoch 44:  33%|███▎      | 17/51 [00:00<00:00, 82.50it/s, loss=0.7415, trans=0.0055, rot=0.1949, grad=11.99, nan=0]Epoch 44:  33%|███▎      | 17/51 [00:00<00:00, 82.50it/s, loss=0.9637, trans=0.0075, rot=0.2153, grad=29.47, nan=0]Epoch 44:  33%|███▎      | 17/51 [00:00<00:00, 82.50it/s, loss=1.1445, trans=0.0091, rot=0.2295, grad=26.69, nan=0]Epoch 44:  33%|███▎      | 17/51 [00:00<00:00, 82.50it/s, loss=0.9963, trans=0.0079, rot=0.2112, grad=21.17, nan=0]Epoch 44:  53%|█████▎    | 27/51 [00:00<00:00, 86.30it/s, loss=0.9963, trans=0.0079, rot=0.2112, grad=21.17, nan=0]Epoch 44:  53%|█████▎    | 27/51 [00:00<00:00, 86.30it/s, loss=0.9921, trans=0.0076, rot=0.2319, grad=24.28, nan=0]Epoch 44:  53%|█████▎    | 27/51 [00:00<00:00, 86.30it/s, loss=0.8756, trans=0.0070, rot=0.1739, grad=17.05, nan=0]Epoch 44:  53%|█████▎    | 27/51 [00:00<00:00, 86.30it/s, loss=0.7839, trans=0.0057, rot=0.2158, grad=21.39, nan=0]Epoch 44:  53%|█████▎    | 27/51 [00:00<00:00, 86.30it/s, loss=0.8865, trans=0.0063, rot=0.2520, grad=21.45, nan=0]Epoch 44:  53%|█████▎    | 27/51 [00:00<00:00, 86.30it/s, loss=0.8850, trans=0.0071, rot=0.1750, grad=19.01, nan=0]Epoch 44:  53%|█████▎    | 27/51 [00:00<00:00, 86.30it/s, loss=1.0352, trans=0.0082, rot=0.2176, grad=12.53, nan=0]Epoch 44:  53%|█████▎    | 27/51 [00:00<00:00, 86.30it/s, loss=0.7958, trans=0.0060, rot=0.1909, grad=17.64, nan=0]Epoch 44:  53%|█████▎    | 27/51 [00:00<00:00, 86.30it/s, loss=0.7751, trans=0.0055, rot=0.2273, grad=20.30, nan=0]Epoch 44:  53%|█████▎    | 27/51 [00:00<00:00, 86.30it/s, loss=1.0222, trans=0.0078, rot=0.2426, grad=17.66, nan=0]Epoch 44:  53%|█████▎    | 27/51 [00:00<00:00, 86.30it/s, loss=0.9535, trans=0.0072, rot=0.2311, grad=21.54, nan=0]Epoch 44:  73%|███████▎  | 37/51 [00:00<00:00, 91.22it/s, loss=0.9535, trans=0.0072, rot=0.2311, grad=21.54, nan=0]Epoch 44:  73%|███████▎  | 37/51 [00:00<00:00, 91.22it/s, loss=0.9569, trans=0.0075, rot=0.2028, grad=28.80, nan=0]Epoch 44:  73%|███████▎  | 37/51 [00:00<00:00, 91.22it/s, loss=0.9504, trans=0.0076, rot=0.1909, grad=21.51, nan=0]Epoch 44:  73%|███████▎  | 37/51 [00:00<00:00, 91.22it/s, loss=0.8727, trans=0.0067, rot=0.1994, grad=35.92, nan=0]Epoch 44:  73%|███████▎  | 37/51 [00:00<00:00, 91.22it/s, loss=1.0889, trans=0.0083, rot=0.2583, grad=29.21, nan=0]Epoch 44:  73%|███████▎  | 37/51 [00:00<00:00, 91.22it/s, loss=0.8237, trans=0.0059, rot=0.2383, grad=23.12, nan=0]Epoch 44:  73%|███████▎  | 37/51 [00:00<00:00, 91.22it/s, loss=0.9176, trans=0.0068, rot=0.2342, grad=15.74, nan=0]Epoch 44:  73%|███████▎  | 37/51 [00:00<00:00, 91.22it/s, loss=0.7973, trans=0.0060, rot=0.1969, grad=18.66, nan=0]Epoch 44:  73%|███████▎  | 37/51 [00:00<00:00, 91.22it/s, loss=0.9726, trans=0.0072, rot=0.2520, grad=20.71, nan=0]Epoch 44:  73%|███████▎  | 37/51 [00:00<00:00, 91.22it/s, loss=0.7983, trans=0.0062, rot=0.1806, grad=17.14, nan=0]Epoch 44:  73%|███████▎  | 37/51 [00:00<00:00, 91.22it/s, loss=1.0847, trans=0.0086, rot=0.2236, grad=19.47, nan=0]Epoch 44:  73%|███████▎  | 37/51 [00:00<00:00, 91.22it/s, loss=0.7156, trans=0.0055, rot=0.1661, grad=20.49, nan=0]Epoch 44:  94%|█████████▍| 48/51 [00:00<00:00, 95.12it/s, loss=0.7156, trans=0.0055, rot=0.1661, grad=20.49, nan=0]Epoch 44:  94%|█████████▍| 48/51 [00:00<00:00, 95.12it/s, loss=0.8685, trans=0.0066, rot=0.2088, grad=15.97, nan=0]Epoch 44:  94%|█████████▍| 48/51 [00:00<00:00, 95.12it/s, loss=1.0028, trans=0.0076, rot=0.2458, grad=12.97, nan=0]Epoch 44:  94%|█████████▍| 48/51 [00:00<00:00, 95.12it/s, loss=0.8815, trans=0.0074, rot=0.1430, grad=52.68, nan=0]Epoch 44: 100%|██████████| 51/51 [00:00<00:00, 88.61it/s, loss=0.8815, trans=0.0074, rot=0.1430, grad=52.68, nan=0]
Visual features - mean: 0.004079, std: 0.967757
IMU features - mean: 0.002854, std: 0.950169
GT translations (m) - mean: -0.003669, std: 0.044527
GT quaternions - mean: 0.251087, std: 0.432553
Predicted pose window shape: (1, 7)
[[-0.0038476  -0.22072574 -0.08692184  0.06776107 -0.11527516  0.02043776
  -0.99080896]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.00697641  0.18141451  0.23083805  0.05516079 -0.03493899 -0.07457598
  -0.9950754 ]]
  Ground truth relative pose:
[[ 3.6850581e-03  3.2152031e-03 -3.2395450e-03 -1.1658035e-02
  -2.0856561e-02  7.4335933e-04  9.9971426e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 184.70it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 178.47it/s]

Epoch 44 Summary:
  Train Loss: 0.906891
  Val Loss: 0.087258
  Val Trans Error: 0.0428 m
  Val Rot Error: 3.47 degrees
  ✓ New best model saved

============================================================
Epoch 45/50
Learning rate: 0.00000588
============================================================
Epoch 45:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 45:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0008, trans=0.0074, rot=0.2645, grad=13.18, nan=0]Epoch 45:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8891, trans=0.0066, rot=0.2273, grad=29.62, nan=0]Epoch 45:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.7326, trans=0.0054, rot=0.1896, grad=13.96, nan=0]Epoch 45:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9173, trans=0.0068, rot=0.2421, grad=24.66, nan=0]Epoch 45:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0705, trans=0.0085, rot=0.2241, grad=27.78, nan=0]Epoch 45:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8090, trans=0.0061, rot=0.2019, grad=28.18, nan=0]Epoch 45:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0435, trans=0.0079, rot=0.2500, grad=21.34, nan=0]Epoch 45:  14%|█▎        | 7/51 [00:00<00:00, 66.87it/s, loss=1.0435, trans=0.0079, rot=0.2500, grad=21.34, nan=0]Epoch 45:  14%|█▎        | 7/51 [00:00<00:00, 66.87it/s, loss=0.7536, trans=0.0052, rot=0.2288, grad=21.42, nan=0]Epoch 45:  14%|█▎        | 7/51 [00:00<00:00, 66.87it/s, loss=0.9352, trans=0.0070, rot=0.2368, grad=19.95, nan=0]Epoch 45:  14%|█▎        | 7/51 [00:00<00:00, 66.87it/s, loss=0.9797, trans=0.0075, rot=0.2286, grad=20.83, nan=0]Epoch 45:  14%|█▎        | 7/51 [00:00<00:00, 66.87it/s, loss=0.9534, trans=0.0074, rot=0.2109, grad=22.74, nan=0]Epoch 45:  14%|█▎        | 7/51 [00:00<00:00, 66.87it/s, loss=0.9113, trans=0.0066, rot=0.2485, grad=12.38, nan=0]Epoch 45:  14%|█▎        | 7/51 [00:00<00:00, 66.87it/s, loss=0.6975, trans=0.0049, rot=0.2086, grad=23.64, nan=0]Epoch 45:  14%|█▎        | 7/51 [00:00<00:00, 66.87it/s, loss=0.8387, trans=0.0063, rot=0.2096, grad=22.80, nan=0]Epoch 45:  14%|█▎        | 7/51 [00:00<00:00, 66.87it/s, loss=0.8449, trans=0.0062, rot=0.2222, grad=28.10, nan=0]Epoch 45:  14%|█▎        | 7/51 [00:00<00:00, 66.87it/s, loss=1.0393, trans=0.0083, rot=0.2076, grad=24.08, nan=0]Epoch 45:  14%|█▎        | 7/51 [00:00<00:00, 66.87it/s, loss=1.0455, trans=0.0081, rot=0.2347, grad=16.52, nan=0]Epoch 45:  14%|█▎        | 7/51 [00:00<00:00, 66.87it/s, loss=0.7149, trans=0.0049, rot=0.2235, grad=16.75, nan=0]Epoch 45:  35%|███▌      | 18/51 [00:00<00:00, 86.18it/s, loss=0.7149, trans=0.0049, rot=0.2235, grad=16.75, nan=0]Epoch 45:  35%|███▌      | 18/51 [00:00<00:00, 86.18it/s, loss=0.7358, trans=0.0055, rot=0.1811, grad=18.88, nan=0]Epoch 45:  35%|███▌      | 18/51 [00:00<00:00, 86.18it/s, loss=0.8071, trans=0.0061, rot=0.2016, grad=21.41, nan=0]Epoch 45:  35%|███▌      | 18/51 [00:00<00:00, 86.18it/s, loss=1.0329, trans=0.0081, rot=0.2224, grad=28.30, nan=0]Epoch 45:  35%|███▌      | 18/51 [00:00<00:00, 86.18it/s, loss=0.7659, trans=0.0054, rot=0.2304, grad=12.32, nan=0]Epoch 45:  35%|███▌      | 18/51 [00:00<00:00, 86.18it/s, loss=1.0883, trans=0.0085, rot=0.2359, grad=20.46, nan=0]Epoch 45:  35%|███▌      | 18/51 [00:00<00:00, 86.18it/s, loss=0.9065, trans=0.0073, rot=0.1798, grad=11.85, nan=0]Epoch 45:  35%|███▌      | 18/51 [00:00<00:00, 86.18it/s, loss=0.9964, trans=0.0076, rot=0.2334, grad=12.06, nan=0]Epoch 45:  35%|███▌      | 18/51 [00:00<00:00, 86.18it/s, loss=0.9284, trans=0.0069, rot=0.2417, grad=23.73, nan=0]Epoch 45:  35%|███▌      | 18/51 [00:00<00:00, 86.18it/s, loss=0.7608, trans=0.0057, rot=0.1869, grad=18.65, nan=0]Epoch 45:  35%|███▌      | 18/51 [00:00<00:00, 86.18it/s, loss=0.8693, trans=0.0065, rot=0.2202, grad=22.98, nan=0]Epoch 45:  55%|█████▍    | 28/51 [00:00<00:00, 90.60it/s, loss=0.8693, trans=0.0065, rot=0.2202, grad=22.98, nan=0]Epoch 45:  55%|█████▍    | 28/51 [00:00<00:00, 90.60it/s, loss=0.8795, trans=0.0069, rot=0.1871, grad=18.76, nan=0]Epoch 45:  55%|█████▍    | 28/51 [00:00<00:00, 90.60it/s, loss=1.1044, trans=0.0085, rot=0.2501, grad=22.73, nan=0]Epoch 45:  55%|█████▍    | 28/51 [00:00<00:00, 90.60it/s, loss=0.8197, trans=0.0061, rot=0.2098, grad=19.93, nan=0]Epoch 45:  55%|█████▍    | 28/51 [00:00<00:00, 90.60it/s, loss=0.9599, trans=0.0077, rot=0.1860, grad=19.63, nan=0]Epoch 45:  55%|█████▍    | 28/51 [00:00<00:00, 90.60it/s, loss=0.9248, trans=0.0069, rot=0.2311, grad=22.76, nan=0]Epoch 45:  55%|█████▍    | 28/51 [00:00<00:00, 90.60it/s, loss=0.8379, trans=0.0061, rot=0.2232, grad=22.78, nan=0]Epoch 45:  55%|█████▍    | 28/51 [00:00<00:00, 90.60it/s, loss=0.8442, trans=0.0064, rot=0.2075, grad=23.92, nan=0]Epoch 45:  55%|█████▍    | 28/51 [00:00<00:00, 90.60it/s, loss=0.7880, trans=0.0056, rot=0.2289, grad=17.62, nan=0]Epoch 45:  55%|█████▍    | 28/51 [00:00<00:00, 90.60it/s, loss=0.7992, trans=0.0057, rot=0.2338, grad=17.41, nan=0]Epoch 45:  55%|█████▍    | 28/51 [00:00<00:00, 90.60it/s, loss=0.9651, trans=0.0068, rot=0.2890, grad=29.08, nan=0]Epoch 45:  75%|███████▍  | 38/51 [00:00<00:00, 93.94it/s, loss=0.9651, trans=0.0068, rot=0.2890, grad=29.08, nan=0]Epoch 45:  75%|███████▍  | 38/51 [00:00<00:00, 93.94it/s, loss=0.7063, trans=0.0049, rot=0.2213, grad=10.84, nan=0]Epoch 45:  75%|███████▍  | 38/51 [00:00<00:00, 93.94it/s, loss=1.1016, trans=0.0090, rot=0.2006, grad=29.64, nan=0]Epoch 45:  75%|███████▍  | 38/51 [00:00<00:00, 93.94it/s, loss=0.8721, trans=0.0069, rot=0.1838, grad=34.50, nan=0]Epoch 45:  75%|███████▍  | 38/51 [00:00<00:00, 93.94it/s, loss=0.8733, trans=0.0066, rot=0.2102, grad=13.72, nan=0]Epoch 45:  75%|███████▍  | 38/51 [00:00<00:00, 93.94it/s, loss=1.0238, trans=0.0079, rot=0.2326, grad=22.40, nan=0]Epoch 45:  75%|███████▍  | 38/51 [00:00<00:00, 93.94it/s, loss=0.7932, trans=0.0059, rot=0.2076, grad=13.12, nan=0]Epoch 45:  75%|███████▍  | 38/51 [00:00<00:00, 93.94it/s, loss=1.1047, trans=0.0084, rot=0.2599, grad=21.37, nan=0]Epoch 45:  75%|███████▍  | 38/51 [00:00<00:00, 93.94it/s, loss=1.0233, trans=0.0080, rot=0.2260, grad=21.11, nan=0]Epoch 45:  75%|███████▍  | 38/51 [00:00<00:00, 93.94it/s, loss=0.8540, trans=0.0065, rot=0.1997, grad=23.97, nan=0]Epoch 45:  75%|███████▍  | 38/51 [00:00<00:00, 93.94it/s, loss=0.7583, trans=0.0057, rot=0.1890, grad=15.15, nan=0]Epoch 45:  75%|███████▍  | 38/51 [00:00<00:00, 93.94it/s, loss=1.0349, trans=0.0081, rot=0.2206, grad=21.19, nan=0]Epoch 45:  96%|█████████▌| 49/51 [00:00<00:00, 98.37it/s, loss=1.0349, trans=0.0081, rot=0.2206, grad=21.19, nan=0]Epoch 45:  96%|█████████▌| 49/51 [00:00<00:00, 98.37it/s, loss=0.6111, trans=0.0042, rot=0.1922, grad=9.14, nan=0] Epoch 45:  96%|█████████▌| 49/51 [00:00<00:00, 98.37it/s, loss=0.5550, trans=0.0041, rot=0.1495, grad=28.66, nan=0]Epoch 45: 100%|██████████| 51/51 [00:00<00:00, 92.04it/s, loss=0.5550, trans=0.0041, rot=0.1495, grad=28.66, nan=0]
Visual features - mean: 0.002097, std: 0.925258
IMU features - mean: -0.007613, std: 1.310997
GT translations (m) - mean: -0.001366, std: 0.026776
GT quaternions - mean: 0.248605, std: 0.433985
Predicted pose window shape: (1, 7)
[[-0.10407977 -0.11632997  0.12306701 -0.0026851   0.00379621 -0.02698343
  -0.9996251 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.02100008  0.11255647  0.04340816  0.09154993 -0.05757797  0.01872767
  -0.99395806]]
  Ground truth relative pose:
[[-0.00275079  0.00106981 -0.00153138  0.00318563 -0.00898382 -0.01765309
   0.9997988 ]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 187.51it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 177.34it/s]

Epoch 45 Summary:
  Train Loss: 0.888288
  Val Loss: 0.090418
  Val Trans Error: 0.0439 m
  Val Rot Error: 3.53 degrees

============================================================
Epoch 46/50
Learning rate: 0.00000588
============================================================
Epoch 46:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 46:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8190, trans=0.0063, rot=0.1897, grad=20.54, nan=0]Epoch 46:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9093, trans=0.0069, rot=0.2179, grad=26.78, nan=0]Epoch 46:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8964, trans=0.0067, rot=0.2217, grad=15.59, nan=0]Epoch 46:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9684, trans=0.0076, rot=0.2089, grad=24.10, nan=0]Epoch 46:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9410, trans=0.0072, rot=0.2243, grad=22.10, nan=0]Epoch 46:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8448, trans=0.0062, rot=0.2237, grad=17.29, nan=0]Epoch 46:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9567, trans=0.0076, rot=0.2005, grad=32.33, nan=0]Epoch 46:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=0.9567, trans=0.0076, rot=0.2005, grad=32.33, nan=0]Epoch 46:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=1.2147, trans=0.0100, rot=0.2130, grad=31.68, nan=0]Epoch 46:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=0.7682, trans=0.0056, rot=0.2130, grad=15.63, nan=0]Epoch 46:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=0.7471, trans=0.0055, rot=0.1930, grad=19.05, nan=0]Epoch 46:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=0.9357, trans=0.0072, rot=0.2150, grad=14.55, nan=0]Epoch 46:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=0.7650, trans=0.0058, rot=0.1885, grad=11.99, nan=0]Epoch 46:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=0.8207, trans=0.0060, rot=0.2254, grad=20.99, nan=0]Epoch 46:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=0.7847, trans=0.0057, rot=0.2115, grad=17.08, nan=0]Epoch 46:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=0.8669, trans=0.0065, rot=0.2153, grad=15.62, nan=0]Epoch 46:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=0.8178, trans=0.0060, rot=0.2169, grad=13.54, nan=0]Epoch 46:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=0.9027, trans=0.0065, rot=0.2510, grad=14.78, nan=0]Epoch 46:  14%|█▎        | 7/51 [00:00<00:00, 68.21it/s, loss=0.6714, trans=0.0048, rot=0.1875, grad=21.11, nan=0]Epoch 46:  35%|███▌      | 18/51 [00:00<00:00, 90.66it/s, loss=0.6714, trans=0.0048, rot=0.1875, grad=21.11, nan=0]Epoch 46:  35%|███▌      | 18/51 [00:00<00:00, 90.66it/s, loss=1.1117, trans=0.0088, rot=0.2298, grad=32.25, nan=0]Epoch 46:  35%|███▌      | 18/51 [00:00<00:00, 90.66it/s, loss=0.8706, trans=0.0060, rot=0.2706, grad=22.46, nan=0]Epoch 46:  35%|███▌      | 18/51 [00:00<00:00, 90.66it/s, loss=0.8413, trans=0.0064, rot=0.1970, grad=16.38, nan=0]Epoch 46:  35%|███▌      | 18/51 [00:00<00:00, 90.66it/s, loss=0.9343, trans=0.0073, rot=0.2039, grad=24.24, nan=0]Epoch 46:  35%|███▌      | 18/51 [00:00<00:00, 90.66it/s, loss=1.0184, trans=0.0083, rot=0.1890, grad=23.96, nan=0]Epoch 46:  35%|███▌      | 18/51 [00:00<00:00, 90.66it/s, loss=0.7112, trans=0.0047, rot=0.2437, grad=15.39, nan=0]Epoch 46:  35%|███▌      | 18/51 [00:00<00:00, 90.66it/s, loss=0.8746, trans=0.0066, rot=0.2176, grad=16.11, nan=0]Epoch 46:  35%|███▌      | 18/51 [00:00<00:00, 90.66it/s, loss=0.9184, trans=0.0070, rot=0.2223, grad=38.84, nan=0]Epoch 46:  35%|███▌      | 18/51 [00:00<00:00, 90.66it/s, loss=0.8532, trans=0.0062, rot=0.2352, grad=15.66, nan=0]Epoch 46:  35%|███▌      | 18/51 [00:00<00:00, 90.66it/s, loss=0.8533, trans=0.0066, rot=0.1944, grad=18.69, nan=0]Epoch 46:  35%|███▌      | 18/51 [00:00<00:00, 90.66it/s, loss=0.6996, trans=0.0054, rot=0.1632, grad=19.36, nan=0]Epoch 46:  57%|█████▋    | 29/51 [00:00<00:00, 97.66it/s, loss=0.6996, trans=0.0054, rot=0.1632, grad=19.36, nan=0]Epoch 46:  57%|█████▋    | 29/51 [00:00<00:00, 97.66it/s, loss=0.8010, trans=0.0059, rot=0.2153, grad=15.65, nan=0]Epoch 46:  57%|█████▋    | 29/51 [00:00<00:00, 97.66it/s, loss=0.8824, trans=0.0069, rot=0.1947, grad=13.72, nan=0]Epoch 46:  57%|█████▋    | 29/51 [00:00<00:00, 97.66it/s, loss=0.9532, trans=0.0073, rot=0.2212, grad=30.40, nan=0]Epoch 46:  57%|█████▋    | 29/51 [00:00<00:00, 97.66it/s, loss=1.0747, trans=0.0082, rot=0.2532, grad=19.08, nan=0]Epoch 46:  57%|█████▋    | 29/51 [00:00<00:00, 97.66it/s, loss=0.7704, trans=0.0055, rot=0.2166, grad=13.82, nan=0]Epoch 46:  57%|█████▋    | 29/51 [00:00<00:00, 97.66it/s, loss=0.9314, trans=0.0071, rot=0.2218, grad=16.54, nan=0]Epoch 46:  57%|█████▋    | 29/51 [00:00<00:00, 97.66it/s, loss=0.8972, trans=0.0069, rot=0.2051, grad=22.41, nan=0]Epoch 46:  57%|█████▋    | 29/51 [00:00<00:00, 97.66it/s, loss=1.1613, trans=0.0096, rot=0.2007, grad=34.21, nan=0]Epoch 46:  57%|█████▋    | 29/51 [00:00<00:00, 97.66it/s, loss=0.8989, trans=0.0068, rot=0.2140, grad=17.89, nan=0]Epoch 46:  57%|█████▋    | 29/51 [00:00<00:00, 97.66it/s, loss=0.9573, trans=0.0074, rot=0.2201, grad=44.89, nan=0]Epoch 46:  57%|█████▋    | 29/51 [00:00<00:00, 97.66it/s, loss=0.8222, trans=0.0058, rot=0.2424, grad=15.82, nan=0]Epoch 46:  78%|███████▊  | 40/51 [00:00<00:00, 101.31it/s, loss=0.8222, trans=0.0058, rot=0.2424, grad=15.82, nan=0]Epoch 46:  78%|███████▊  | 40/51 [00:00<00:00, 101.31it/s, loss=0.8138, trans=0.0056, rot=0.2557, grad=10.79, nan=0]Epoch 46:  78%|███████▊  | 40/51 [00:00<00:00, 101.31it/s, loss=0.8563, trans=0.0065, rot=0.2027, grad=34.46, nan=0]Epoch 46:  78%|███████▊  | 40/51 [00:00<00:00, 101.31it/s, loss=0.7394, trans=0.0054, rot=0.1961, grad=15.18, nan=0]Epoch 46:  78%|███████▊  | 40/51 [00:00<00:00, 101.31it/s, loss=0.8695, trans=0.0068, rot=0.1944, grad=20.85, nan=0]Epoch 46:  78%|███████▊  | 40/51 [00:00<00:00, 101.31it/s, loss=1.0801, trans=0.0085, rot=0.2307, grad=21.97, nan=0]Epoch 46:  78%|███████▊  | 40/51 [00:00<00:00, 101.31it/s, loss=0.8144, trans=0.0061, rot=0.2079, grad=18.09, nan=0]Epoch 46:  78%|███████▊  | 40/51 [00:00<00:00, 101.31it/s, loss=0.8733, trans=0.0067, rot=0.2012, grad=16.59, nan=0]Epoch 46:  78%|███████▊  | 40/51 [00:00<00:00, 101.31it/s, loss=0.7981, trans=0.0060, rot=0.1936, grad=18.46, nan=0]Epoch 46:  78%|███████▊  | 40/51 [00:00<00:00, 101.31it/s, loss=0.9655, trans=0.0075, rot=0.2107, grad=20.42, nan=0]Epoch 46:  78%|███████▊  | 40/51 [00:00<00:00, 101.31it/s, loss=0.7438, trans=0.0057, rot=0.1787, grad=21.85, nan=0]Epoch 46:  78%|███████▊  | 40/51 [00:00<00:00, 101.31it/s, loss=0.8749, trans=0.0066, rot=0.2117, grad=64.35, nan=0]Epoch 46: 100%|██████████| 51/51 [00:00<00:00, 101.62it/s, loss=0.8749, trans=0.0066, rot=0.2117, grad=64.35, nan=0]Epoch 46: 100%|██████████| 51/51 [00:00<00:00, 95.39it/s, loss=0.8749, trans=0.0066, rot=0.2117, grad=64.35, nan=0] 
Visual features - mean: 0.001438, std: 1.075374
IMU features - mean: -0.004396, std: 0.871115
GT translations (m) - mean: -0.002480, std: 0.027421
GT quaternions - mean: 0.251745, std: 0.432170
Predicted pose window shape: (1, 7)
[[ 0.03442022  0.13571021 -0.18439263  0.01351436 -0.02847014  0.10159445
  -0.99432665]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-5.8760621e-02 -7.0982799e-04  9.3581993e-03  2.9404500e-02
   1.2087188e-02 -5.4050662e-02 -9.9803197e-01]]
  Ground truth relative pose:
[[ 4.1237724e-04 -9.4610907e-05  3.8540197e-04  2.8757754e-04
   2.6777390e-04  1.4883281e-04  9.9999994e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 189.58it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 180.76it/s]

Epoch 46 Summary:
  Train Loss: 0.880312
  Val Loss: 0.085521
  Val Trans Error: 0.0430 m
  Val Rot Error: 3.37 degrees
  ✓ New best model saved

============================================================
Epoch 47/50
Learning rate: 0.00000588
============================================================
Epoch 47:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 47:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8764, trans=0.0068, rot=0.1987, grad=12.75, nan=0]Epoch 47:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9711, trans=0.0076, rot=0.2111, grad=29.51, nan=0]Epoch 47:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8221, trans=0.0056, rot=0.2637, grad=20.88, nan=0]Epoch 47:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8121, trans=0.0058, rot=0.2327, grad=18.20, nan=0]Epoch 47:   0%|          | 0/51 [00:00<?, ?it/s, loss=1.0878, trans=0.0081, rot=0.2730, grad=28.62, nan=0]Epoch 47:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.6905, trans=0.0047, rot=0.2162, grad=12.63, nan=0]Epoch 47:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.7418, trans=0.0057, rot=0.1702, grad=19.40, nan=0]Epoch 47:  14%|█▎        | 7/51 [00:00<00:00, 66.81it/s, loss=0.7418, trans=0.0057, rot=0.1702, grad=19.40, nan=0]Epoch 47:  14%|█▎        | 7/51 [00:00<00:00, 66.81it/s, loss=0.8774, trans=0.0067, rot=0.2121, grad=20.36, nan=0]Epoch 47:  14%|█▎        | 7/51 [00:00<00:00, 66.81it/s, loss=0.7807, trans=0.0057, rot=0.2139, grad=14.15, nan=0]Epoch 47:  14%|█▎        | 7/51 [00:00<00:00, 66.81it/s, loss=0.6946, trans=0.0049, rot=0.2003, grad=32.70, nan=0]Epoch 47:  14%|█▎        | 7/51 [00:00<00:00, 66.81it/s, loss=0.9188, trans=0.0067, rot=0.2491, grad=13.26, nan=0]Epoch 47:  14%|█▎        | 7/51 [00:00<00:00, 66.81it/s, loss=0.7801, trans=0.0054, rot=0.2433, grad=17.44, nan=0]Epoch 47:  14%|█▎        | 7/51 [00:00<00:00, 66.81it/s, loss=0.8529, trans=0.0064, rot=0.2092, grad=16.23, nan=0]Epoch 47:  14%|█▎        | 7/51 [00:00<00:00, 66.81it/s, loss=0.8291, trans=0.0062, rot=0.2069, grad=23.65, nan=0]Epoch 47:  14%|█▎        | 7/51 [00:00<00:00, 66.81it/s, loss=0.8522, trans=0.0067, rot=0.1868, grad=30.09, nan=0]Epoch 47:  14%|█▎        | 7/51 [00:00<00:00, 66.81it/s, loss=0.8450, trans=0.0063, rot=0.2168, grad=14.60, nan=0]Epoch 47:  14%|█▎        | 7/51 [00:00<00:00, 66.81it/s, loss=0.8276, trans=0.0064, rot=0.1912, grad=13.27, nan=0]Epoch 47:  14%|█▎        | 7/51 [00:00<00:00, 66.81it/s, loss=0.8670, trans=0.0063, rot=0.2386, grad=16.81, nan=0]Epoch 47:  35%|███▌      | 18/51 [00:00<00:00, 89.13it/s, loss=0.8670, trans=0.0063, rot=0.2386, grad=16.81, nan=0]Epoch 47:  35%|███▌      | 18/51 [00:00<00:00, 89.13it/s, loss=0.9117, trans=0.0071, rot=0.2046, grad=17.15, nan=0]Epoch 47:  35%|███▌      | 18/51 [00:00<00:00, 89.13it/s, loss=0.7202, trans=0.0053, rot=0.1938, grad=18.77, nan=0]Epoch 47:  35%|███▌      | 18/51 [00:00<00:00, 89.13it/s, loss=0.9792, trans=0.0076, rot=0.2208, grad=37.81, nan=0]Epoch 47:  35%|███▌      | 18/51 [00:00<00:00, 89.13it/s, loss=0.8777, trans=0.0062, rot=0.2619, grad=27.19, nan=0]Epoch 47:  35%|███▌      | 18/51 [00:00<00:00, 89.13it/s, loss=1.0635, trans=0.0083, rot=0.2342, grad=32.75, nan=0]Epoch 47:  35%|███▌      | 18/51 [00:00<00:00, 89.13it/s, loss=0.9417, trans=0.0071, rot=0.2311, grad=24.29, nan=0]Epoch 47:  35%|███▌      | 18/51 [00:00<00:00, 89.13it/s, loss=0.7293, trans=0.0053, rot=0.2009, grad=15.85, nan=0]Epoch 47:  35%|███▌      | 18/51 [00:00<00:00, 89.13it/s, loss=0.6478, trans=0.0046, rot=0.1908, grad=19.54, nan=0]Epoch 47:  35%|███▌      | 18/51 [00:00<00:00, 89.13it/s, loss=0.9361, trans=0.0075, rot=0.1908, grad=27.31, nan=0]Epoch 47:  35%|███▌      | 18/51 [00:00<00:00, 89.13it/s, loss=0.8405, trans=0.0064, rot=0.2039, grad=24.36, nan=0]Epoch 47:  35%|███▌      | 18/51 [00:00<00:00, 89.13it/s, loss=0.8996, trans=0.0072, rot=0.1844, grad=31.40, nan=0]Epoch 47:  57%|█████▋    | 29/51 [00:00<00:00, 97.26it/s, loss=0.8996, trans=0.0072, rot=0.1844, grad=31.40, nan=0]Epoch 47:  57%|█████▋    | 29/51 [00:00<00:00, 97.26it/s, loss=0.9088, trans=0.0070, rot=0.2134, grad=31.03, nan=0]Epoch 47:  57%|█████▋    | 29/51 [00:00<00:00, 97.26it/s, loss=1.1544, trans=0.0093, rot=0.2279, grad=37.73, nan=0]Epoch 47:  57%|█████▋    | 29/51 [00:00<00:00, 97.26it/s, loss=0.8353, trans=0.0061, rot=0.2248, grad=31.80, nan=0]Epoch 47:  57%|█████▋    | 29/51 [00:00<00:00, 97.26it/s, loss=0.8074, trans=0.0062, rot=0.1923, grad=17.96, nan=0]Epoch 47:  57%|█████▋    | 29/51 [00:00<00:00, 97.26it/s, loss=0.8023, trans=0.0059, rot=0.2082, grad=27.06, nan=0]Epoch 47:  57%|█████▋    | 29/51 [00:00<00:00, 97.26it/s, loss=0.8229, trans=0.0061, rot=0.2096, grad=22.38, nan=0]Epoch 47:  57%|█████▋    | 29/51 [00:00<00:00, 97.26it/s, loss=0.8860, trans=0.0068, rot=0.2098, grad=15.70, nan=0]Epoch 47:  57%|█████▋    | 29/51 [00:00<00:00, 97.26it/s, loss=0.7871, trans=0.0059, rot=0.1988, grad=21.06, nan=0]Epoch 47:  57%|█████▋    | 29/51 [00:00<00:00, 97.26it/s, loss=0.9452, trans=0.0069, rot=0.2529, grad=21.97, nan=0]Epoch 47:  57%|█████▋    | 29/51 [00:00<00:00, 97.26it/s, loss=0.7763, trans=0.0059, rot=0.1840, grad=21.74, nan=0]Epoch 47:  57%|█████▋    | 29/51 [00:00<00:00, 97.26it/s, loss=0.7176, trans=0.0050, rot=0.2133, grad=11.67, nan=0]Epoch 47:  78%|███████▊  | 40/51 [00:00<00:00, 99.25it/s, loss=0.7176, trans=0.0050, rot=0.2133, grad=11.67, nan=0]Epoch 47:  78%|███████▊  | 40/51 [00:00<00:00, 99.25it/s, loss=0.8686, trans=0.0062, rot=0.2480, grad=18.77, nan=0]Epoch 47:  78%|███████▊  | 40/51 [00:00<00:00, 99.25it/s, loss=0.9342, trans=0.0071, rot=0.2229, grad=23.36, nan=0]Epoch 47:  78%|███████▊  | 40/51 [00:00<00:00, 99.25it/s, loss=0.7639, trans=0.0057, rot=0.1945, grad=15.15, nan=0]Epoch 47:  78%|███████▊  | 40/51 [00:00<00:00, 99.25it/s, loss=0.6968, trans=0.0047, rot=0.2257, grad=17.50, nan=0]Epoch 47:  78%|███████▊  | 40/51 [00:00<00:00, 99.25it/s, loss=0.7339, trans=0.0054, rot=0.1918, grad=18.51, nan=0]Epoch 47:  78%|███████▊  | 40/51 [00:00<00:00, 99.25it/s, loss=0.7755, trans=0.0060, rot=0.1754, grad=15.88, nan=0]Epoch 47:  78%|███████▊  | 40/51 [00:00<00:00, 99.25it/s, loss=0.7516, trans=0.0055, rot=0.2030, grad=13.58, nan=0]Epoch 47:  78%|███████▊  | 40/51 [00:00<00:00, 99.25it/s, loss=0.8650, trans=0.0062, rot=0.2405, grad=16.76, nan=0]Epoch 47:  78%|███████▊  | 40/51 [00:00<00:00, 99.25it/s, loss=0.7102, trans=0.0053, rot=0.1840, grad=19.83, nan=0]Epoch 47:  78%|███████▊  | 40/51 [00:00<00:00, 99.25it/s, loss=0.8681, trans=0.0070, rot=0.1697, grad=31.66, nan=0]Epoch 47:  98%|█████████▊| 50/51 [00:00<00:00, 97.49it/s, loss=0.8681, trans=0.0070, rot=0.1697, grad=31.66, nan=0]Epoch 47:  98%|█████████▊| 50/51 [00:00<00:00, 97.49it/s, loss=1.2798, trans=0.0094, rot=0.3404, grad=44.94, nan=0]Epoch 47: 100%|██████████| 51/51 [00:00<00:00, 92.99it/s, loss=1.2798, trans=0.0094, rot=0.3404, grad=44.94, nan=0]
Visual features - mean: 0.000222, std: 1.085333
IMU features - mean: 0.001479, std: 0.807282
GT translations (m) - mean: -0.001558, std: 0.037958
GT quaternions - mean: 0.250744, std: 0.432751
Predicted pose window shape: (1, 7)
[[-0.03951714 -0.12260906 -0.01509728 -0.0071987   0.04609182  0.026095
  -0.9985703 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.06937671  0.10975746  0.03198975  0.03921588 -0.00857285  0.00501979
  -0.99918133]]
  Ground truth relative pose:
[[ 0.0318617   0.02966701  0.0301009   0.02081144 -0.00803232 -0.01356046
   0.9996592 ]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  91%|█████████ | 20/22 [00:00<00:00, 196.69it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 182.35it/s]

Epoch 47 Summary:
  Train Loss: 0.850301
  Val Loss: 0.087545
  Val Trans Error: 0.0441 m
  Val Rot Error: 3.39 degrees

============================================================
Epoch 48/50
Learning rate: 0.00000588
============================================================
Epoch 48:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 48:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8003, trans=0.0059, rot=0.2077, grad=18.03, nan=0]Epoch 48:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9361, trans=0.0074, rot=0.1967, grad=25.64, nan=0]Epoch 48:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9163, trans=0.0069, rot=0.2224, grad=26.29, nan=0]Epoch 48:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8235, trans=0.0063, rot=0.1915, grad=34.31, nan=0]Epoch 48:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9384, trans=0.0071, rot=0.2247, grad=13.66, nan=0]Epoch 48:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.7722, trans=0.0055, rot=0.2180, grad=15.83, nan=0]Epoch 48:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.7887, trans=0.0059, rot=0.1960, grad=10.69, nan=0]Epoch 48:  14%|█▎        | 7/51 [00:00<00:00, 66.90it/s, loss=0.7887, trans=0.0059, rot=0.1960, grad=10.69, nan=0]Epoch 48:  14%|█▎        | 7/51 [00:00<00:00, 66.90it/s, loss=0.7243, trans=0.0053, rot=0.1905, grad=14.70, nan=0]Epoch 48:  14%|█▎        | 7/51 [00:00<00:00, 66.90it/s, loss=0.9344, trans=0.0072, rot=0.2099, grad=20.77, nan=0]Epoch 48:  14%|█▎        | 7/51 [00:00<00:00, 66.90it/s, loss=0.8596, trans=0.0066, rot=0.2013, grad=24.38, nan=0]Epoch 48:  14%|█▎        | 7/51 [00:00<00:00, 66.90it/s, loss=0.8934, trans=0.0067, rot=0.2268, grad=19.15, nan=0]Epoch 48:  14%|█▎        | 7/51 [00:00<00:00, 66.90it/s, loss=0.7828, trans=0.0058, rot=0.2025, grad=17.40, nan=0]Epoch 48:  14%|█▎        | 7/51 [00:00<00:00, 66.90it/s, loss=0.9055, trans=0.0066, rot=0.2446, grad=17.79, nan=0]Epoch 48:  14%|█▎        | 7/51 [00:00<00:00, 66.90it/s, loss=0.7843, trans=0.0061, rot=0.1783, grad=16.12, nan=0]Epoch 48:  14%|█▎        | 7/51 [00:00<00:00, 66.90it/s, loss=0.8158, trans=0.0061, rot=0.2045, grad=17.71, nan=0]Epoch 48:  14%|█▎        | 7/51 [00:00<00:00, 66.90it/s, loss=0.6717, trans=0.0048, rot=0.1878, grad=17.66, nan=0]Epoch 48:  14%|█▎        | 7/51 [00:00<00:00, 66.90it/s, loss=0.7762, trans=0.0056, rot=0.2152, grad=14.32, nan=0]Epoch 48:  33%|███▎      | 17/51 [00:00<00:00, 85.99it/s, loss=0.7762, trans=0.0056, rot=0.2152, grad=14.32, nan=0]Epoch 48:  33%|███▎      | 17/51 [00:00<00:00, 85.99it/s, loss=0.7836, trans=0.0053, rot=0.2499, grad=11.54, nan=0]Epoch 48:  33%|███▎      | 17/51 [00:00<00:00, 85.99it/s, loss=0.7269, trans=0.0052, rot=0.2100, grad=19.72, nan=0]Epoch 48:  33%|███▎      | 17/51 [00:00<00:00, 85.99it/s, loss=0.8111, trans=0.0063, rot=0.1766, grad=16.47, nan=0]Epoch 48:  33%|███▎      | 17/51 [00:00<00:00, 85.99it/s, loss=0.7213, trans=0.0050, rot=0.2216, grad=25.06, nan=0]Epoch 48:  33%|███▎      | 17/51 [00:00<00:00, 85.99it/s, loss=0.8840, trans=0.0065, rot=0.2380, grad=17.27, nan=0]Epoch 48:  33%|███▎      | 17/51 [00:00<00:00, 85.99it/s, loss=0.8693, trans=0.0066, rot=0.2076, grad=19.36, nan=0]Epoch 48:  33%|███▎      | 17/51 [00:00<00:00, 85.99it/s, loss=0.7604, trans=0.0058, rot=0.1805, grad=12.48, nan=0]Epoch 48:  33%|███▎      | 17/51 [00:00<00:00, 85.99it/s, loss=0.8136, trans=0.0063, rot=0.1797, grad=14.31, nan=0]Epoch 48:  33%|███▎      | 17/51 [00:00<00:00, 85.99it/s, loss=0.8146, trans=0.0065, rot=0.1659, grad=16.99, nan=0]Epoch 48:  33%|███▎      | 17/51 [00:00<00:00, 85.99it/s, loss=0.9319, trans=0.0075, rot=0.1848, grad=10.18, nan=0]Epoch 48:  33%|███▎      | 17/51 [00:00<00:00, 85.99it/s, loss=0.7875, trans=0.0057, rot=0.2214, grad=25.85, nan=0]Epoch 48:  55%|█████▍    | 28/51 [00:00<00:00, 93.78it/s, loss=0.7875, trans=0.0057, rot=0.2214, grad=25.85, nan=0]Epoch 48:  55%|█████▍    | 28/51 [00:00<00:00, 93.78it/s, loss=0.8213, trans=0.0061, rot=0.2124, grad=29.42, nan=0]Epoch 48:  55%|█████▍    | 28/51 [00:00<00:00, 93.78it/s, loss=0.8100, trans=0.0056, rot=0.2464, grad=22.98, nan=0]Epoch 48:  55%|█████▍    | 28/51 [00:00<00:00, 93.78it/s, loss=0.7130, trans=0.0051, rot=0.2026, grad=27.23, nan=0]Epoch 48:  55%|█████▍    | 28/51 [00:00<00:00, 93.78it/s, loss=1.0304, trans=0.0083, rot=0.1960, grad=19.44, nan=0]Epoch 48:  55%|█████▍    | 28/51 [00:00<00:00, 93.78it/s, loss=0.8679, trans=0.0067, rot=0.1938, grad=12.06, nan=0]Epoch 48:  55%|█████▍    | 28/51 [00:00<00:00, 93.78it/s, loss=1.0085, trans=0.0079, rot=0.2177, grad=12.98, nan=0]Epoch 48:  55%|█████▍    | 28/51 [00:00<00:00, 93.78it/s, loss=0.9064, trans=0.0070, rot=0.2043, grad=22.61, nan=0]Epoch 48:  55%|█████▍    | 28/51 [00:00<00:00, 93.78it/s, loss=0.7417, trans=0.0055, rot=0.1915, grad=13.97, nan=0]Epoch 48:  55%|█████▍    | 28/51 [00:00<00:00, 93.78it/s, loss=0.6961, trans=0.0053, rot=0.1625, grad=12.62, nan=0]Epoch 48:  55%|█████▍    | 28/51 [00:00<00:00, 93.78it/s, loss=0.7557, trans=0.0053, rot=0.2225, grad=21.07, nan=0]Epoch 48:  75%|███████▍  | 38/51 [00:00<00:00, 93.30it/s, loss=0.7557, trans=0.0053, rot=0.2225, grad=21.07, nan=0]Epoch 48:  75%|███████▍  | 38/51 [00:00<00:00, 93.30it/s, loss=0.7908, trans=0.0059, rot=0.1969, grad=12.81, nan=0]Epoch 48:  75%|███████▍  | 38/51 [00:00<00:00, 93.30it/s, loss=0.7132, trans=0.0052, rot=0.1932, grad=15.04, nan=0]Epoch 48:  75%|███████▍  | 38/51 [00:00<00:00, 93.30it/s, loss=0.8437, trans=0.0062, rot=0.2205, grad=11.99, nan=0]Epoch 48:  75%|███████▍  | 38/51 [00:00<00:00, 93.30it/s, loss=0.8130, trans=0.0062, rot=0.1945, grad=20.78, nan=0]Epoch 48:  75%|███████▍  | 38/51 [00:00<00:00, 93.30it/s, loss=0.7014, trans=0.0053, rot=0.1700, grad=9.91, nan=0] Epoch 48:  75%|███████▍  | 38/51 [00:00<00:00, 93.30it/s, loss=0.9577, trans=0.0073, rot=0.2261, grad=19.41, nan=0]Epoch 48:  75%|███████▍  | 38/51 [00:00<00:00, 93.30it/s, loss=0.6966, trans=0.0050, rot=0.1966, grad=26.60, nan=0]Epoch 48:  75%|███████▍  | 38/51 [00:00<00:00, 93.30it/s, loss=0.7581, trans=0.0056, rot=0.1943, grad=10.95, nan=0]Epoch 48:  75%|███████▍  | 38/51 [00:00<00:00, 93.30it/s, loss=0.6036, trans=0.0042, rot=0.1795, grad=21.92, nan=0]Epoch 48:  75%|███████▍  | 38/51 [00:00<00:00, 93.30it/s, loss=0.6592, trans=0.0047, rot=0.1904, grad=12.60, nan=0]Epoch 48:  94%|█████████▍| 48/51 [00:00<00:00, 90.67it/s, loss=0.6592, trans=0.0047, rot=0.1904, grad=12.60, nan=0]Epoch 48:  94%|█████████▍| 48/51 [00:00<00:00, 90.67it/s, loss=0.8586, trans=0.0063, rot=0.2241, grad=23.68, nan=0]Epoch 48:  94%|█████████▍| 48/51 [00:00<00:00, 90.67it/s, loss=0.7298, trans=0.0053, rot=0.2015, grad=19.36, nan=0]Epoch 48:  94%|█████████▍| 48/51 [00:00<00:00, 90.67it/s, loss=0.7363, trans=0.0060, rot=0.1315, grad=38.38, nan=0]Epoch 48: 100%|██████████| 51/51 [00:00<00:00, 88.07it/s, loss=0.7363, trans=0.0060, rot=0.1315, grad=38.38, nan=0]
Visual features - mean: 0.000573, std: 1.047150
IMU features - mean: -0.006072, std: 1.312734
GT translations (m) - mean: -0.000322, std: 0.024602
GT quaternions - mean: 0.250588, std: 0.432842
Predicted pose window shape: (1, 7)
[[ 0.12274389 -0.04801344 -0.00671316  0.09866746  0.00631268  0.00684815
  -0.9950769 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[-0.06613198  0.17492214 -0.0952098   0.02413864 -0.00665972 -0.05557565
  -0.9981404 ]]
  Ground truth relative pose:
[[-1.7475861e-04 -4.3966237e-04 -1.0484648e-03 -2.0727366e-03
  -4.5685768e-03 -9.5716119e-04  9.9998695e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  82%|████████▏ | 18/22 [00:00<00:00, 179.52it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 177.52it/s]

Epoch 48 Summary:
  Train Loss: 0.808641
  Val Loss: 0.112033
  Val Trans Error: 0.0575 m
  Val Rot Error: 3.34 degrees

============================================================
Epoch 49/50
Learning rate: 0.00000588
============================================================
Epoch 49:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 49:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.7286, trans=0.0056, rot=0.1648, grad=12.54, nan=0]Epoch 49:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9123, trans=0.0072, rot=0.1881, grad=22.31, nan=0]Epoch 49:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9367, trans=0.0067, rot=0.2646, grad=24.49, nan=0]Epoch 49:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8877, trans=0.0070, rot=0.1900, grad=19.66, nan=0]Epoch 49:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8389, trans=0.0064, rot=0.2039, grad=11.35, nan=0]Epoch 49:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9556, trans=0.0071, rot=0.2465, grad=20.95, nan=0]Epoch 49:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8191, trans=0.0061, rot=0.2140, grad=10.99, nan=0]Epoch 49:  14%|█▎        | 7/51 [00:00<00:00, 65.45it/s, loss=0.8191, trans=0.0061, rot=0.2140, grad=10.99, nan=0]Epoch 49:  14%|█▎        | 7/51 [00:00<00:00, 65.45it/s, loss=0.7596, trans=0.0055, rot=0.2146, grad=19.32, nan=0]Epoch 49:  14%|█▎        | 7/51 [00:00<00:00, 65.45it/s, loss=0.8965, trans=0.0067, rot=0.2238, grad=21.21, nan=0]Epoch 49:  14%|█▎        | 7/51 [00:00<00:00, 65.45it/s, loss=1.0135, trans=0.0080, rot=0.2151, grad=34.57, nan=0]Epoch 49:  14%|█▎        | 7/51 [00:00<00:00, 65.45it/s, loss=0.9213, trans=0.0070, rot=0.2194, grad=26.32, nan=0]Epoch 49:  14%|█▎        | 7/51 [00:00<00:00, 65.45it/s, loss=0.8047, trans=0.0061, rot=0.1948, grad=17.73, nan=0]Epoch 49:  14%|█▎        | 7/51 [00:00<00:00, 65.45it/s, loss=0.8013, trans=0.0057, rot=0.2317, grad=20.01, nan=0]Epoch 49:  14%|█▎        | 7/51 [00:00<00:00, 65.45it/s, loss=0.7182, trans=0.0055, rot=0.1658, grad=20.64, nan=0]Epoch 49:  14%|█▎        | 7/51 [00:00<00:00, 65.45it/s, loss=0.7782, trans=0.0056, rot=0.2144, grad=15.30, nan=0]Epoch 49:  14%|█▎        | 7/51 [00:00<00:00, 65.45it/s, loss=0.8130, trans=0.0057, rot=0.2425, grad=17.95, nan=0]Epoch 49:  14%|█▎        | 7/51 [00:00<00:00, 65.45it/s, loss=0.7755, trans=0.0058, rot=0.1951, grad=24.80, nan=0]Epoch 49:  14%|█▎        | 7/51 [00:00<00:00, 65.45it/s, loss=0.7661, trans=0.0055, rot=0.2180, grad=25.62, nan=0]Epoch 49:  35%|███▌      | 18/51 [00:00<00:00, 87.32it/s, loss=0.7661, trans=0.0055, rot=0.2180, grad=25.62, nan=0]Epoch 49:  35%|███▌      | 18/51 [00:00<00:00, 87.32it/s, loss=0.9393, trans=0.0067, rot=0.2643, grad=31.26, nan=0]Epoch 49:  35%|███▌      | 18/51 [00:00<00:00, 87.32it/s, loss=0.7106, trans=0.0052, rot=0.1884, grad=33.13, nan=0]Epoch 49:  35%|███▌      | 18/51 [00:00<00:00, 87.32it/s, loss=0.9529, trans=0.0073, rot=0.2184, grad=16.63, nan=0]Epoch 49:  35%|███▌      | 18/51 [00:00<00:00, 87.32it/s, loss=0.7652, trans=0.0054, rot=0.2278, grad=17.72, nan=0]Epoch 49:  35%|███▌      | 18/51 [00:00<00:00, 87.32it/s, loss=0.8061, trans=0.0063, rot=0.1748, grad=10.29, nan=0]Epoch 49:  35%|███▌      | 18/51 [00:00<00:00, 87.32it/s, loss=0.6780, trans=0.0046, rot=0.2174, grad=9.64, nan=0] Epoch 49:  35%|███▌      | 18/51 [00:00<00:00, 87.32it/s, loss=0.9076, trans=0.0067, rot=0.2384, grad=27.78, nan=0]Epoch 49:  35%|███▌      | 18/51 [00:00<00:00, 87.32it/s, loss=0.8482, trans=0.0059, rot=0.2565, grad=27.34, nan=0]Epoch 49:  35%|███▌      | 18/51 [00:00<00:00, 87.32it/s, loss=0.7957, trans=0.0055, rot=0.2480, grad=22.46, nan=0]Epoch 49:  35%|███▌      | 18/51 [00:00<00:00, 87.32it/s, loss=0.9320, trans=0.0070, rot=0.2361, grad=23.29, nan=0]Epoch 49:  55%|█████▍    | 28/51 [00:00<00:00, 92.08it/s, loss=0.9320, trans=0.0070, rot=0.2361, grad=23.29, nan=0]Epoch 49:  55%|█████▍    | 28/51 [00:00<00:00, 92.08it/s, loss=0.9891, trans=0.0077, rot=0.2208, grad=20.32, nan=0]Epoch 49:  55%|█████▍    | 28/51 [00:00<00:00, 92.08it/s, loss=0.6503, trans=0.0042, rot=0.2345, grad=14.08, nan=0]Epoch 49:  55%|█████▍    | 28/51 [00:00<00:00, 92.08it/s, loss=0.8978, trans=0.0068, rot=0.2160, grad=15.62, nan=0]Epoch 49:  55%|█████▍    | 28/51 [00:00<00:00, 92.08it/s, loss=0.9135, trans=0.0066, rot=0.2502, grad=26.48, nan=0]Epoch 49:  55%|█████▍    | 28/51 [00:00<00:00, 92.08it/s, loss=0.6537, trans=0.0047, rot=0.1835, grad=16.68, nan=0]Epoch 49:  55%|█████▍    | 28/51 [00:00<00:00, 92.08it/s, loss=0.7541, trans=0.0053, rot=0.2235, grad=11.71, nan=0]Epoch 49:  55%|█████▍    | 28/51 [00:00<00:00, 92.08it/s, loss=0.8222, trans=0.0059, rot=0.2304, grad=23.34, nan=0]Epoch 49:  55%|█████▍    | 28/51 [00:00<00:00, 92.08it/s, loss=0.8190, trans=0.0060, rot=0.2227, grad=18.15, nan=0]Epoch 49:  55%|█████▍    | 28/51 [00:00<00:00, 92.08it/s, loss=0.8686, trans=0.0065, rot=0.2174, grad=28.61, nan=0]Epoch 49:  55%|█████▍    | 28/51 [00:00<00:00, 92.08it/s, loss=0.8208, trans=0.0063, rot=0.1934, grad=23.46, nan=0]Epoch 49:  55%|█████▍    | 28/51 [00:00<00:00, 92.08it/s, loss=0.8290, trans=0.0063, rot=0.2038, grad=10.16, nan=0]Epoch 49:  76%|███████▋  | 39/51 [00:00<00:00, 97.64it/s, loss=0.8290, trans=0.0063, rot=0.2038, grad=10.16, nan=0]Epoch 49:  76%|███████▋  | 39/51 [00:00<00:00, 97.64it/s, loss=0.9320, trans=0.0073, rot=0.2019, grad=31.82, nan=0]Epoch 49:  76%|███████▋  | 39/51 [00:00<00:00, 97.64it/s, loss=0.8122, trans=0.0064, rot=0.1749, grad=12.68, nan=0]Epoch 49:  76%|███████▋  | 39/51 [00:00<00:00, 97.64it/s, loss=0.8303, trans=0.0062, rot=0.2104, grad=13.64, nan=0]Epoch 49:  76%|███████▋  | 39/51 [00:00<00:00, 97.64it/s, loss=0.7264, trans=0.0054, rot=0.1865, grad=13.17, nan=0]Epoch 49:  76%|███████▋  | 39/51 [00:00<00:00, 97.64it/s, loss=0.8667, trans=0.0065, rot=0.2208, grad=23.97, nan=0]Epoch 49:  76%|███████▋  | 39/51 [00:00<00:00, 97.64it/s, loss=0.9200, trans=0.0073, rot=0.1859, grad=18.60, nan=0]Epoch 49:  76%|███████▋  | 39/51 [00:00<00:00, 97.64it/s, loss=1.0161, trans=0.0081, rot=0.2082, grad=19.27, nan=0]Epoch 49:  76%|███████▋  | 39/51 [00:00<00:00, 97.64it/s, loss=0.7138, trans=0.0051, rot=0.2040, grad=10.12, nan=0]Epoch 49:  76%|███████▋  | 39/51 [00:00<00:00, 97.64it/s, loss=0.7554, trans=0.0059, rot=0.1685, grad=18.55, nan=0]Epoch 49:  76%|███████▋  | 39/51 [00:00<00:00, 97.64it/s, loss=0.6451, trans=0.0044, rot=0.2036, grad=12.49, nan=0]Epoch 49:  76%|███████▋  | 39/51 [00:00<00:00, 97.64it/s, loss=0.8138, trans=0.0062, rot=0.1985, grad=20.48, nan=0]Epoch 49:  98%|█████████▊| 50/51 [00:00<00:00, 101.92it/s, loss=0.8138, trans=0.0062, rot=0.1985, grad=20.48, nan=0]Epoch 49:  98%|█████████▊| 50/51 [00:00<00:00, 101.92it/s, loss=0.9712, trans=0.0075, rot=0.2193, grad=40.57, nan=0]Epoch 49: 100%|██████████| 51/51 [00:00<00:00, 94.15it/s, loss=0.9712, trans=0.0075, rot=0.2193, grad=40.57, nan=0] 
Visual features - mean: 0.003886, std: 1.030254
IMU features - mean: -0.000557, std: 1.048539
GT translations (m) - mean: -0.000952, std: 0.024277
GT quaternions - mean: 0.248819, std: 0.433862
Predicted pose window shape: (1, 7)
[[-9.5022470e-04  3.0028816e-02  1.4505929e-01  3.5492577e-02
  -5.4941013e-02 -4.1117672e-02 -9.9701113e-01]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.09871369 -0.09539618  0.00331921 -0.05574901  0.05763599  0.05307022
  -0.9953661 ]]
  Ground truth relative pose:
[[ 3.9556250e-04 -7.5221849e-03 -1.9424558e-03  3.3835858e-02
  -8.5390611e-03  1.6811550e-02  9.9924952e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  82%|████████▏ | 18/22 [00:00<00:00, 177.65it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 167.06it/s]

Epoch 49 Summary:
  Train Loss: 0.833008
  Val Loss: 0.086203
  Val Trans Error: 0.0456 m
  Val Rot Error: 3.23 degrees

============================================================
Epoch 50/50
Learning rate: 0.00000588
============================================================
Epoch 50:   0%|          | 0/51 [00:00<?, ?it/s]Epoch 50:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.9046, trans=0.0071, rot=0.1983, grad=22.22, nan=0]Epoch 50:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.6685, trans=0.0048, rot=0.1909, grad=10.66, nan=0]Epoch 50:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.8213, trans=0.0062, rot=0.2029, grad=11.22, nan=0]Epoch 50:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.7071, trans=0.0049, rot=0.2137, grad=18.03, nan=0]Epoch 50:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.7682, trans=0.0055, rot=0.2159, grad=21.96, nan=0]Epoch 50:   0%|          | 0/51 [00:00<?, ?it/s, loss=0.6379, trans=0.0044, rot=0.2000, grad=15.79, nan=0]Epoch 50:  12%|█▏        | 6/51 [00:00<00:00, 58.05it/s, loss=0.6379, trans=0.0044, rot=0.2000, grad=15.79, nan=0]Epoch 50:  12%|█▏        | 6/51 [00:00<00:00, 58.05it/s, loss=0.7232, trans=0.0050, rot=0.2218, grad=13.45, nan=0]Epoch 50:  12%|█▏        | 6/51 [00:00<00:00, 58.05it/s, loss=0.7460, trans=0.0059, rot=0.1578, grad=20.97, nan=0]Epoch 50:  12%|█▏        | 6/51 [00:00<00:00, 58.05it/s, loss=0.6760, trans=0.0050, rot=0.1750, grad=13.49, nan=0]Epoch 50:  12%|█▏        | 6/51 [00:00<00:00, 58.05it/s, loss=0.5538, trans=0.0035, rot=0.1991, grad=22.14, nan=0]Epoch 50:  12%|█▏        | 6/51 [00:00<00:00, 58.05it/s, loss=0.8071, trans=0.0060, rot=0.2066, grad=21.46, nan=0]Epoch 50:  12%|█▏        | 6/51 [00:00<00:00, 58.05it/s, loss=0.8964, trans=0.0068, rot=0.2149, grad=32.15, nan=0]Epoch 50:  12%|█▏        | 6/51 [00:00<00:00, 58.05it/s, loss=0.7991, trans=0.0058, rot=0.2235, grad=23.02, nan=0]Epoch 50:  12%|█▏        | 6/51 [00:00<00:00, 58.05it/s, loss=0.8704, trans=0.0059, rot=0.2785, grad=11.06, nan=0]Epoch 50:  12%|█▏        | 6/51 [00:00<00:00, 58.05it/s, loss=0.7333, trans=0.0059, rot=0.1476, grad=10.06, nan=0]Epoch 50:  12%|█▏        | 6/51 [00:00<00:00, 58.05it/s, loss=0.7768, trans=0.0055, rot=0.2232, grad=19.68, nan=0]Epoch 50:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=0.7768, trans=0.0055, rot=0.2232, grad=19.68, nan=0]Epoch 50:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=0.8382, trans=0.0064, rot=0.1984, grad=24.04, nan=0]Epoch 50:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=0.6670, trans=0.0046, rot=0.2046, grad=17.77, nan=0]Epoch 50:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=0.8229, trans=0.0065, rot=0.1766, grad=36.71, nan=0]Epoch 50:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=1.0179, trans=0.0079, rot=0.2244, grad=28.97, nan=0]Epoch 50:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=0.9256, trans=0.0072, rot=0.2078, grad=12.42, nan=0]Epoch 50:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=0.7240, trans=0.0057, rot=0.1559, grad=22.95, nan=0]Epoch 50:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=0.8885, trans=0.0066, rot=0.2308, grad=11.38, nan=0]Epoch 50:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=0.7553, trans=0.0055, rot=0.2064, grad=14.51, nan=0]Epoch 50:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=0.8717, trans=0.0070, rot=0.1716, grad=17.94, nan=0]Epoch 50:  31%|███▏      | 16/51 [00:00<00:00, 80.71it/s, loss=0.8372, trans=0.0061, rot=0.2263, grad=24.41, nan=0]Epoch 50:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=0.8372, trans=0.0061, rot=0.2263, grad=24.41, nan=0]Epoch 50:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=0.7327, trans=0.0052, rot=0.2101, grad=15.79, nan=0]Epoch 50:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=0.9003, trans=0.0068, rot=0.2220, grad=22.94, nan=0]Epoch 50:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=0.9285, trans=0.0069, rot=0.2354, grad=22.78, nan=0]Epoch 50:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=0.6992, trans=0.0048, rot=0.2163, grad=15.08, nan=0]Epoch 50:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=0.7532, trans=0.0054, rot=0.2150, grad=20.59, nan=0]Epoch 50:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=0.9228, trans=0.0072, rot=0.2046, grad=32.90, nan=0]Epoch 50:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=0.7668, trans=0.0060, rot=0.1701, grad=18.71, nan=0]Epoch 50:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=0.8372, trans=0.0064, rot=0.1941, grad=21.43, nan=0]Epoch 50:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=0.6810, trans=0.0045, rot=0.2276, grad=23.10, nan=0]Epoch 50:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=0.9236, trans=0.0072, rot=0.2042, grad=18.55, nan=0]Epoch 50:  51%|█████     | 26/51 [00:00<00:00, 87.29it/s, loss=0.8311, trans=0.0060, rot=0.2274, grad=12.79, nan=0]Epoch 50:  73%|███████▎  | 37/51 [00:00<00:00, 93.98it/s, loss=0.8311, trans=0.0060, rot=0.2274, grad=12.79, nan=0]Epoch 50:  73%|███████▎  | 37/51 [00:00<00:00, 93.98it/s, loss=0.7507, trans=0.0054, rot=0.2099, grad=23.37, nan=0]Epoch 50:  73%|███████▎  | 37/51 [00:00<00:00, 93.98it/s, loss=0.8384, trans=0.0064, rot=0.2031, grad=26.13, nan=0]Epoch 50:  73%|███████▎  | 37/51 [00:00<00:00, 93.98it/s, loss=0.8005, trans=0.0057, rot=0.2337, grad=15.87, nan=0]Epoch 50:  73%|███████▎  | 37/51 [00:00<00:00, 93.98it/s, loss=0.7113, trans=0.0051, rot=0.1977, grad=11.06, nan=0]Epoch 50:  73%|███████▎  | 37/51 [00:00<00:00, 93.98it/s, loss=0.8788, trans=0.0069, rot=0.1885, grad=21.19, nan=0]Epoch 50:  73%|███████▎  | 37/51 [00:00<00:00, 93.98it/s, loss=0.9380, trans=0.0075, rot=0.1884, grad=26.63, nan=0]Epoch 50:  73%|███████▎  | 37/51 [00:00<00:00, 93.98it/s, loss=0.6424, trans=0.0041, rot=0.2289, grad=16.36, nan=0]Epoch 50:  73%|███████▎  | 37/51 [00:00<00:00, 93.98it/s, loss=0.7412, trans=0.0053, rot=0.2109, grad=10.12, nan=0]Epoch 50:  73%|███████▎  | 37/51 [00:00<00:00, 93.98it/s, loss=0.6473, trans=0.0046, rot=0.1837, grad=10.35, nan=0]Epoch 50:  73%|███████▎  | 37/51 [00:00<00:00, 93.98it/s, loss=0.8113, trans=0.0062, rot=0.1938, grad=22.66, nan=0]Epoch 50:  73%|███████▎  | 37/51 [00:00<00:00, 93.98it/s, loss=0.8898, trans=0.0065, rot=0.2442, grad=17.84, nan=0]Epoch 50:  94%|█████████▍| 48/51 [00:00<00:00, 98.28it/s, loss=0.8898, trans=0.0065, rot=0.2442, grad=17.84, nan=0]Epoch 50:  94%|█████████▍| 48/51 [00:00<00:00, 98.28it/s, loss=0.7647, trans=0.0055, rot=0.2151, grad=9.18, nan=0] Epoch 50:  94%|█████████▍| 48/51 [00:00<00:00, 98.28it/s, loss=0.6378, trans=0.0044, rot=0.1942, grad=9.42, nan=0]Epoch 50:  94%|█████████▍| 48/51 [00:00<00:00, 98.28it/s, loss=0.6796, trans=0.0044, rot=0.2436, grad=53.13, nan=0]Epoch 50: 100%|██████████| 51/51 [00:00<00:00, 90.01it/s, loss=0.6796, trans=0.0044, rot=0.2436, grad=53.13, nan=0]
Visual features - mean: -0.001086, std: 1.040305
IMU features - mean: -0.000735, std: 1.154796
GT translations (m) - mean: 0.000193, std: 0.041849
GT quaternions - mean: 0.249983, std: 0.433192
Predicted pose window shape: (1, 7)
[[-0.05086161  0.22721577 -0.0214134   0.03402434 -0.05415966  0.16640644
  -0.9839808 ]]

Batch 50 sample relative poses:
  Predicted relative pose:
[[ 0.09516767  0.04816557  0.09631156 -0.07404818  0.02684056 -0.01258414
  -0.99681395]]
  Ground truth relative pose:
[[ 5.8122817e-04 -1.6016671e-03  9.8012155e-05  3.4694821e-03
  -3.6245584e-03  1.3271272e-03  9.9998653e-01]]
Validation:   0%|          | 0/22 [00:00<?, ?it/s]Validation:  86%|████████▋ | 19/22 [00:00<00:00, 189.13it/s]Validation: 100%|██████████| 22/22 [00:00<00:00, 180.39it/s]

Epoch 50 Summary:
  Train Loss: 0.787176
  Val Loss: 0.077257
  Val Trans Error: 0.0408 m
  Val Rot Error: 3.17 degrees
  ✓ New best model saved

Training complete! Best val loss: 0.077257
Checkpoints saved to: checkpoints_vift_stable/20250613_165244
